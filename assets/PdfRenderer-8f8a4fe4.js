var is=Object.defineProperty;var rs=(ht,b,K)=>b in ht?is(ht,b,{enumerable:!0,configurable:!0,writable:!0,value:K}):ht[b]=K;var Ot=(ht,b,K)=>(rs(ht,typeof b!="symbol"?b+"":b,K),K),de=(ht,b,K)=>{if(!b.has(ht))throw TypeError("Cannot "+K)};var u=(ht,b,K)=>(de(ht,b,"read from private field"),K?K.call(ht):b.get(ht)),Y=(ht,b,K)=>{if(b.has(ht))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(ht):b.set(ht,K)},pt=(ht,b,K,_)=>(de(ht,b,"write to private field"),_?_.call(ht,K):b.set(ht,K),K),ie=(ht,b,K,_)=>({set _(k){pt(ht,b,k,K)},get _(){return u(ht,b,_)}}),Z=(ht,b,K)=>(de(ht,b,"access private method"),K);import{r as ref,l as onMounted,o as openBlock,c as createElementBlock,b as createBaseVNode,g as withDirectives,i as vModelText,f as createTextVNode}from"./index-52d34a77.js";import{a as getAugmentedNamespace}from"./_commonjsHelpers-042e6b4d.js";function commonjsRequire(ht){throw new Error('Could not dynamically require "'+ht+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(b,K){module.exports=K()})(globalThis,()=>(()=>{var __webpack_modules__=[,(ht,b)=>{var Rt;Object.defineProperty(b,"__esModule",{value:!0}),b.VerbosityLevel=b.Util=b.UnknownErrorException=b.UnexpectedResponseException=b.TextRenderingMode=b.RenderingIntentFlag=b.PromiseCapability=b.PermissionFlag=b.PasswordResponses=b.PasswordException=b.PageActionEventType=b.OPS=b.MissingPDFException=b.MAX_IMAGE_SIZE_TO_CACHE=b.LINE_FACTOR=b.LINE_DESCENT_FACTOR=b.InvalidPDFException=b.ImageKind=b.IDENTITY_MATRIX=b.FormatError=b.FeatureTest=b.FONT_IDENTITY_MATRIX=b.DocumentActionEventType=b.CMapCompressionType=b.BaseException=b.BASELINE_FACTOR=b.AnnotationType=b.AnnotationStateModelType=b.AnnotationReviewState=b.AnnotationReplyType=b.AnnotationMode=b.AnnotationMarkedState=b.AnnotationFlag=b.AnnotationFieldFlag=b.AnnotationEditorType=b.AnnotationEditorPrefix=b.AnnotationEditorParamsType=b.AnnotationBorderStyleType=b.AnnotationActionEventType=b.AbortException=void 0,b.assert=yt,b.bytesToString=M,b.createValidAbsoluteUrl=_t,b.getModificationDate=At,b.getVerbosityLevel=dt,b.info=ot,b.isArrayBuffer=ft,b.isArrayEqual=Et,b.normalizeUnicode=vt,b.objectFromMap=A,b.objectSize=p,b.setVerbosityLevel=nt,b.shadow=W,b.string32=n,b.stringToBytes=e,b.stringToPDFString=Q,b.stringToUTF8String=st,b.unreachable=mt,b.utf8StringToString=ut,b.warn=ct;const K=[1,0,0,1,0,0];b.IDENTITY_MATRIX=K;const _=[.001,0,0,.001,0,0];b.FONT_IDENTITY_MATRIX=_;const k=1e7;b.MAX_IMAGE_SIZE_TO_CACHE=k;const z=1.35;b.LINE_FACTOR=z;const G=.35;b.LINE_DESCENT_FACTOR=G;const it=G/z;b.BASELINE_FACTOR=it;const U={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};b.RenderingIntentFlag=U;const I={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};b.AnnotationMode=I;const y="pdfjs_internal_editor_";b.AnnotationEditorPrefix=y;const N={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};b.AnnotationEditorType=N;const w={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};b.AnnotationEditorParamsType=w;const x={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};b.PermissionFlag=x;const f={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};b.TextRenderingMode=f;const h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};b.ImageKind=h;const r={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};b.AnnotationType=r;const m={MARKED:"Marked",REVIEW:"Review"};b.AnnotationStateModelType=m;const v={MARKED:"Marked",UNMARKED:"Unmarked"};b.AnnotationMarkedState=v;const T={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};b.AnnotationReviewState=T;const g={GROUP:"Group",REPLY:"R"};b.AnnotationReplyType=g;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};b.AnnotationFlag=t;const a={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};b.AnnotationFieldFlag=a;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};b.AnnotationBorderStyleType=o;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};b.AnnotationActionEventType=s;const c={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};b.DocumentActionEventType=c;const P={O:"PageOpen",C:"PageClose"};b.PageActionEventType=P;const i={ERRORS:0,WARNINGS:1,INFOS:5};b.VerbosityLevel=i;const L={NONE:0,BINARY:1};b.CMapCompressionType=L;const q={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};b.OPS=q;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};b.PasswordResponses=$;let J=i.WARNINGS;function nt(lt){Number.isInteger(lt)&&(J=lt)}function dt(){return J}function ot(lt){J>=i.INFOS&&console.log(`Info: ${lt}`)}function ct(lt){J>=i.WARNINGS&&console.log(`Warning: ${lt}`)}function mt(lt){throw new Error(lt)}function yt(lt,C){lt||mt(C)}function St(lt){switch(lt==null?void 0:lt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _t(lt,C=null,F=null){if(!lt)return null;try{if(F&&typeof lt=="string"){if(F.addDefaultProtocol&&lt.startsWith("www.")){const gt=lt.match(/\./g);(gt==null?void 0:gt.length)>=2&&(lt=`http://${lt}`)}if(F.tryConvertEncoding)try{lt=st(lt)}catch{}}const at=C?new URL(lt,C):new URL(lt);if(St(at))return at}catch{}return null}function W(lt,C,F,at=!1){return Object.defineProperty(lt,C,{value:F,enumerable:!at,configurable:!0,writable:!1}),F}const l=function(){function C(F,at){this.constructor===C&&mt("Cannot initialize BaseException."),this.message=F,this.name=at}return C.prototype=new Error,C.constructor=C,C}();b.BaseException=l;class d extends l{constructor(C,F){super(C,"PasswordException"),this.code=F}}b.PasswordException=d;class S extends l{constructor(C,F){super(C,"UnknownErrorException"),this.details=F}}b.UnknownErrorException=S;class j extends l{constructor(C){super(C,"InvalidPDFException")}}b.InvalidPDFException=j;class O extends l{constructor(C){super(C,"MissingPDFException")}}b.MissingPDFException=O;class H extends l{constructor(C,F){super(C,"UnexpectedResponseException"),this.status=F}}b.UnexpectedResponseException=H;class D extends l{constructor(C){super(C,"FormatError")}}b.FormatError=D;class R extends l{constructor(C){super(C,"AbortException")}}b.AbortException=R;function M(lt){(typeof lt!="object"||(lt==null?void 0:lt.length)===void 0)&&mt("Invalid argument for bytesToString");const C=lt.length,F=8192;if(C<F)return String.fromCharCode.apply(null,lt);const at=[];for(let gt=0;gt<C;gt+=F){const Tt=Math.min(gt+F,C),wt=lt.subarray(gt,Tt);at.push(String.fromCharCode.apply(null,wt))}return at.join("")}function e(lt){typeof lt!="string"&&mt("Invalid argument for stringToBytes");const C=lt.length,F=new Uint8Array(C);for(let at=0;at<C;++at)F[at]=lt.charCodeAt(at)&255;return F}function n(lt){return String.fromCharCode(lt>>24&255,lt>>16&255,lt>>8&255,lt&255)}function p(lt){return Object.keys(lt).length}function A(lt){const C=Object.create(null);for(const[F,at]of lt)C[F]=at;return C}function E(){const lt=new Uint8Array(4);return lt[0]=1,new Uint32Array(lt.buffer,0,1)[0]===1}function B(){try{return new Function(""),!0}catch{return!1}}class tt{static get isLittleEndian(){return W(this,"isLittleEndian",E())}static get isEvalSupported(){return W(this,"isEvalSupported",B())}static get isOffscreenCanvasSupported(){return W(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?W(this,"platform",{isWin:!1,isMac:!1}):W(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}b.FeatureTest=tt;const X=[...Array(256).keys()].map(lt=>lt.toString(16).padStart(2,"0"));class et{static makeHexColor(C,F,at){return`#${X[C]}${X[F]}${X[at]}`}static scaleMinMax(C,F){let at;C[0]?(C[0]<0&&(at=F[0],F[0]=F[1],F[1]=at),F[0]*=C[0],F[1]*=C[0],C[3]<0&&(at=F[2],F[2]=F[3],F[3]=at),F[2]*=C[3],F[3]*=C[3]):(at=F[0],F[0]=F[2],F[2]=at,at=F[1],F[1]=F[3],F[3]=at,C[1]<0&&(at=F[2],F[2]=F[3],F[3]=at),F[2]*=C[1],F[3]*=C[1],C[2]<0&&(at=F[0],F[0]=F[1],F[1]=at),F[0]*=C[2],F[1]*=C[2]),F[0]+=C[4],F[1]+=C[4],F[2]+=C[5],F[3]+=C[5]}static transform(C,F){return[C[0]*F[0]+C[2]*F[1],C[1]*F[0]+C[3]*F[1],C[0]*F[2]+C[2]*F[3],C[1]*F[2]+C[3]*F[3],C[0]*F[4]+C[2]*F[5]+C[4],C[1]*F[4]+C[3]*F[5]+C[5]]}static applyTransform(C,F){const at=C[0]*F[0]+C[1]*F[2]+F[4],gt=C[0]*F[1]+C[1]*F[3]+F[5];return[at,gt]}static applyInverseTransform(C,F){const at=F[0]*F[3]-F[1]*F[2],gt=(C[0]*F[3]-C[1]*F[2]+F[2]*F[5]-F[4]*F[3])/at,Tt=(-C[0]*F[1]+C[1]*F[0]+F[4]*F[1]-F[5]*F[0])/at;return[gt,Tt]}static getAxialAlignedBoundingBox(C,F){const at=et.applyTransform(C,F),gt=et.applyTransform(C.slice(2,4),F),Tt=et.applyTransform([C[0],C[3]],F),wt=et.applyTransform([C[2],C[1]],F);return[Math.min(at[0],gt[0],Tt[0],wt[0]),Math.min(at[1],gt[1],Tt[1],wt[1]),Math.max(at[0],gt[0],Tt[0],wt[0]),Math.max(at[1],gt[1],Tt[1],wt[1])]}static inverseTransform(C){const F=C[0]*C[3]-C[1]*C[2];return[C[3]/F,-C[1]/F,-C[2]/F,C[0]/F,(C[2]*C[5]-C[4]*C[3])/F,(C[4]*C[1]-C[5]*C[0])/F]}static singularValueDecompose2dScale(C){const F=[C[0],C[2],C[1],C[3]],at=C[0]*F[0]+C[1]*F[2],gt=C[0]*F[1]+C[1]*F[3],Tt=C[2]*F[0]+C[3]*F[2],wt=C[2]*F[1]+C[3]*F[3],kt=(at+wt)/2,Pt=Math.sqrt((at+wt)**2-4*(at*wt-Tt*gt))/2,Mt=kt+Pt||1,xt=kt-Pt||1;return[Math.sqrt(Mt),Math.sqrt(xt)]}static normalizeRect(C){const F=C.slice(0);return C[0]>C[2]&&(F[0]=C[2],F[2]=C[0]),C[1]>C[3]&&(F[1]=C[3],F[3]=C[1]),F}static intersect(C,F){const at=Math.max(Math.min(C[0],C[2]),Math.min(F[0],F[2])),gt=Math.min(Math.max(C[0],C[2]),Math.max(F[0],F[2]));if(at>gt)return null;const Tt=Math.max(Math.min(C[1],C[3]),Math.min(F[1],F[3])),wt=Math.min(Math.max(C[1],C[3]),Math.max(F[1],F[3]));return Tt>wt?null:[at,Tt,gt,wt]}static bezierBoundingBox(C,F,at,gt,Tt,wt,kt,Pt){const Mt=[],xt=[[],[]];let Lt,Dt,It,Ft,Bt,Ut,Wt,qt;for(let zt=0;zt<2;++zt){if(zt===0?(Dt=6*C-12*at+6*Tt,Lt=-3*C+9*at-9*Tt+3*kt,It=3*at-3*C):(Dt=6*F-12*gt+6*wt,Lt=-3*F+9*gt-9*wt+3*Pt,It=3*gt-3*F),Math.abs(Lt)<1e-12){if(Math.abs(Dt)<1e-12)continue;Ft=-It/Dt,0<Ft&&Ft<1&&Mt.push(Ft);continue}Wt=Dt*Dt-4*It*Lt,qt=Math.sqrt(Wt),!(Wt<0)&&(Bt=(-Dt+qt)/(2*Lt),0<Bt&&Bt<1&&Mt.push(Bt),Ut=(-Dt-qt)/(2*Lt),0<Ut&&Ut<1&&Mt.push(Ut))}let Nt=Mt.length,jt;const Gt=Nt;for(;Nt--;)Ft=Mt[Nt],jt=1-Ft,xt[0][Nt]=jt*jt*jt*C+3*jt*jt*Ft*at+3*jt*Ft*Ft*Tt+Ft*Ft*Ft*kt,xt[1][Nt]=jt*jt*jt*F+3*jt*jt*Ft*gt+3*jt*Ft*Ft*wt+Ft*Ft*Ft*Pt;return xt[0][Gt]=C,xt[1][Gt]=F,xt[0][Gt+1]=kt,xt[1][Gt+1]=Pt,xt[0].length=xt[1].length=Gt+2,[Math.min(...xt[0]),Math.min(...xt[1]),Math.max(...xt[0]),Math.max(...xt[1])]}}b.Util=et;const rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Q(lt){if(lt[0]>="ï"){let F;if(lt[0]==="þ"&&lt[1]==="ÿ"?F="utf-16be":lt[0]==="ÿ"&&lt[1]==="þ"?F="utf-16le":lt[0]==="ï"&&lt[1]==="»"&&lt[2]==="¿"&&(F="utf-8"),F)try{const at=new TextDecoder(F,{fatal:!0}),gt=e(lt);return at.decode(gt)}catch(at){ct(`stringToPDFString: "${at}".`)}}const C=[];for(let F=0,at=lt.length;F<at;F++){const gt=rt[lt.charCodeAt(F)];C.push(gt?String.fromCharCode(gt):lt.charAt(F))}return C.join("")}function st(lt){return decodeURIComponent(escape(lt))}function ut(lt){return unescape(encodeURIComponent(lt))}function ft(lt){return typeof lt=="object"&&(lt==null?void 0:lt.byteLength)!==void 0}function Et(lt,C){if(lt.length!==C.length)return!1;for(let F=0,at=lt.length;F<at;F++)if(lt[F]!==C[F])return!1;return!0}function At(lt=new Date){return[lt.getUTCFullYear().toString(),(lt.getUTCMonth()+1).toString().padStart(2,"0"),lt.getUTCDate().toString().padStart(2,"0"),lt.getUTCHours().toString().padStart(2,"0"),lt.getUTCMinutes().toString().padStart(2,"0"),lt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ct{constructor(){Y(this,Rt,!1);this.promise=new Promise((C,F)=>{this.resolve=at=>{pt(this,Rt,!0),C(at)},this.reject=at=>{pt(this,Rt,!0),F(at)}})}get settled(){return u(this,Rt)}}Rt=new WeakMap,b.PromiseCapability=Ct;let V=null,bt=null;function vt(lt){return V||(V=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,bt=new Map([["ﬅ","ſt"]])),lt.replaceAll(V,(C,F,at)=>F?F.normalize("NFKC"):bt.get(at))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ht,K,_,k,Kt,G,re,U,I,y,N,w,x,f,h,ue,m,v,fe,g,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:o,NodeCMapReaderFactory:s,NodeFilterFactory:c,NodeStandardFontDataFactory:P}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=o,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=c,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=P}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:o}=__w_pdfjs_require__(21);createPDFNetworkStream=s=>new o(s)}else{const{PDFNetworkStream:o}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=c=>(0,_display_utils.isValidFetchUrl)(c.url)?new s(c):new o(c)}function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:c}=s,P=o.url?getUrlProp(o.url):null,i=o.data?getDataProp(o.data):null,L=o.httpHeaders||null,q=o.withCredentials===!0,$=o.password??null,J=o.range instanceof PDFDataRangeTransport?o.range:null,nt=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let dt=o.worker instanceof PDFWorker?o.worker:null;const ot=o.verbosity,ct=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,mt=typeof o.cMapUrl=="string"?o.cMapUrl:null,yt=o.cMapPacked!==!1,St=o.CMapReaderFactory||DefaultCMapReaderFactory,_t=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,W=o.StandardFontDataFactory||DefaultStandardFontDataFactory,l=o.stopAtErrors!==!0,d=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,S=o.isEvalSupported!==!1,j=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_is_node.isNodeJS,O=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,H=typeof o.disableFontFace=="boolean"?o.disableFontFace:_is_node.isNodeJS,D=o.fontExtraProperties===!0,R=o.enableXfa===!0,M=o.ownerDocument||globalThis.document,e=o.disableRange===!0,n=o.disableStream===!0,p=o.disableAutoFetch===!0,A=o.pdfBug===!0,E=J?J.length:o.length??NaN,B=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_is_node.isNodeJS&&!H,tt=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:St===_display_utils.DOMCMapReaderFactory&&W===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(mt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(_t,document.baseURI),X=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:M}),et=o.filterFactory||new DefaultFilterFactory({docId:c,ownerDocument:M}),rt=null;(0,_util.setVerbosityLevel)(ot);const Q={canvasFactory:X,filterFactory:et};if(tt||(Q.cMapReaderFactory=new St({baseUrl:mt,isCompressed:yt}),Q.standardFontDataFactory=new W({baseUrl:_t})),!dt){const ft={verbosity:ot,port:_worker_options.GlobalWorkerOptions.workerPort};dt=ft.port?PDFWorker.fromPort(ft):new PDFWorker(ft),s._worker=dt}const st={docId:c,apiVersion:"3.6.172",data:i,password:$,disableAutoFetch:p,rangeChunkSize:nt,length:E,docBaseUrl:ct,enableXfa:R,evaluatorOptions:{maxImageSize:d,disableFontFace:H,ignoreErrors:l,isEvalSupported:S,isOffscreenCanvasSupported:j,canvasMaxAreaInBytes:O,fontExtraProperties:D,useSystemFonts:B,cMapUrl:tt?mt:null,standardFontDataUrl:tt?_t:null}},ut={ignoreErrors:l,isEvalSupported:S,disableFontFace:H,fontExtraProperties:D,enableXfa:R,ownerDocument:M,disableAutoFetch:p,pdfBug:A,styleElement:rt};return dt.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const ft=_fetchDocument(dt,st),Et=new Promise(function(At){let Ct;J?Ct=new _transport_stream.PDFDataTransportStream({length:E,initialData:J.initialData,progressiveDone:J.progressiveDone,contentDispositionFilename:J.contentDispositionFilename,disableRange:e,disableStream:n},J):i||(Ct=createPDFNetworkStream({url:P,length:E,httpHeaders:L,withCredentials:q,rangeChunkSize:nt,disableRange:e,disableStream:n})),At(Ct)});return Promise.all([ft,Et]).then(function([At,Ct]){if(s.destroyed)throw new Error("Loading aborted");const V=new _message_handler.MessageHandler(c,At,dt.port),bt=new WorkerTransport(V,s,Ct,ut,Q);s._transport=bt,V.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(o,s){if(o.destroyed)throw new Error("Worker was destroyed");const c=await o.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return c}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_is_node.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(o);if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const b=class{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ie(b,ht)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=b;ht=new WeakMap,Y(PDFDocumentLoadingTask,ht,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,c,P=!1,i=null){this.length=s,this.initialData=c,this.progressiveDone=P,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,c){for(const P of this._rangeListeners)P(s,c)}onDataProgress(s,c){this._readyCapability.promise.then(()=>{for(const P of this._progressListeners)P(s,c)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const c of this._progressiveReadListeners)c(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,c){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,c){this._pdfInfo=s,this._transport=c}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,c,P,i=!1){Y(this,k);Y(this,G);Y(this,K,null);Y(this,_,!1);this._pageIndex=s,this._pageInfo=c,this._transport=P,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=P.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:c=this.rotate,offsetX:P=0,offsetY:i=0,dontFlip:L=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:c,offsetX:P,offsetY:i,dontFlip:L})}getAnnotations({intent:s="display"}={}){const c=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,c.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:c,intent:P="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:L=null,background:q=null,optionalContentConfigPromise:$=null,annotationCanvasMap:J=null,pageColors:nt=null,printAnnotationStorage:dt=null}){var W,l,d;if((W=arguments[0])!=null&&W.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(l=this._stats)==null||l.time("Overall");const ot=this._transport.getRenderingIntent(P,i,dt);pt(this,_,!1),Z(this,G,re).call(this),$||($=this._transport.getOptionalContentConfig());let ct=this._intentStates.get(ot.cacheKey);ct||(ct=Object.create(null),this._intentStates.set(ot.cacheKey,ct)),ct.streamReaderCancelTimeout&&(clearTimeout(ct.streamReaderCancelTimeout),ct.streamReaderCancelTimeout=null);const mt=!!(ot.renderingIntent&_util.RenderingIntentFlag.PRINT);ct.displayReadyCapability||(ct.displayReadyCapability=new _util.PromiseCapability,ct.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(ot));const yt=S=>{var j,O;ct.renderTasks.delete(St),(this._maybeCleanupAfterRender||mt)&&pt(this,_,!0),Z(this,k,Kt).call(this,!mt),S?(St.capability.reject(S),this._abortOperatorList({intentState:ct,reason:S instanceof Error?S:new Error(S)})):St.capability.resolve(),(j=this._stats)==null||j.timeEnd("Rendering"),(O=this._stats)==null||O.timeEnd("Overall")},St=new InternalRenderTask({callback:yt,params:{canvasContext:s,viewport:c,transform:L,background:q},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:J,operatorList:ct.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!mt,pdfBug:this._pdfBug,pageColors:nt});(ct.renderTasks||(ct.renderTasks=new Set)).add(St);const _t=St.task;return Promise.all([ct.displayReadyCapability.promise,$]).then(([S,j])=>{var O;if(u(this,_)){yt();return}(O=this._stats)==null||O.time("Rendering"),St.initializeGraphics({transparency:S,optionalContentConfig:j}),St.operatorListChanged()}).catch(yt),_t}getOperatorList({intent:s="display",annotationMode:c=_util.AnnotationMode.ENABLE,printAnnotationStorage:P=null}={}){var J;function i(){q.operatorList.lastChunk&&(q.opListReadCapability.resolve(q.operatorList),q.renderTasks.delete($))}const L=this._transport.getRenderingIntent(s,c,P,!0);let q=this._intentStates.get(L.cacheKey);q||(q=Object.create(null),this._intentStates.set(L.cacheKey,q));let $;return q.opListReadCapability||($=Object.create(null),$.operatorListChanged=i,q.opListReadCapability=new _util.PromiseCapability,(q.renderTasks||(q.renderTasks=new Set)).add($),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(J=this._stats)==null||J.time("Page Request"),this._pumpOperatorList(L)),q.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1,disableNormalization:c=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0,disableNormalization:c===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(P=>_xfa_text.XfaText.textContent(P));const c=this.streamTextContent(s);return new Promise(function(P,i){function L(){q.read().then(function({value:J,done:nt}){if(nt){P($);return}Object.assign($.styles,J.styles),$.items.push(...J.items),L()},i)}const q=c.getReader(),$={items:[],styles:Object.create(null)};L()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const c of this._intentStates.values())if(this._abortOperatorList({intentState:c,reason:new Error("Page was destroyed."),force:!0}),!c.opListReadCapability)for(const P of c.renderTasks)s.push(P.completed),P.cancel();return this.objs.clear(),pt(this,_,!1),Z(this,G,re).call(this),Promise.all(s)}cleanup(s=!1){pt(this,_,!0);const c=Z(this,k,Kt).call(this,!1);return s&&c&&this._stats&&(this._stats=new _display_utils.StatTimer),c}_startRenderPage(s,c){var i,L;const P=this._intentStates.get(c);P&&((i=this._stats)==null||i.timeEnd("Page Request"),(L=P.displayReadyCapability)==null||L.resolve(s))}_renderPageChunk(s,c){for(let P=0,i=s.length;P<i;P++)c.operatorList.fnArray.push(s.fnArray[P]),c.operatorList.argsArray.push(s.argsArray[P]);c.operatorList.lastChunk=s.lastChunk,c.operatorList.separateAnnots=s.separateAnnots;for(const P of c.renderTasks)P.operatorListChanged();s.lastChunk&&Z(this,k,Kt).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:c,annotationStorageMap:P}){const L=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:c,annotationStorage:P}).getReader(),q=this._intentStates.get(c);q.streamReader=L;const $=()=>{L.read().then(({value:J,done:nt})=>{if(nt){q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(J,q),$())},J=>{if(q.streamReader=null,!this._transport.destroyed){if(q.operatorList){q.operatorList.lastChunk=!0;for(const nt of q.renderTasks)nt.operatorListChanged();Z(this,k,Kt).call(this,!0)}if(q.displayReadyCapability)q.displayReadyCapability.reject(J);else if(q.opListReadCapability)q.opListReadCapability.reject(J);else throw J}})};$()}_abortOperatorList({intentState:s,reason:c,force:P=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!P){if(s.renderTasks.size>0)return;if(c instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;c.extraDelay>0&&c.extraDelay<1e3&&(i+=c.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:c,force:!0})},i);return}}if(s.streamReader.cancel(new _util.AbortException(c.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[i,L]of this._intentStates)if(L===s){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}K=new WeakMap,_=new WeakMap,k=new WeakSet,Kt=function(s=!1){if(Z(this,G,re).call(this),!u(this,_))return!1;if(s)return pt(this,K,setTimeout(()=>{pt(this,K,null),Z(this,k,Kt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:c,operatorList:P}of this._intentStates.values())if(c.size>0||!P.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),pt(this,_,!1),!0},G=new WeakSet,re=function(){u(this,K)&&(clearTimeout(u(this,K)),pt(this,K,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Y(this,U,new Set);Y(this,I,Promise.resolve())}postMessage(s,c){const P={data:structuredClone(s,c?{transfer:c}:null)};u(this,I).then(()=>{for(const i of u(this,U))i.call(this,P)})}addEventListener(s,c){u(this,U).add(c)}removeEventListener(s,c){u(this,U).delete(c)}terminate(){u(this,U).clear()}}U=new WeakMap,I=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(y=document==null?void 0:document.currentScript)==null?void 0:y.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,s){let c;try{if(c=new URL(o),!c.origin||c.origin==="null")return!1}catch{return!1}const P=new URL(s,c);return c.origin===P.origin},PDFWorkerUtil.createCDNWrapper=function(o){const s=`importScripts("${o}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class{constructor({name:o=null,port:s=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){if(s&&u(_PDFWorker,N).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=c,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,s){u(_PDFWorker,N).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const s=new Worker(o),c=new _message_handler.MessageHandler("main","worker",s),P=()=>{s.removeEventListener("error",i),c.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||P()};s.addEventListener("error",i),c.on("test",q=>{if(s.removeEventListener("error",i),this.destroyed){P();return}q?(this._messageHandler=c,this._port=s,this._webWorker=s,this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),s.terminate())}),c.on("ready",q=>{if(s.removeEventListener("error",i),this.destroyed){P();return}try{L()}catch{this._setupFakeWorker()}});const L=()=>{const q=new Uint8Array;c.send("test",q,[q.buffer])};L();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const c=`fake${PDFWorkerUtil.fakeWorkerId++}`,P=new _message_handler.MessageHandler(c+"_worker",c,s);o.setup(P,s);const i=new _message_handler.MessageHandler(c,c+"_worker",s);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),u(_PDFWorker,N).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return u(this,N).has(o.port)?u(this,N).get(o.port):new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;N=new WeakMap,Y(PDFWorker,N,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(s,c,P,i,L){Y(this,h);Y(this,w,new Map);Y(this,x,new Map);Y(this,f,new Map);this.messageHandler=s,this.loadingTask=c,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=L.canvasFactory,this.filterFactory=L.filterFactory,this.cMapReaderFactory=L.cMapReaderFactory,this.standardFontDataFactory=L.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=P,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,c=_util.AnnotationMode.ENABLE,P=null,i=!1){let L=_util.RenderingIntentFlag.DISPLAY,q=null;switch(s){case"any":L=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":L=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(c){case _util.AnnotationMode.DISABLE:L+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:L+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:L+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,q=(L&_util.RenderingIntentFlag.PRINT&&P instanceof _annotation_storage.PrintAnnotationStorage?P:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${c}`)}return i&&(L+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:L,cacheKey:`${L}_${_annotation_storage.AnnotationStorage.getHash(q)}`,annotationStorageMap:q}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const P of u(this,x).values())s.push(P._destroy());u(this,x).clear(),u(this,f).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const c=this.messageHandler.sendWithPromise("Terminate",null);return s.push(c),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),u(this,w).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:c}=this;s.on("GetReader",(P,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=L=>{this._lastProgress={loaded:L.loaded,total:L.total}},i.onPull=()=>{this._fullReader.read().then(function({value:L,done:q}){if(q){i.close();return}(0,_util.assert)(L instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(L),1,[L])}).catch(L=>{i.error(L)})},i.onCancel=L=>{this._fullReader.cancel(L),i.ready.catch(q=>{if(!this.destroyed)throw q})}}),s.on("ReaderHeadersReady",P=>{const i=new _util.PromiseCapability,L=this._fullReader;return L.headersReady.then(()=>{var q;(!L.isStreamingSupported||!L.isRangeSupported)&&(this._lastProgress&&((q=c.onProgress)==null||q.call(c,this._lastProgress)),L.onProgress=$=>{var J;(J=c.onProgress)==null||J.call(c,{loaded:$.loaded,total:$.total})}),i.resolve({isStreamingSupported:L.isStreamingSupported,isRangeSupported:L.isRangeSupported,contentLength:L.contentLength})},i.reject),i.promise}),s.on("GetRangeReader",(P,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const L=this._networkStream.getRangeReader(P.begin,P.end);if(!L){i.close();return}i.onPull=()=>{L.read().then(function({value:q,done:$}){if($){i.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(q),1,[q])}).catch(q=>{i.error(q)})},i.onCancel=q=>{L.cancel(q),i.ready.catch($=>{if(!this.destroyed)throw $})}}),s.on("GetDoc",({pdfInfo:P})=>{this._numPages=P.numPages,this._htmlForXfa=P.htmlForXfa,delete P.htmlForXfa,c._capability.resolve(new PDFDocumentProxy(P,this))}),s.on("DocException",function(P){let i;switch(P.name){case"PasswordException":i=new _util.PasswordException(P.message,P.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(P.message);break;case"MissingPDFException":i=new _util.MissingPDFException(P.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(P.message,P.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(P.message,P.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}c._capability.reject(i)}),s.on("PasswordRequest",P=>{if(this._passwordCapability=new _util.PromiseCapability,c.onPassword){const i=L=>{L instanceof Error?this._passwordCapability.reject(L):this._passwordCapability.resolve({password:L})};try{c.onPassword(i,P.code)}catch(L){this._passwordCapability.reject(L)}}else this._passwordCapability.reject(new _util.PasswordException(P.message,P.code));return this._passwordCapability.promise}),s.on("DataLoaded",P=>{var i;(i=c.onProgress)==null||i.call(c,{loaded:P.length,total:P.length}),this.downloadInfoCapability.resolve(P)}),s.on("StartRenderPage",P=>{if(this.destroyed)return;u(this,x).get(P.pageIndex)._startRenderPage(P.transparency,P.cacheKey)}),s.on("commonobj",([P,i,L])=>{var q;if(!this.destroyed&&!this.commonObjs.has(P))switch(i){case"Font":const $=this._params;if("error"in L){const dt=L.error;(0,_util.warn)(`Error during font loading: ${dt}`),this.commonObjs.resolve(P,dt);break}const J=$.pdfBug&&((q=globalThis.FontInspector)!=null&&q.enabled)?(dt,ot)=>globalThis.FontInspector.fontAdded(dt,ot):null,nt=new _font_loader.FontFaceObject(L,{isEvalSupported:$.isEvalSupported,disableFontFace:$.disableFontFace,ignoreErrors:$.ignoreErrors,inspectFont:J});this.fontLoader.bind(nt).catch(dt=>s.sendWithPromise("FontFallback",{id:P})).finally(()=>{!$.fontExtraProperties&&nt.data&&(nt.data=null),this.commonObjs.resolve(P,nt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(P,L);break;default:throw new Error(`Got unknown common object type ${i}`)}}),s.on("obj",([P,i,L,q])=>{var J;if(this.destroyed)return;const $=u(this,x).get(i);if(!$.objs.has(P))switch(L){case"Image":if($.objs.resolve(P,q),q){let nt;if(q.bitmap){const{width:dt,height:ot}=q;nt=dt*ot*4}else nt=((J=q.data)==null?void 0:J.length)||0;nt>_util.MAX_IMAGE_SIZE_TO_CACHE&&($._maybeCleanupAfterRender=!0)}break;case"Pattern":$.objs.resolve(P,q);break;default:throw new Error(`Got unknown object type ${L}`)}}),s.on("DocProgress",P=>{var i;this.destroyed||(i=c.onProgress)==null||i.call(c,{loaded:P.loaded,total:P.total})}),s.on("FetchBuiltInCMap",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(P):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(P):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const c=s-1,P=u(this,f).get(c);if(P)return P;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:c}).then(L=>{if(this.destroyed)throw new Error("Transport destroyed");const q=new PDFPageProxy(c,L,this,this._params.pdfBug);return u(this,x).set(c,q),q});return u(this,f).set(c,i),i}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,c){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:c})}getFieldObjects(){return Z(this,h,ue).call(this,"GetFieldObjects")}hasJSActions(){return Z(this,h,ue).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",c=u(this,w).get(s);if(c)return c;const P=this.messageHandler.sendWithPromise(s,null).then(i=>{var L,q;return{info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:((L=this._fullReader)==null?void 0:L.filename)??null,contentLength:((q=this._fullReader)==null?void 0:q.contentLength)??null}});return u(this,w).set(s,P),P}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const c of u(this,x).values())if(!c.cleanup())throw new Error(`startCleanup: Page ${c.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),u(this,w).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:c}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:c})}}w=new WeakMap,x=new WeakMap,f=new WeakMap,h=new WeakSet,ue=function(s,c=null){const P=u(this,w).get(s);if(P)return P;const i=this.messageHandler.sendWithPromise(s,c);return u(this,w).set(s,i),i};class PDFObjects{constructor(){Y(this,v);Y(this,m,Object.create(null))}get(s,c=null){if(c){const i=Z(this,v,fe).call(this,s);return i.capability.promise.then(()=>c(i.data)),null}const P=u(this,m)[s];if(!(P!=null&&P.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return P.data}has(s){const c=u(this,m)[s];return(c==null?void 0:c.capability.settled)||!1}resolve(s,c=null){const P=Z(this,v,fe).call(this,s);P.data=c,P.capability.resolve()}clear(){var s;for(const c in u(this,m)){const{data:P}=u(this,m)[c];(s=P==null?void 0:P.bitmap)==null||s.close()}pt(this,m,Object.create(null))}}m=new WeakMap,v=new WeakSet,fe=function(s){const c=u(this,m)[s];return c||(u(this,m)[s]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(s){Y(this,g,null);pt(this,g,s),this.onContinue=null}get promise(){return u(this,g).capability.promise}cancel(s=0){u(this,g).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=u(this,g).operatorList;if(!s)return!1;const{annotationCanvasMap:c}=u(this,g);return s.form||s.canvas&&(c==null?void 0:c.size)>0}}g=new WeakMap,exports.RenderTask=RenderTask;const a=class{constructor({callback:s,params:c,objs:P,commonObjs:i,annotationCanvasMap:L,operatorList:q,pageIndex:$,canvasFactory:J,filterFactory:nt,useRequestAnimationFrame:dt=!1,pdfBug:ot=!1,pageColors:ct=null}){this.callback=s,this.params=c,this.objs=P,this.commonObjs=i,this.annotationCanvasMap=L,this.operatorListIdx=null,this.operatorList=q,this._pageIndex=$,this.canvasFactory=J,this.filterFactory=nt,this._pdfBug=ot,this.pageColors=ct,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=dt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=c.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:c}){var $,J;if(this.cancelled)return;if(this._canvas){if(u(a,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(a,t).add(this._canvas)}this._pdfBug&&(($=globalThis.StepperManager)!=null&&$.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:P,viewport:i,transform:L,background:q}=this.params;this.gfx=new _canvas.CanvasGraphics(P,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:c},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:L,viewport:i,transparency:s,background:q}),this.operatorListIdx=0,this.graphicsReady=!0,(J=this.graphicsReadyCallback)==null||J.call(this)}cancel(s=null,c=0){var P;this.running=!1,this.cancelled=!0,(P=this.gfx)==null||P.endDrawing(),this._canvas&&u(a,t).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",c))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&u(a,t).delete(this._canvas),this.callback())))}};let InternalRenderTask=a;t=new WeakMap,Y(InternalRenderTask,t,new WeakSet);const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build},(ht,b,K)=>{var U,I,y,Oe,w;Object.defineProperty(b,"__esModule",{value:!0}),b.PrintAnnotationStorage=b.AnnotationStorage=void 0;var _=K(1),k=K(4),z=K(8);class G{constructor(){Y(this,y);Y(this,U,!1);Y(this,I,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(f,h){const r=u(this,I).get(f);return r===void 0?h:Object.assign(h,r)}getRawValue(f){return u(this,I).get(f)}remove(f){if(u(this,I).delete(f),u(this,I).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const h of u(this,I).values())if(h instanceof k.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(f,h){const r=u(this,I).get(f);let m=!1;if(r!==void 0)for(const[v,T]of Object.entries(h))r[v]!==T&&(m=!0,r[v]=T);else m=!0,u(this,I).set(f,h);m&&Z(this,y,Oe).call(this),h instanceof k.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(h.constructor._type)}has(f){return u(this,I).has(f)}getAll(){return u(this,I).size>0?(0,_.objectFromMap)(u(this,I)):null}setAll(f){for(const[h,r]of Object.entries(f))this.setValue(h,r)}get size(){return u(this,I).size}resetModified(){u(this,U)&&(pt(this,U,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new it(this)}get serializable(){if(u(this,I).size===0)return null;const f=new Map;for(const[h,r]of u(this,I)){const m=r instanceof k.AnnotationEditor?r.serialize():r;m&&f.set(h,m)}return f}static getHash(f){if(!f)return"";const h=new z.MurmurHash3_64;for(const[r,m]of f)h.update(`${r}:${JSON.stringify(m)}`);return h.hexdigest()}}U=new WeakMap,I=new WeakMap,y=new WeakSet,Oe=function(){u(this,U)||(pt(this,U,!0),typeof this.onSetModified=="function"&&this.onSetModified())},b.AnnotationStorage=G;class it extends G{constructor(h){super();Y(this,w,null);pt(this,w,structuredClone(h.serializable))}get print(){(0,_.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,w)}}w=new WeakMap,b.PrintAnnotationStorage=it},(ht,b,K)=>{var G,it,U,I,y,N;Object.defineProperty(b,"__esModule",{value:!0}),b.AnnotationEditor=void 0;var _=K(5),k=K(1);const w=class{constructor(f){Y(this,G,this.focusin.bind(this));Y(this,it,this.focusout.bind(this));Y(this,U,!1);Y(this,I,!1);Y(this,y,!1);Ot(this,"_uiManager",null);Y(this,N,w._zIndex++);this.constructor===w&&(0,k.unreachable)("Cannot initialize AnnotationEditor."),this.parent=f.parent,this.id=f.id,this.width=this.height=null,this.pageIndex=f.parent.pageIndex,this.name=f.name,this.div=null,this._uiManager=f.uiManager;const{rotation:h,rawDims:{pageWidth:r,pageHeight:m,pageX:v,pageY:T}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,m],this.pageTranslation=[v,T];const[g,t]=this.parentDimensions;this.x=f.x/g,this.y=f.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,k.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(f){this._uiManager.addCommands(f)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,N)}setParent(f){f!==null&&(this.pageIndex=f.pageIndex,this.pageDimensions=f.pageDimensions),this.parent=f}focusin(f){u(this,U)?pt(this,U,!1):this.parent.setSelected(this)}focusout(f){var r;if(!this.isAttachedToDOM)return;const h=f.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(f.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(f){const h=this.parent.div.getBoundingClientRect();this.startX=f.clientX-h.x,this.startY=f.clientY-h.y,f.dataTransfer.setData("text/plain",this.id),f.dataTransfer.effectAllowed="move"}setAt(f,h,r,m){const[v,T]=this.parentDimensions;[r,m]=this.screenToPageTranslation(r,m),this.x=(f+r)/v,this.y=(h+m)/T,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(f,h){const[r,m]=this.parentDimensions;[f,h]=this.screenToPageTranslation(f,h),this.x+=f/r,this.y+=h/m,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(f,h){switch(this.parentRotation){case 90:return[h,-f];case 180:return[-f,-h];case 270:return[-h,f];default:return[f,h]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:f}=this._uiManager.viewParameters,[h,r]=this.pageDimensions;return[h*f,r*f]}setDims(f,h){const[r,m]=this.parentDimensions;this.div.style.width=`${100*f/r}%`,this.div.style.height=`${100*h/m}%`}fixDims(){const{style:f}=this.div,{height:h,width:r}=f,m=r.endsWith("%"),v=h.endsWith("%");if(m&&v)return;const[T,g]=this.parentDimensions;m||(f.width=`${100*parseFloat(r)/T}%`),v||(f.height=`${100*parseFloat(h)/g}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",u(this,G)),this.div.addEventListener("focusout",u(this,it));const[f,h]=this.getInitialTranslation();return this.translate(f,h),(0,_.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(f){const{isMac:h}=k.FeatureTest.platform;if(f.button!==0||f.ctrlKey&&h){f.preventDefault();return}f.ctrlKey&&!h||f.shiftKey||f.metaKey&&h?this.parent.toggleSelected(this):this.parent.setSelected(this),pt(this,U,!0)}getRect(f,h){const r=this.parentScale,[m,v]=this.pageDimensions,[T,g]=this.pageTranslation,t=f/r,a=h/r,o=this.x*m,s=this.y*v,c=this.width*m,P=this.height*v;switch(this.rotation){case 0:return[o+t+T,v-s-a-P+g,o+t+c+T,v-s-a+g];case 90:return[o+a+T,v-s+t+g,o+a+P+T,v-s+t+c+g];case 180:return[o-t-c+T,v-s+a+g,o-t+T,v-s+a+P+g];case 270:return[o-a-P+T,v-s-t-c+g,o-a+T,v-s-t+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(f,h){const[r,m,v,T]=f,g=v-r,t=T-m;switch(this.rotation){case 0:return[r,h-T,g,t];case 90:return[r,h-m,t,g];case 180:return[v,h-m,g,t];case 270:return[v,h-T,t,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pt(this,y,!0)}disableEditMode(){pt(this,y,!1)}isInEditMode(){return u(this,y)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var f;(f=this.div)==null||f.addEventListener("focusin",u(this,G))}serialize(){(0,k.unreachable)("An editor must be serializable")}static deserialize(f,h,r){const m=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:r});m.rotation=f.rotation;const[v,T]=m.pageDimensions,[g,t,a,o]=m.getRectInCurrentCoords(f.rect,T);return m.x=g/v,m.y=t/T,m.width=a/v,m.height=o/T,m}remove(){this.div.removeEventListener("focusin",u(this,G)),this.div.removeEventListener("focusout",u(this,it)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var f;(f=this.div)==null||f.classList.add("selectedEditor")}unselect(){var f;(f=this.div)==null||f.classList.remove("selectedEditor")}updateParams(f,h){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return u(this,I)}set isEditing(f){pt(this,I,f),f?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let z=w;G=new WeakMap,it=new WeakMap,U=new WeakMap,I=new WeakMap,y=new WeakMap,N=new WeakMap,Ot(z,"_colorManager",new _.ColorManager),Ot(z,"_zIndex",1),b.AnnotationEditor=z},(ht,b,K)=>{var w,x,f,h,r,m,Ie,g,t,a,o,s,c,P,i,L,q,$,J,nt,dt,ot,ct,mt,yt,St,_t,W,l,d,S,Le,O,pe,D,Ne,M,je,n,Ht,A,te,B,Be,X,Ue,rt,ge,st,ee,ft,me;Object.defineProperty(b,"__esModule",{value:!0}),b.KeyboardManager=b.CommandManager=b.ColorManager=b.AnnotationEditorUIManager=void 0,b.bindEvents=z,b.opacityToHex=G;var _=K(1),k=K(6);function z(Ct,V,bt){for(const vt of bt)V.addEventListener(vt,Ct[vt].bind(Ct))}function G(Ct){return Math.round(Math.min(255,Math.max(1,255*Ct))).toString(16).padStart(2,"0")}class it{constructor(){Y(this,w,0)}getId(){return`${_.AnnotationEditorPrefix}${ie(this,w)._++}`}}w=new WeakMap;class U{constructor(V=128){Y(this,x,[]);Y(this,f,!1);Y(this,h,void 0);Y(this,r,-1);pt(this,h,V)}add({cmd:V,undo:bt,mustExec:vt,type:Rt=NaN,overwriteIfSameType:lt=!1,keepUndo:C=!1}){if(vt&&V(),u(this,f))return;const F={cmd:V,undo:bt,type:Rt};if(u(this,r)===-1){u(this,x).length>0&&(u(this,x).length=0),pt(this,r,0),u(this,x).push(F);return}if(lt&&u(this,x)[u(this,r)].type===Rt){C&&(F.undo=u(this,x)[u(this,r)].undo),u(this,x)[u(this,r)]=F;return}const at=u(this,r)+1;at===u(this,h)?u(this,x).splice(0,1):(pt(this,r,at),at<u(this,x).length&&u(this,x).splice(at)),u(this,x).push(F)}undo(){u(this,r)!==-1&&(pt(this,f,!0),u(this,x)[u(this,r)].undo(),pt(this,f,!1),pt(this,r,u(this,r)-1))}redo(){u(this,r)<u(this,x).length-1&&(pt(this,r,u(this,r)+1),pt(this,f,!0),u(this,x)[u(this,r)].cmd(),pt(this,f,!1))}hasSomethingToUndo(){return u(this,r)!==-1}hasSomethingToRedo(){return u(this,r)<u(this,x).length-1}destroy(){pt(this,x,null)}}x=new WeakMap,f=new WeakMap,h=new WeakMap,r=new WeakMap,b.CommandManager=U;class I{constructor(V){Y(this,m);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:bt}=_.FeatureTest.platform;for(const[vt,Rt]of V)for(const lt of vt){const C=lt.startsWith("mac+");bt&&C?(this.callbacks.set(lt.slice(4),Rt),this.allKeys.add(lt.split("+").at(-1))):!bt&&!C&&(this.callbacks.set(lt,Rt),this.allKeys.add(lt.split("+").at(-1)))}}exec(V,bt){if(!this.allKeys.has(bt.key))return;const vt=this.callbacks.get(Z(this,m,Ie).call(this,bt));vt&&(vt.bind(V)(),bt.stopPropagation(),bt.preventDefault())}}m=new WeakSet,Ie=function(V){V.altKey&&this.buffer.push("alt"),V.ctrlKey&&this.buffer.push("ctrl"),V.metaKey&&this.buffer.push("meta"),V.shiftKey&&this.buffer.push("shift"),this.buffer.push(V.key);const bt=this.buffer.join("+");return this.buffer.length=0,bt},b.KeyboardManager=I;const T=class{get _colors(){const V=new Map([["CanvasText",null],["Canvas",null]]);return(0,k.getColorValues)(V),(0,_.shadow)(this,"_colors",V)}convert(V){const bt=(0,k.getRGB)(V);if(!window.matchMedia("(forced-colors: active)").matches)return bt;for(const[vt,Rt]of this._colors)if(Rt.every((lt,C)=>lt===bt[C]))return T._colorsMapping.get(vt);return bt}getHexCode(V){const bt=this._colors.get(V);return bt?_.Util.makeHexColor(...bt):V}};let y=T;Ot(y,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),b.ColorManager=y;const At=class{constructor(V,bt,vt){Y(this,S);Y(this,O);Y(this,D);Y(this,M);Y(this,n);Y(this,A);Y(this,B);Y(this,X);Y(this,rt);Y(this,st);Y(this,ft);Y(this,g,null);Y(this,t,new Map);Y(this,a,new Map);Y(this,o,null);Y(this,s,new U);Y(this,c,0);Y(this,P,null);Y(this,i,new Set);Y(this,L,null);Y(this,q,new it);Y(this,$,!1);Y(this,J,_.AnnotationEditorType.NONE);Y(this,nt,new Set);Y(this,dt,this.copy.bind(this));Y(this,ot,this.cut.bind(this));Y(this,ct,this.paste.bind(this));Y(this,mt,this.keydown.bind(this));Y(this,yt,this.onEditingAction.bind(this));Y(this,St,this.onPageChanging.bind(this));Y(this,_t,this.onScaleChanging.bind(this));Y(this,W,this.onRotationChanging.bind(this));Y(this,l,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Y(this,d,null);pt(this,d,V),pt(this,L,bt),u(this,L)._on("editingaction",u(this,yt)),u(this,L)._on("pagechanging",u(this,St)),u(this,L)._on("scalechanging",u(this,_t)),u(this,L)._on("rotationchanging",u(this,W)),pt(this,o,vt),this.viewParameters={realScale:k.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){Z(this,O,pe).call(this),u(this,L)._off("editingaction",u(this,yt)),u(this,L)._off("pagechanging",u(this,St)),u(this,L)._off("scalechanging",u(this,_t)),u(this,L)._off("rotationchanging",u(this,W));for(const V of u(this,a).values())V.destroy();u(this,a).clear(),u(this,t).clear(),u(this,i).clear(),pt(this,g,null),u(this,nt).clear(),u(this,s).destroy()}onPageChanging({pageNumber:V}){pt(this,c,V-1)}focusMainContainer(){u(this,d).focus()}addShouldRescale(V){u(this,i).add(V)}removeShouldRescale(V){u(this,i).delete(V)}onScaleChanging({scale:V}){this.commitOrRemove(),this.viewParameters.realScale=V*k.PixelsPerInch.PDF_TO_CSS_UNITS;for(const bt of u(this,i))bt.onScaleChanging()}onRotationChanging({pagesRotation:V}){this.commitOrRemove(),this.viewParameters.rotation=V}addToAnnotationStorage(V){!V.isEmpty()&&u(this,o)&&!u(this,o).has(V.id)&&u(this,o).setValue(V.id,V)}copy(V){if(V.preventDefault(),u(this,g)&&u(this,g).commitOrRemove(),!this.hasSelection)return;const bt=[];for(const vt of u(this,nt))vt.isEmpty()||bt.push(vt.serialize());bt.length!==0&&V.clipboardData.setData("application/pdfjs",JSON.stringify(bt))}cut(V){this.copy(V),this.delete()}paste(V){V.preventDefault();let bt=V.clipboardData.getData("application/pdfjs");if(!bt)return;try{bt=JSON.parse(bt)}catch(Rt){(0,_.warn)(`paste: "${Rt.message}".`);return}if(!Array.isArray(bt))return;this.unselectAll();const vt=u(this,a).get(u(this,c));try{const Rt=[];for(const F of bt){const at=vt.deserialize(F);if(!at)return;Rt.push(at)}const lt=()=>{for(const F of Rt)Z(this,rt,ge).call(this,F);Z(this,ft,me).call(this,Rt)},C=()=>{for(const F of Rt)F.remove()};this.addCommands({cmd:lt,undo:C,mustExec:!0})}catch(Rt){(0,_.warn)(`paste: "${Rt.message}".`)}}keydown(V){var bt;(bt=this.getActive())!=null&&bt.shouldGetKeyboardEvents()||At._keyboardManager.exec(this,V)}onEditingAction(V){["undo","redo","delete","selectAll"].includes(V.name)&&this[V.name]()}setEditingState(V){V?(Z(this,S,Le).call(this),Z(this,D,Ne).call(this),Z(this,n,Ht).call(this,{isEditing:u(this,J)!==_.AnnotationEditorType.NONE,isEmpty:Z(this,st,ee).call(this),hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:u(this,s).hasSomethingToRedo(),hasSelectedEditor:!1})):(Z(this,O,pe).call(this),Z(this,M,je).call(this),Z(this,n,Ht).call(this,{isEditing:!1}))}registerEditorTypes(V){if(!u(this,P)){pt(this,P,V);for(const bt of u(this,P))Z(this,A,te).call(this,bt.defaultPropertiesToUpdate)}}getId(){return u(this,q).getId()}get currentLayer(){return u(this,a).get(u(this,c))}get currentPageIndex(){return u(this,c)}addLayer(V){u(this,a).set(V.pageIndex,V),u(this,$)?V.enable():V.disable()}removeLayer(V){u(this,a).delete(V.pageIndex)}updateMode(V){if(pt(this,J,V),V===_.AnnotationEditorType.NONE)this.setEditingState(!1),Z(this,X,Ue).call(this);else{this.setEditingState(!0),Z(this,B,Be).call(this);for(const bt of u(this,a).values())bt.updateMode(V)}}updateToolbar(V){V!==u(this,J)&&u(this,L).dispatch("switchannotationeditormode",{source:this,mode:V})}updateParams(V,bt){if(u(this,P)){for(const vt of u(this,nt))vt.updateParams(V,bt);for(const vt of u(this,P))vt.updateDefaultParams(V,bt)}}getEditors(V){const bt=[];for(const vt of u(this,t).values())vt.pageIndex===V&&bt.push(vt);return bt}getEditor(V){return u(this,t).get(V)}addEditor(V){u(this,t).set(V.id,V)}removeEditor(V){var bt;u(this,t).delete(V.id),this.unselect(V),(bt=u(this,o))==null||bt.remove(V.id)}setActiveEditor(V){u(this,g)!==V&&(pt(this,g,V),V&&Z(this,A,te).call(this,V.propertiesToUpdate))}toggleSelected(V){if(u(this,nt).has(V)){u(this,nt).delete(V),V.unselect(),Z(this,n,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,nt).add(V),V.select(),Z(this,A,te).call(this,V.propertiesToUpdate),Z(this,n,Ht).call(this,{hasSelectedEditor:!0})}setSelected(V){for(const bt of u(this,nt))bt!==V&&bt.unselect();u(this,nt).clear(),u(this,nt).add(V),V.select(),Z(this,A,te).call(this,V.propertiesToUpdate),Z(this,n,Ht).call(this,{hasSelectedEditor:!0})}isSelected(V){return u(this,nt).has(V)}unselect(V){V.unselect(),u(this,nt).delete(V),Z(this,n,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,nt).size!==0}undo(){u(this,s).undo(),Z(this,n,Ht).call(this,{hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Z(this,st,ee).call(this)})}redo(){u(this,s).redo(),Z(this,n,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,s).hasSomethingToRedo(),isEmpty:Z(this,st,ee).call(this)})}addCommands(V){u(this,s).add(V),Z(this,n,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Z(this,st,ee).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const V=[...u(this,nt)],bt=()=>{for(const Rt of V)Rt.remove()},vt=()=>{for(const Rt of V)Z(this,rt,ge).call(this,Rt)};this.addCommands({cmd:bt,undo:vt,mustExec:!0})}commitOrRemove(){var V;(V=u(this,g))==null||V.commitOrRemove()}selectAll(){for(const V of u(this,nt))V.commit();Z(this,ft,me).call(this,u(this,t).values())}unselectAll(){if(u(this,g)){u(this,g).commitOrRemove();return}if(u(this,nt).size!==0){for(const V of u(this,nt))V.unselect();u(this,nt).clear(),Z(this,n,Ht).call(this,{hasSelectedEditor:!1})}}isActive(V){return u(this,g)===V}getActive(){return u(this,g)}getMode(){return u(this,J)}};let N=At;g=new WeakMap,t=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,c=new WeakMap,P=new WeakMap,i=new WeakMap,L=new WeakMap,q=new WeakMap,$=new WeakMap,J=new WeakMap,nt=new WeakMap,dt=new WeakMap,ot=new WeakMap,ct=new WeakMap,mt=new WeakMap,yt=new WeakMap,St=new WeakMap,_t=new WeakMap,W=new WeakMap,l=new WeakMap,d=new WeakMap,S=new WeakSet,Le=function(){u(this,d).addEventListener("keydown",u(this,mt))},O=new WeakSet,pe=function(){u(this,d).removeEventListener("keydown",u(this,mt))},D=new WeakSet,Ne=function(){document.addEventListener("copy",u(this,dt)),document.addEventListener("cut",u(this,ot)),document.addEventListener("paste",u(this,ct))},M=new WeakSet,je=function(){document.removeEventListener("copy",u(this,dt)),document.removeEventListener("cut",u(this,ot)),document.removeEventListener("paste",u(this,ct))},n=new WeakSet,Ht=function(V){Object.entries(V).some(([vt,Rt])=>u(this,l)[vt]!==Rt)&&u(this,L).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,l),V)})},A=new WeakSet,te=function(V){u(this,L).dispatch("annotationeditorparamschanged",{source:this,details:V})},B=new WeakSet,Be=function(){if(!u(this,$)){pt(this,$,!0);for(const V of u(this,a).values())V.enable()}},X=new WeakSet,Ue=function(){if(this.unselectAll(),u(this,$)){pt(this,$,!1);for(const V of u(this,a).values())V.disable()}},rt=new WeakSet,ge=function(V){const bt=u(this,a).get(V.pageIndex);bt?bt.addOrRebuild(V):this.addEditor(V)},st=new WeakSet,ee=function(){if(u(this,t).size===0)return!0;if(u(this,t).size===1)for(const V of u(this,t).values())return V.isEmpty();return!1},ft=new WeakSet,me=function(V){u(this,nt).clear();for(const bt of V)bt.isEmpty()||(u(this,nt).add(bt),bt.select());Z(this,n,Ht).call(this,{hasSelectedEditor:!0})},Ot(N,"_keyboardManager",new I([[["ctrl+a","mac+meta+a"],At.prototype.selectAll],[["ctrl+z","mac+meta+z"],At.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],At.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],At.prototype.delete],[["Escape","mac+Escape"],At.prototype.unselectAll]])),b.AnnotationEditorUIManager=N},(ht,b,K)=>{var dt,ot,ct,mt,yt,St,_t,W,l,Jt,S,$t,O,Vt;Object.defineProperty(b,"__esModule",{value:!0}),b.StatTimer=b.RenderingCancelledException=b.PixelsPerInch=b.PageViewport=b.PDFDateString=b.DOMStandardFontDataFactory=b.DOMSVGFactory=b.DOMFilterFactory=b.DOMCanvasFactory=b.DOMCMapReaderFactory=b.AnnotationPrefix=void 0,b.deprecated=o,b.getColorValues=L,b.getCurrentTransform=q,b.getCurrentTransformInverse=$,b.getFilenameFromUrl=v,b.getPdfFilenameFromUrl=T,b.getRGB=i,b.getXfaPageViewport=P,b.isDataScheme=r,b.isPdfFile=m,b.isValidFetchUrl=t,b.loadScript=a,b.setLayerDimensions=J;var _=K(7),k=K(1);const z="http://www.w3.org/2000/svg",G="pdfjs_internal_id_";b.AnnotationPrefix=G;const nt=class{};let it=nt;Ot(it,"CSS",96),Ot(it,"PDF",72),Ot(it,"PDF_TO_CSS_UNITS",nt.CSS/nt.PDF),b.PixelsPerInch=it;class U extends _.BaseFilterFactory{constructor({docId:M,ownerDocument:e=globalThis.document}={}){super();Y(this,l);Y(this,S);Y(this,O);Y(this,dt,void 0);Y(this,ot,void 0);Y(this,ct,void 0);Y(this,mt,void 0);Y(this,yt,void 0);Y(this,St,void 0);Y(this,_t,void 0);Y(this,W,0);pt(this,ct,M),pt(this,mt,e)}addFilter(M){if(!M)return"none";let e=u(this,l,Jt).get(M);if(e)return e;let n,p,A,E;if(M.length===1){const rt=M[0],Q=new Array(256);for(let st=0;st<256;st++)Q[st]=rt[st]/255;E=n=p=A=Q.join(",")}else{const[rt,Q,st]=M,ut=new Array(256),ft=new Array(256),Et=new Array(256);for(let At=0;At<256;At++)ut[At]=rt[At]/255,ft[At]=Q[At]/255,Et[At]=st[At]/255;n=ut.join(","),p=ft.join(","),A=Et.join(","),E=`${n}${p}${A}`}if(e=u(this,l,Jt).get(E),e)return u(this,l,Jt).set(M,e),e;const B=`g_${u(this,ct)}_transfer_map_${ie(this,W)._++}`,tt=`url(#${B})`;u(this,l,Jt).set(M,tt),u(this,l,Jt).set(E,tt);const X=u(this,mt).createElementNS(z,"filter",z);X.setAttribute("id",B),X.setAttribute("color-interpolation-filters","sRGB");const et=u(this,mt).createElementNS(z,"feComponentTransfer");return X.append(et),Z(this,O,Vt).call(this,et,"feFuncR",n),Z(this,O,Vt).call(this,et,"feFuncG",p),Z(this,O,Vt).call(this,et,"feFuncB",A),u(this,S,$t).append(X),tt}addHCMFilter(M,e){var st;const n=`${M}-${e}`;if(u(this,St)===n)return u(this,_t);if(pt(this,St,n),pt(this,_t,"none"),(st=u(this,yt))==null||st.remove(),!M||!e)return u(this,_t);u(this,S,$t).style.color=M,M=getComputedStyle(u(this,S,$t)).getPropertyValue("color");const p=i(M);M=k.Util.makeHexColor(...p),u(this,S,$t).style.color=e,e=getComputedStyle(u(this,S,$t)).getPropertyValue("color");const A=i(e);if(e=k.Util.makeHexColor(...A),u(this,S,$t).style.color="",M==="#000000"&&e==="#ffffff"||M===e)return u(this,_t);const E=new Array(256);for(let ut=0;ut<=255;ut++){const ft=ut/255;E[ut]=ft<=.03928?ft/12.92:((ft+.055)/1.055)**2.4}const B=E.join(","),tt=`g_${u(this,ct)}_hcm_filter`,X=pt(this,yt,u(this,mt).createElementNS(z,"filter",z));X.setAttribute("id",tt),X.setAttribute("color-interpolation-filters","sRGB");let et=u(this,mt).createElementNS(z,"feComponentTransfer");X.append(et),Z(this,O,Vt).call(this,et,"feFuncR",B),Z(this,O,Vt).call(this,et,"feFuncG",B),Z(this,O,Vt).call(this,et,"feFuncB",B);const rt=u(this,mt).createElementNS(z,"feColorMatrix");rt.setAttribute("type","matrix"),rt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),X.append(rt),et=u(this,mt).createElementNS(z,"feComponentTransfer"),X.append(et);const Q=(ut,ft)=>{const Et=p[ut]/255,At=A[ut]/255,Ct=new Array(ft+1);for(let V=0;V<=ft;V++)Ct[V]=Et+V/ft*(At-Et);return Ct.join(",")};return Z(this,O,Vt).call(this,et,"feFuncR",Q(0,5)),Z(this,O,Vt).call(this,et,"feFuncG",Q(1,5)),Z(this,O,Vt).call(this,et,"feFuncB",Q(2,5)),u(this,S,$t).append(X),pt(this,_t,`url(#${tt})`),u(this,_t)}destroy(M=!1){M&&u(this,_t)||(u(this,ot)&&(u(this,ot).parentNode.parentNode.remove(),pt(this,ot,null)),u(this,dt)&&(u(this,dt).clear(),pt(this,dt,null)),pt(this,W,0))}}dt=new WeakMap,ot=new WeakMap,ct=new WeakMap,mt=new WeakMap,yt=new WeakMap,St=new WeakMap,_t=new WeakMap,W=new WeakMap,l=new WeakSet,Jt=function(){return u(this,dt)||pt(this,dt,new Map)},S=new WeakSet,$t=function(){if(!u(this,ot)){const M=u(this,mt).createElement("div"),{style:e}=M;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=u(this,mt).createElementNS(z,"svg");n.setAttribute("width",0),n.setAttribute("height",0),pt(this,ot,u(this,mt).createElementNS(z,"defs")),M.append(n),n.append(u(this,ot)),u(this,mt).body.append(M)}return u(this,ot)},O=new WeakSet,Vt=function(M,e,n){const p=u(this,mt).createElementNS(z,e);p.setAttribute("type","discrete"),p.setAttribute("tableValues",n),M.append(p)},b.DOMFilterFactory=U;class I extends _.BaseCanvasFactory{constructor({ownerDocument:R=globalThis.document}={}){super(),this._document=R}_createCanvas(R,M){const e=this._document.createElement("canvas");return e.width=R,e.height=M,e}}b.DOMCanvasFactory=I;async function y(D,R=!1){if(t(D,document.baseURI)){const M=await fetch(D);if(!M.ok)throw new Error(M.statusText);return R?new Uint8Array(await M.arrayBuffer()):(0,k.stringToBytes)(await M.text())}return new Promise((M,e)=>{const n=new XMLHttpRequest;n.open("GET",D,!0),R&&(n.responseType="arraybuffer"),n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){let p;if(R&&n.response?p=new Uint8Array(n.response):!R&&n.responseText&&(p=(0,k.stringToBytes)(n.responseText)),p){M(p);return}}e(new Error(n.statusText))}},n.send(null)})}class N extends _.BaseCMapReaderFactory{_fetchData(R,M){return y(R,this.isCompressed).then(e=>({cMapData:e,compressionType:M}))}}b.DOMCMapReaderFactory=N;class w extends _.BaseStandardFontDataFactory{_fetchData(R){return y(R,!0)}}b.DOMStandardFontDataFactory=w;class x extends _.BaseSVGFactory{_createSVG(R){return document.createElementNS(z,R)}}b.DOMSVGFactory=x;class f{constructor({viewBox:R,scale:M,rotation:e,offsetX:n=0,offsetY:p=0,dontFlip:A=!1}){this.viewBox=R,this.scale=M,this.rotation=e,this.offsetX=n,this.offsetY=p;const E=(R[2]+R[0])/2,B=(R[3]+R[1])/2;let tt,X,et,rt;switch(e%=360,e<0&&(e+=360),e){case 180:tt=-1,X=0,et=0,rt=1;break;case 90:tt=0,X=1,et=1,rt=0;break;case 270:tt=0,X=-1,et=-1,rt=0;break;case 0:tt=1,X=0,et=0,rt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}A&&(et=-et,rt=-rt);let Q,st,ut,ft;tt===0?(Q=Math.abs(B-R[1])*M+n,st=Math.abs(E-R[0])*M+p,ut=(R[3]-R[1])*M,ft=(R[2]-R[0])*M):(Q=Math.abs(E-R[0])*M+n,st=Math.abs(B-R[1])*M+p,ut=(R[2]-R[0])*M,ft=(R[3]-R[1])*M),this.transform=[tt*M,X*M,et*M,rt*M,Q-tt*M*E-et*M*B,st-X*M*E-rt*M*B],this.width=ut,this.height=ft}get rawDims(){const{viewBox:R}=this;return(0,k.shadow)(this,"rawDims",{pageWidth:R[2]-R[0],pageHeight:R[3]-R[1],pageX:R[0],pageY:R[1]})}clone({scale:R=this.scale,rotation:M=this.rotation,offsetX:e=this.offsetX,offsetY:n=this.offsetY,dontFlip:p=!1}={}){return new f({viewBox:this.viewBox.slice(),scale:R,rotation:M,offsetX:e,offsetY:n,dontFlip:p})}convertToViewportPoint(R,M){return k.Util.applyTransform([R,M],this.transform)}convertToViewportRectangle(R){const M=k.Util.applyTransform([R[0],R[1]],this.transform),e=k.Util.applyTransform([R[2],R[3]],this.transform);return[M[0],M[1],e[0],e[1]]}convertToPdfPoint(R,M){return k.Util.applyInverseTransform([R,M],this.transform)}}b.PageViewport=f;class h extends k.BaseException{constructor(R,M,e=0){super(R,"RenderingCancelledException"),this.type=M,this.extraDelay=e}}b.RenderingCancelledException=h;function r(D){const R=D.length;let M=0;for(;M<R&&D[M].trim()==="";)M++;return D.substring(M,M+5).toLowerCase()==="data:"}function m(D){return typeof D=="string"&&/\.pdf$/i.test(D)}function v(D,R=!1){return R||([D]=D.split(/[#?]/,1)),D.substring(D.lastIndexOf("/")+1)}function T(D,R="document.pdf"){if(typeof D!="string")return R;if(r(D))return(0,k.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),R;const M=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=M.exec(D);let p=e.exec(n[1])||e.exec(n[2])||e.exec(n[3]);if(p&&(p=p[0],p.includes("%")))try{p=e.exec(decodeURIComponent(p))[0]}catch{}return p||R}class g{constructor(){Ot(this,"started",Object.create(null));Ot(this,"times",[])}time(R){R in this.started&&(0,k.warn)(`Timer is already running for ${R}`),this.started[R]=Date.now()}timeEnd(R){R in this.started||(0,k.warn)(`Timer has not been started for ${R}`),this.times.push({name:R,start:this.started[R],end:Date.now()}),delete this.started[R]}toString(){const R=[];let M=0;for(const{name:e}of this.times)M=Math.max(e.length,M);for(const{name:e,start:n,end:p}of this.times)R.push(`${e.padEnd(M)} ${p-n}ms
`);return R.join("")}}b.StatTimer=g;function t(D,R){try{const{protocol:M}=R?new URL(D,R):new URL(D);return M==="http:"||M==="https:"}catch{return!1}}function a(D,R=!1){return new Promise((M,e)=>{const n=document.createElement("script");n.src=D,n.onload=function(p){R&&n.remove(),M(p)},n.onerror=function(){e(new Error(`Cannot load script at: ${n.src}`))},(document.head||document.documentElement).append(n)})}function o(D){console.log("Deprecated API usage: "+D)}let s;class c{static toDateObject(R){if(!R||typeof R!="string")return null;s||(s=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const M=s.exec(R);if(!M)return null;const e=parseInt(M[1],10);let n=parseInt(M[2],10);n=n>=1&&n<=12?n-1:0;let p=parseInt(M[3],10);p=p>=1&&p<=31?p:1;let A=parseInt(M[4],10);A=A>=0&&A<=23?A:0;let E=parseInt(M[5],10);E=E>=0&&E<=59?E:0;let B=parseInt(M[6],10);B=B>=0&&B<=59?B:0;const tt=M[7]||"Z";let X=parseInt(M[8],10);X=X>=0&&X<=23?X:0;let et=parseInt(M[9],10)||0;return et=et>=0&&et<=59?et:0,tt==="-"?(A+=X,E+=et):tt==="+"&&(A-=X,E-=et),new Date(Date.UTC(e,n,p,A,E,B))}}b.PDFDateString=c;function P(D,{scale:R=1,rotation:M=0}){const{width:e,height:n}=D.attributes.style,p=[0,0,parseInt(e),parseInt(n)];return new f({viewBox:p,scale:R,rotation:M})}function i(D){if(D.startsWith("#")){const R=parseInt(D.slice(1),16);return[(R&16711680)>>16,(R&65280)>>8,R&255]}return D.startsWith("rgb(")?D.slice(4,-1).split(",").map(R=>parseInt(R)):D.startsWith("rgba(")?D.slice(5,-1).split(",").map(R=>parseInt(R)).slice(0,3):((0,k.warn)(`Not a valid color format: "${D}"`),[0,0,0])}function L(D){const R=document.createElement("span");R.style.visibility="hidden",document.body.append(R);for(const M of D.keys()){R.style.color=M;const e=window.getComputedStyle(R).color;D.set(M,i(e))}R.remove()}function q(D){const{a:R,b:M,c:e,d:n,e:p,f:A}=D.getTransform();return[R,M,e,n,p,A]}function $(D){const{a:R,b:M,c:e,d:n,e:p,f:A}=D.getTransform().invertSelf();return[R,M,e,n,p,A]}function J(D,R,M=!1,e=!0){if(R instanceof f){const{pageWidth:n,pageHeight:p}=R.rawDims,{style:A}=D,E=`calc(var(--scale-factor) * ${n}px)`,B=`calc(var(--scale-factor) * ${p}px)`;!M||R.rotation%180===0?(A.width=E,A.height=B):(A.width=B,A.height=E)}e&&D.setAttribute("data-main-rotation",R.rotation)}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BaseStandardFontDataFactory=b.BaseSVGFactory=b.BaseFilterFactory=b.BaseCanvasFactory=b.BaseCMapReaderFactory=void 0;var _=K(1);class k{constructor(){this.constructor===k&&(0,_.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(y){return"none"}addHCMFilter(y,N){return"none"}destroy(y=!1){}}b.BaseFilterFactory=k;class z{constructor(){this.constructor===z&&(0,_.unreachable)("Cannot initialize BaseCanvasFactory.")}create(y,N){if(y<=0||N<=0)throw new Error("Invalid canvas size");const w=this._createCanvas(y,N);return{canvas:w,context:w.getContext("2d")}}reset(y,N,w){if(!y.canvas)throw new Error("Canvas is not specified");if(N<=0||w<=0)throw new Error("Invalid canvas size");y.canvas.width=N,y.canvas.height=w}destroy(y){if(!y.canvas)throw new Error("Canvas is not specified");y.canvas.width=0,y.canvas.height=0,y.canvas=null,y.context=null}_createCanvas(y,N){(0,_.unreachable)("Abstract method `_createCanvas` called.")}}b.BaseCanvasFactory=z;class G{constructor({baseUrl:y=null,isCompressed:N=!0}){this.constructor===G&&(0,_.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=y,this.isCompressed=N}async fetch({name:y}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!y)throw new Error("CMap name must be specified.");const N=this.baseUrl+y+(this.isCompressed?".bcmap":""),w=this.isCompressed?_.CMapCompressionType.BINARY:_.CMapCompressionType.NONE;return this._fetchData(N,w).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})}_fetchData(y,N){(0,_.unreachable)("Abstract method `_fetchData` called.")}}b.BaseCMapReaderFactory=G;class it{constructor({baseUrl:y=null}){this.constructor===it&&(0,_.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=y}async fetch({filename:y}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!y)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${y}`;return this._fetchData(N).catch(w=>{throw new Error(`Unable to load font data at: ${N}`)})}_fetchData(y){(0,_.unreachable)("Abstract method `_fetchData` called.")}}b.BaseStandardFontDataFactory=it;class U{constructor(){this.constructor===U&&(0,_.unreachable)("Cannot initialize BaseSVGFactory.")}create(y,N,w=!1){if(y<=0||N<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),w||(x.setAttribute("width",`${y}px`),x.setAttribute("height",`${N}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${y} ${N}`),x}createElement(y){if(typeof y!="string")throw new Error("Invalid SVG element type");return this._createSVG(y)}_createSVG(y){(0,_.unreachable)("Abstract method `_createSVG` called.")}}b.BaseSVGFactory=U},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MurmurHash3_64=void 0;var _=K(1);const k=3285377520,z=4294901760,G=65535;class it{constructor(I){this.h1=I?I&4294967295:k,this.h2=I?I&4294967295:k}update(I){let y,N;if(typeof I=="string"){y=new Uint8Array(I.length*2),N=0;for(let o=0,s=I.length;o<s;o++){const c=I.charCodeAt(o);c<=255?y[N++]=c:(y[N++]=c>>>8,y[N++]=c&255)}}else if((0,_.isArrayBuffer)(I))y=I.slice(),N=y.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=N>>2,x=N-w*4,f=new Uint32Array(y.buffer,0,w);let h=0,r=0,m=this.h1,v=this.h2;const T=3432918353,g=461845907,t=T&G,a=g&G;for(let o=0;o<w;o++)o&1?(h=f[o],h=h*T&z|h*t&G,h=h<<15|h>>>17,h=h*g&z|h*a&G,m^=h,m=m<<13|m>>>19,m=m*5+3864292196):(r=f[o],r=r*T&z|r*t&G,r=r<<15|r>>>17,r=r*g&z|r*a&G,v^=r,v=v<<13|v>>>19,v=v*5+3864292196);switch(h=0,x){case 3:h^=y[w*4+2]<<16;case 2:h^=y[w*4+1]<<8;case 1:h^=y[w*4],h=h*T&z|h*t&G,h=h<<15|h>>>17,h=h*g&z|h*a&G,w&1?m^=h:v^=h}this.h1=m,this.h2=v}hexdigest(){let I=this.h1,y=this.h2;return I^=y>>>1,I=I*3981806797&z|I*36045&G,y=y*4283543511&z|((y<<16|I>>>16)*2950163797&z)>>>16,I^=y>>>1,I=I*444984403&z|I*60499&G,y=y*3301882366&z|((y<<16|I>>>16)*3120437893&z)>>>16,I^=y>>>1,(I>>>0).toString(16).padStart(8,"0")+(y>>>0).toString(16).padStart(8,"0")}}b.MurmurHash3_64=it},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.FontLoader=b.FontFaceObject=void 0;var _=K(1),k=K(10);class z{constructor({ownerDocument:U=globalThis.document,styleElement:I=null}){this._document=U,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(U){this.nativeFontFaces.push(U),this._document.fonts.add(U)}insertRule(U){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const I=this.styleElement.sheet;I.insertRule(U,I.cssRules.length)}clear(){for(const U of this.nativeFontFaces)this._document.fonts.delete(U);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(U){if(U.attached||U.missingFile)return;if(U.attached=!0,this.isFontLoadingAPISupported){const y=U.createNativeFontFace();if(y){this.addNativeFontFace(y);try{await y.loaded}catch(N){throw(0,_.warn)(`Failed to load font '${y.family}': '${N}'.`),U.disableFontFace=!0,N}}return}const I=U.createFontFaceRule();if(I){if(this.insertRule(I),this.isSyncFontLoadingSupported)return;await new Promise(y=>{const N=this._queueLoadingCallback(y);this._prepareFontLoadEvent(U,N)})}}get isFontLoadingAPISupported(){var I;const U=!!((I=this._document)!=null&&I.fonts);return(0,_.shadow)(this,"isFontLoadingAPISupported",U)}get isSyncFontLoadingSupported(){let U=!1;return(k.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(U=!0),(0,_.shadow)(this,"isSyncFontLoadingSupported",U)}_queueLoadingCallback(U){function I(){for((0,_.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;y.length>0&&y[0].done;){const w=y.shift();setTimeout(w.callback,0)}}const{loadingRequests:y}=this,N={done:!1,complete:I,callback:U};return y.push(N),N}get _loadTestFont(){const U=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,_.shadow)(this,"_loadTestFont",U)}_prepareFontLoadEvent(U,I){function y(i,L){return i.charCodeAt(L)<<24|i.charCodeAt(L+1)<<16|i.charCodeAt(L+2)<<8|i.charCodeAt(L+3)&255}function N(i,L,q,$){const J=i.substring(0,L),nt=i.substring(L+q);return J+$+nt}let w,x;const f=this._document.createElement("canvas");f.width=1,f.height=1;const h=f.getContext("2d");let r=0;function m(i,L){if(++r>30){(0,_.warn)("Load test font never loaded."),L();return}if(h.font="30px "+i,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(m.bind(null,i,L))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let T=this._loadTestFont;T=N(T,976,v.length,v);const t=16,a=1482184792;let o=y(T,t);for(w=0,x=v.length-3;w<x;w+=4)o=o-a+y(v,w)|0;w<v.length&&(o=o-a+y(v+"XXX",w)|0),T=N(T,t,4,(0,_.string32)(o));const s=`url(data:font/opentype;base64,${btoa(T)});`,c=`@font-face {font-family:"${v}";src:${s}}`;this.insertRule(c);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const i of[U.loadedName,v]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=i,P.append(L)}this._document.body.append(P),m(v,()=>{P.remove(),I.complete()})}}b.FontLoader=z;class G{constructor(U,{isEvalSupported:I=!0,disableFontFace:y=!1,ignoreErrors:N=!1,inspectFont:w=null}){this.compiledGlyphs=Object.create(null);for(const x in U)this[x]=U[x];this.isEvalSupported=I!==!1,this.disableFontFace=y===!0,this.ignoreErrors=N===!0,this._inspectFont=w}createNativeFontFace(){var I;if(!this.data||this.disableFontFace)return null;let U;if(!this.cssFontInfo)U=new FontFace(this.loadedName,this.data,{});else{const y={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(y.style=`oblique ${this.cssFontInfo.italicAngle}deg`),U=new FontFace(this.cssFontInfo.fontFamily,this.data,y)}return(I=this._inspectFont)==null||I.call(this,this),U}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const U=(0,_.bytesToString)(this.data),I=`url(data:${this.mimetype};base64,${btoa(U)});`;let y;if(!this.cssFontInfo)y=`@font-face {font-family:"${this.loadedName}";src:${I}}`;else{let w=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(w+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),y=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${w}src:${I}}`}return(N=this._inspectFont)==null||N.call(this,this,I),y}getPathGenerator(U,I){if(this.compiledGlyphs[I]!==void 0)return this.compiledGlyphs[I];let y;try{y=U.get(this.loadedName+"_path_"+I)}catch(N){if(!this.ignoreErrors)throw N;return(0,_.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[I]=function(w,x){}}if(this.isEvalSupported&&_.FeatureTest.isEvalSupported){const N=[];for(const w of y){const x=w.args!==void 0?w.args.join(","):"";N.push("c.",w.cmd,"(",x,`);
`)}return this.compiledGlyphs[I]=new Function("c","size",N.join(""))}return this.compiledGlyphs[I]=function(N,w){for(const x of y)x.cmd==="scale"&&(x.args=[w,-w]),N[x.cmd].apply(N,x.args)}}}b.FontFaceObject=G},(ht,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.isNodeJS=void 0;const K=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");b.isNodeJS=K},(ht,b,K)=>{var ct,be,yt,_e;Object.defineProperty(b,"__esModule",{value:!0}),b.CanvasGraphics=void 0;var _=K(1),k=K(6),z=K(12),G=K(13),it=K(10);const U=16,I=100,y=4096,N=15,w=10,x=1e3,f=16;function h(W,l){if(W._removeMirroring)throw new Error("Context is already forwarding operations.");W.__originalSave=W.save,W.__originalRestore=W.restore,W.__originalRotate=W.rotate,W.__originalScale=W.scale,W.__originalTranslate=W.translate,W.__originalTransform=W.transform,W.__originalSetTransform=W.setTransform,W.__originalResetTransform=W.resetTransform,W.__originalClip=W.clip,W.__originalMoveTo=W.moveTo,W.__originalLineTo=W.lineTo,W.__originalBezierCurveTo=W.bezierCurveTo,W.__originalRect=W.rect,W.__originalClosePath=W.closePath,W.__originalBeginPath=W.beginPath,W._removeMirroring=()=>{W.save=W.__originalSave,W.restore=W.__originalRestore,W.rotate=W.__originalRotate,W.scale=W.__originalScale,W.translate=W.__originalTranslate,W.transform=W.__originalTransform,W.setTransform=W.__originalSetTransform,W.resetTransform=W.__originalResetTransform,W.clip=W.__originalClip,W.moveTo=W.__originalMoveTo,W.lineTo=W.__originalLineTo,W.bezierCurveTo=W.__originalBezierCurveTo,W.rect=W.__originalRect,W.closePath=W.__originalClosePath,W.beginPath=W.__originalBeginPath,delete W._removeMirroring},W.save=function(){l.save(),this.__originalSave()},W.restore=function(){l.restore(),this.__originalRestore()},W.translate=function(S,j){l.translate(S,j),this.__originalTranslate(S,j)},W.scale=function(S,j){l.scale(S,j),this.__originalScale(S,j)},W.transform=function(S,j,O,H,D,R){l.transform(S,j,O,H,D,R),this.__originalTransform(S,j,O,H,D,R)},W.setTransform=function(S,j,O,H,D,R){l.setTransform(S,j,O,H,D,R),this.__originalSetTransform(S,j,O,H,D,R)},W.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},W.rotate=function(S){l.rotate(S),this.__originalRotate(S)},W.clip=function(S){l.clip(S),this.__originalClip(S)},W.moveTo=function(d,S){l.moveTo(d,S),this.__originalMoveTo(d,S)},W.lineTo=function(d,S){l.lineTo(d,S),this.__originalLineTo(d,S)},W.bezierCurveTo=function(d,S,j,O,H,D){l.bezierCurveTo(d,S,j,O,H,D),this.__originalBezierCurveTo(d,S,j,O,H,D)},W.rect=function(d,S,j,O){l.rect(d,S,j,O),this.__originalRect(d,S,j,O)},W.closePath=function(){l.closePath(),this.__originalClosePath()},W.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class r{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,d,S){let j;return this.cache[l]!==void 0?(j=this.cache[l],this.canvasFactory.reset(j,d,S)):(j=this.canvasFactory.create(d,S),this.cache[l]=j),j}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const d=this.cache[l];this.canvasFactory.destroy(d),delete this.cache[l]}}}function m(W,l,d,S,j,O,H,D,R,M){const[e,n,p,A,E,B]=(0,k.getCurrentTransform)(W);if(n===0&&p===0){const et=H*e+E,rt=Math.round(et),Q=D*A+B,st=Math.round(Q),ut=(H+R)*e+E,ft=Math.abs(Math.round(ut)-rt)||1,Et=(D+M)*A+B,At=Math.abs(Math.round(Et)-st)||1;return W.setTransform(Math.sign(e),0,0,Math.sign(A),rt,st),W.drawImage(l,d,S,j,O,0,0,ft,At),W.setTransform(e,n,p,A,E,B),[ft,At]}if(e===0&&A===0){const et=D*p+E,rt=Math.round(et),Q=H*n+B,st=Math.round(Q),ut=(D+M)*p+E,ft=Math.abs(Math.round(ut)-rt)||1,Et=(H+R)*n+B,At=Math.abs(Math.round(Et)-st)||1;return W.setTransform(0,Math.sign(n),Math.sign(p),0,rt,st),W.drawImage(l,d,S,j,O,0,0,At,ft),W.setTransform(e,n,p,A,E,B),[At,ft]}W.drawImage(l,d,S,j,O,H,D,R,M);const tt=Math.hypot(e,n),X=Math.hypot(p,A);return[tt*R,X*M]}function v(W){const{width:l,height:d}=W;if(l>x||d>x)return null;const S=1e3,j=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),O=l+1;let H=new Uint8Array(O*(d+1)),D,R,M;const e=l+7&-8;let n=new Uint8Array(e*d),p=0;for(const X of W.data){let et=128;for(;et>0;)n[p++]=X&et?0:255,et>>=1}let A=0;for(p=0,n[p]!==0&&(H[0]=1,++A),R=1;R<l;R++)n[p]!==n[p+1]&&(H[R]=n[p]?2:1,++A),p++;for(n[p]!==0&&(H[R]=2,++A),D=1;D<d;D++){p=D*e,M=D*O,n[p-e]!==n[p]&&(H[M]=n[p]?1:8,++A);let X=(n[p]?4:0)+(n[p-e]?8:0);for(R=1;R<l;R++)X=(X>>2)+(n[p+1]?4:0)+(n[p-e+1]?8:0),j[X]&&(H[M+R]=j[X],++A),p++;if(n[p-e]!==n[p]&&(H[M+R]=n[p]?2:4,++A),A>S)return null}for(p=e*(d-1),M=D*O,n[p]!==0&&(H[M]=8,++A),R=1;R<l;R++)n[p]!==n[p+1]&&(H[M+R]=n[p]?4:8,++A),p++;if(n[p]!==0&&(H[M+R]=4,++A),A>S)return null;const E=new Int32Array([0,O,-1,0,-O,0,0,0,1]),B=new Path2D;for(D=0;A&&D<=d;D++){let X=D*O;const et=X+l;for(;X<et&&!H[X];)X++;if(X===et)continue;B.moveTo(X%O,D);const rt=X;let Q=H[X];do{const st=E[Q];do X+=st;while(!H[X]);const ut=H[X];ut!==5&&ut!==10?(Q=ut,H[X]=0):(Q=ut&51*Q>>4,H[X]&=Q>>2|Q<<2),B.lineTo(X%O,X/O|0),H[X]||--A}while(rt!==X);--D}return n=null,H=null,function(X){X.save(),X.scale(1/l,-1/d),X.translate(0,-d),X.fill(B),X.beginPath(),X.restore()}}class T{constructor(l,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=_.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,d])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,d){this.x=l,this.y=d}updatePathMinMax(l,d,S){[d,S]=_.Util.applyTransform([d,S],l),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(l,d){const S=_.Util.applyTransform(d,l),j=_.Util.applyTransform(d.slice(2),l);this.minX=Math.min(this.minX,S[0],j[0]),this.minY=Math.min(this.minY,S[1],j[1]),this.maxX=Math.max(this.maxX,S[0],j[0]),this.maxY=Math.max(this.maxY,S[1],j[1])}updateScalingPathMinMax(l,d){_.Util.scaleMinMax(l,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(l,d,S,j,O,H,D,R,M,e){const n=_.Util.bezierBoundingBox(d,S,j,O,H,D,R,M);if(e){e[0]=Math.min(e[0],n[0],n[2]),e[1]=Math.max(e[1],n[0],n[2]),e[2]=Math.min(e[2],n[1],n[3]),e[3]=Math.max(e[3],n[1],n[3]);return}this.updateRectMinMax(l,n)}getPathBoundingBox(l=z.PathType.FILL,d=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(l===z.PathType.STROKE){d||(0,_.unreachable)("Stroke bounding box must include transform.");const j=_.Util.singularValueDecompose2dScale(d),O=j[0]*this.lineWidth/2,H=j[1]*this.lineWidth/2;S[0]-=O,S[1]-=H,S[2]+=O,S[3]+=H}return S}updateClipFromPath(){const l=_.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=z.PathType.FILL,d=null){return _.Util.intersect(this.clipBox,this.getPathBoundingBox(l,d))}}function g(W,l){if(typeof ImageData<"u"&&l instanceof ImageData){W.putImageData(l,0,0);return}const d=l.height,S=l.width,j=d%f,O=(d-j)/f,H=j===0?O:O+1,D=W.createImageData(S,f);let R=0,M;const e=l.data,n=D.data;let p,A,E,B;if(l.kind===_.ImageKind.GRAYSCALE_1BPP){const tt=e.byteLength,X=new Uint32Array(n.buffer,0,n.byteLength>>2),et=X.length,rt=S+7>>3,Q=4294967295,st=_.FeatureTest.isLittleEndian?4278190080:255;for(p=0;p<H;p++){for(E=p<O?f:j,M=0,A=0;A<E;A++){const ut=tt-R;let ft=0;const Et=ut>rt?S:ut*8-7,At=Et&-8;let Ct=0,V=0;for(;ft<At;ft+=8)V=e[R++],X[M++]=V&128?Q:st,X[M++]=V&64?Q:st,X[M++]=V&32?Q:st,X[M++]=V&16?Q:st,X[M++]=V&8?Q:st,X[M++]=V&4?Q:st,X[M++]=V&2?Q:st,X[M++]=V&1?Q:st;for(;ft<Et;ft++)Ct===0&&(V=e[R++],Ct=128),X[M++]=V&Ct?Q:st,Ct>>=1}for(;M<et;)X[M++]=0;W.putImageData(D,0,p*f)}}else if(l.kind===_.ImageKind.RGBA_32BPP){for(A=0,B=S*f*4,p=0;p<O;p++)n.set(e.subarray(R,R+B)),R+=B,W.putImageData(D,0,A),A+=f;p<H&&(B=S*j*4,n.set(e.subarray(R,R+B)),W.putImageData(D,0,A))}else if(l.kind===_.ImageKind.RGB_24BPP)for(E=f,B=S*E,p=0;p<H;p++){for(p>=O&&(E=j,B=S*E),M=0,A=B;A--;)n[M++]=e[R++],n[M++]=e[R++],n[M++]=e[R++],n[M++]=255;W.putImageData(D,0,p*f)}else throw new Error(`bad image kind: ${l.kind}`)}function t(W,l){if(l.bitmap){W.drawImage(l.bitmap,0,0);return}const d=l.height,S=l.width,j=d%f,O=(d-j)/f,H=j===0?O:O+1,D=W.createImageData(S,f);let R=0;const M=l.data,e=D.data;for(let n=0;n<H;n++){const p=n<O?f:j;({srcPos:R}=(0,G.convertBlackAndWhiteToRGBA)({src:M,srcPos:R,dest:e,width:S,height:p,nonBlackColor:0})),W.putImageData(D,0,n*f)}}function a(W,l){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const S of d)W[S]!==void 0&&(l[S]=W[S]);W.setLineDash!==void 0&&(l.setLineDash(W.getLineDash()),l.lineDashOffset=W.lineDashOffset)}function o(W){W.strokeStyle=W.fillStyle="#000000",W.fillRule="nonzero",W.globalAlpha=1,W.lineWidth=1,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=10,W.globalCompositeOperation="source-over",W.font="10px sans-serif",W.setLineDash!==void 0&&(W.setLineDash([]),W.lineDashOffset=0),it.isNodeJS||(W.filter="none")}function s(W,l,d,S){const j=W.length;for(let O=3;O<j;O+=4){const H=W[O];if(H===0)W[O-3]=l,W[O-2]=d,W[O-1]=S;else if(H<255){const D=255-H;W[O-3]=W[O-3]*H+l*D>>8,W[O-2]=W[O-2]*H+d*D>>8,W[O-1]=W[O-1]*H+S*D>>8}}}function c(W,l,d){const S=W.length,j=1/255;for(let O=3;O<S;O+=4){const H=d?d[W[O]]:W[O];l[O]=l[O]*H*j|0}}function P(W,l,d){const S=W.length;for(let j=3;j<S;j+=4){const O=W[j-3]*77+W[j-2]*152+W[j-1]*28;l[j]=d?l[j]*d[O>>8]>>8:l[j]*O>>16}}function i(W,l,d,S,j,O,H,D,R,M,e){const n=!!O,p=n?O[0]:0,A=n?O[1]:0,E=n?O[2]:0;let B;j==="Luminosity"?B=P:B=c;const X=Math.min(S,Math.ceil(1048576/d));for(let et=0;et<S;et+=X){const rt=Math.min(X,S-et),Q=W.getImageData(D-M,et+(R-e),d,rt),st=l.getImageData(D,et+R,d,rt);n&&s(Q.data,p,A,E),B(Q.data,st.data,H),l.putImageData(st,D,et+R)}}function L(W,l,d,S){const j=S[0],O=S[1],H=S[2]-j,D=S[3]-O;H===0||D===0||(i(l.context,d,H,D,l.subtype,l.backdrop,l.transferMap,j,O,l.offsetX,l.offsetY),W.save(),W.globalAlpha=1,W.globalCompositeOperation="source-over",W.setTransform(1,0,0,1,0,0),W.drawImage(d.canvas,0,0),W.restore())}function q(W,l){const d=_.Util.singularValueDecompose2dScale(W);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*k.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:d[0]<=S||d[1]<=S}const $=["butt","round","square"],J=["miter","round","bevel"],nt={},dt={},_t=class{constructor(l,d,S,j,O,{optionalContentConfig:H,markedContentStack:D=null},R,M){Y(this,ct);Y(this,yt);this.ctx=l,this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=S,this.canvasFactory=j,this.filterFactory=O,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=D||[],this.optionalContentConfig=H,this.cachedCanvases=new r(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=M,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,d=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):d}beginDrawing({transform:l,viewport:d,transparency:S=!1,background:j=null}){const O=this.ctx.canvas.width,H=this.ctx.canvas.height,D=this.ctx.fillStyle;if(this.ctx.fillStyle=j||"#ffffff",this.ctx.fillRect(0,0,O,H),this.ctx.fillStyle=D,S){const R=this.cachedCanvases.getCanvas("transparent",O,H);this.compositeCtx=this.ctx,this.transparentCanvas=R.canvas,this.ctx=R.context,this.ctx.save(),this.ctx.transform(...(0,k.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,k.getCurrentTransform)(this.ctx)}executeOperatorList(l,d,S,j){const O=l.argsArray,H=l.fnArray;let D=d||0;const R=O.length;if(R===D)return D;const M=R-D>w&&typeof S=="function",e=M?Date.now()+N:0;let n=0;const p=this.commonObjs,A=this.objs;let E;for(;;){if(j!==void 0&&D===j.nextBreakPoint)return j.breakIt(D,S),D;if(E=H[D],E!==_.OPS.dependency)this[E].apply(this,O[D]);else for(const B of O[D]){const tt=B.startsWith("g_")?p:A;if(!tt.has(B))return tt.get(B,S),D}if(D++,D===R)return D;if(M&&++n>w){if(Date.now()>e)return S(),D;n=0}}}endDrawing(){Z(this,ct,be).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const d of l.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);l.clear()}this._cachedBitmapsMap.clear(),Z(this,yt,_e).call(this)}_scaleImage(l,d){const S=l.width,j=l.height;let O=Math.max(Math.hypot(d[0],d[1]),1),H=Math.max(Math.hypot(d[2],d[3]),1),D=S,R=j,M="prescale1",e,n;for(;O>2&&D>1||H>2&&R>1;){let p=D,A=R;O>2&&D>1&&(p=D>=16384?Math.floor(D/2)-1||1:Math.ceil(D/2),O/=D/p),H>2&&R>1&&(A=R>=16384?Math.floor(R/2)-1||1:Math.ceil(R)/2,H/=R/A),e=this.cachedCanvases.getCanvas(M,p,A),n=e.context,n.clearRect(0,0,p,A),n.drawImage(l,0,0,D,R,0,0,p,A),l=e.canvas,D=p,R=A,M=M==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:D,paintHeight:R}}_createMaskCanvas(l){const d=this.ctx,{width:S,height:j}=l,O=this.current.fillColor,H=this.current.patternFill,D=(0,k.getCurrentTransform)(d);let R,M,e,n;if((l.bitmap||l.data)&&l.count>1){const ft=l.bitmap||l.data.buffer;M=JSON.stringify(H?D:[D.slice(0,4),O]),R=this._cachedBitmapsMap.get(ft),R||(R=new Map,this._cachedBitmapsMap.set(ft,R));const Et=R.get(M);if(Et&&!H){const At=Math.round(Math.min(D[0],D[2])+D[4]),Ct=Math.round(Math.min(D[1],D[3])+D[5]);return{canvas:Et,offsetX:At,offsetY:Ct}}e=Et}e||(n=this.cachedCanvases.getCanvas("maskCanvas",S,j),t(n.context,l));let p=_.Util.transform(D,[1/S,0,0,-1/j,0,0]);p=_.Util.transform(p,[1,0,0,1,0,-j]);const A=_.Util.applyTransform([0,0],p),E=_.Util.applyTransform([S,j],p),B=_.Util.normalizeRect([A[0],A[1],E[0],E[1]]),tt=Math.round(B[2]-B[0])||1,X=Math.round(B[3]-B[1])||1,et=this.cachedCanvases.getCanvas("fillCanvas",tt,X),rt=et.context,Q=Math.min(A[0],E[0]),st=Math.min(A[1],E[1]);rt.translate(-Q,-st),rt.transform(...p),e||(e=this._scaleImage(n.canvas,(0,k.getCurrentTransformInverse)(rt)),e=e.img,R&&H&&R.set(M,e)),rt.imageSmoothingEnabled=q((0,k.getCurrentTransform)(rt),l.interpolate),m(rt,e,0,0,e.width,e.height,0,0,S,j),rt.globalCompositeOperation="source-in";const ut=_.Util.transform((0,k.getCurrentTransformInverse)(rt),[1,0,0,1,-Q,-st]);return rt.fillStyle=H?O.getPattern(d,this,ut,z.PathType.FILL):O,rt.fillRect(0,0,S,j),R&&!H&&(this.cachedCanvases.delete("fillCanvas"),R.set(M,et.canvas)),{canvas:et.canvas,offsetX:Math.round(Q),offsetY:Math.round(st)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=$[l]}setLineJoin(l){this.ctx.lineJoin=J[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,d){const S=this.ctx;S.setLineDash!==void 0&&(S.setLineDash(l),S.lineDashOffset=d)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[d,S]of l)switch(d){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S[0],S[1]);break;case"CA":this.current.strokeAlpha=S;break;case"ca":this.current.fillAlpha=S,this.ctx.globalAlpha=S;break;case"BM":this.ctx.globalCompositeOperation=S;break;case"SMask":this.current.activeSMask=S?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(S);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,d=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,j=this.cachedCanvases.getCanvas(S,l,d);this.suspendedCtx=this.ctx,this.ctx=j.context;const O=this.ctx;O.setTransform(...(0,k.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,O),h(O,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,S=this.suspendedCtx;L(S,d,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(l,d,S,j,O,H){this.ctx.transform(l,d,S,j,O,H),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(l,d,S){const j=this.ctx,O=this.current;let H=O.x,D=O.y,R,M;const e=(0,k.getCurrentTransform)(j),n=e[0]===0&&e[3]===0||e[1]===0&&e[2]===0,p=n?S.slice(0):null;for(let A=0,E=0,B=l.length;A<B;A++)switch(l[A]|0){case _.OPS.rectangle:H=d[E++],D=d[E++];const tt=d[E++],X=d[E++],et=H+tt,rt=D+X;j.moveTo(H,D),tt===0||X===0?j.lineTo(et,rt):(j.lineTo(et,D),j.lineTo(et,rt),j.lineTo(H,rt)),n||O.updateRectMinMax(e,[H,D,et,rt]),j.closePath();break;case _.OPS.moveTo:H=d[E++],D=d[E++],j.moveTo(H,D),n||O.updatePathMinMax(e,H,D);break;case _.OPS.lineTo:H=d[E++],D=d[E++],j.lineTo(H,D),n||O.updatePathMinMax(e,H,D);break;case _.OPS.curveTo:R=H,M=D,H=d[E+4],D=d[E+5],j.bezierCurveTo(d[E],d[E+1],d[E+2],d[E+3],H,D),O.updateCurvePathMinMax(e,R,M,d[E],d[E+1],d[E+2],d[E+3],H,D,p),E+=6;break;case _.OPS.curveTo2:R=H,M=D,j.bezierCurveTo(H,D,d[E],d[E+1],d[E+2],d[E+3]),O.updateCurvePathMinMax(e,R,M,H,D,d[E],d[E+1],d[E+2],d[E+3],p),H=d[E+2],D=d[E+3],E+=4;break;case _.OPS.curveTo3:R=H,M=D,H=d[E+2],D=d[E+3],j.bezierCurveTo(d[E],d[E+1],H,D,H,D),O.updateCurvePathMinMax(e,R,M,d[E],d[E+1],H,D,H,D,p),E+=4;break;case _.OPS.closePath:j.closePath();break}n&&O.updateScalingPathMinMax(e,p),O.setCurrentPoint(H,D)}closePath(){this.ctx.closePath()}stroke(l=!0){const d=this.ctx,S=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof S=="object"&&(S!=null&&S.getPattern)?(d.save(),d.strokeStyle=S.getPattern(d,this,(0,k.getCurrentTransformInverse)(d),z.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const d=this.ctx,S=this.current.fillColor,j=this.current.patternFill;let O=!1;j&&(d.save(),d.fillStyle=S.getPattern(d,this,(0,k.getCurrentTransformInverse)(d),z.PathType.FILL),O=!0);const H=this.current.getClippedPathBoundingBox();this.contentVisible&&H!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),O&&d.restore(),l&&this.consumePath(H)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nt}eoClip(){this.pendingClip=dt}beginText(){this.current.textMatrix=_.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,d=this.ctx;if(l===void 0){d.beginPath();return}d.save(),d.beginPath();for(const S of l)d.setTransform(...S.transform),d.translate(S.x,S.y),S.addToPath(d,S.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,d){const S=this.commonObjs.get(l),j=this.current;if(!S)throw new Error(`Can't find font for ${l}`);if(j.fontMatrix=S.fontMatrix||_.FONT_IDENTITY_MATRIX,(j.fontMatrix[0]===0||j.fontMatrix[3]===0)&&(0,_.warn)("Invalid font matrix for font "+l),d<0?(d=-d,j.fontDirection=-1):j.fontDirection=1,this.current.font=S,this.current.fontSize=d,S.isType3Font)return;const O=S.loadedName||"sans-serif";let H="normal";S.black?H="900":S.bold&&(H="bold");const D=S.italic?"italic":"normal",R=`"${O}", ${S.fallbackName}`;let M=d;d<U?M=U:d>I&&(M=I),this.current.fontSizeScale=d/M,this.ctx.font=`${D} ${H} ${M}px ${R}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,d){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=d}setLeadingMoveText(l,d){this.setLeading(-d),this.moveText(l,d)}setTextMatrix(l,d,S,j,O,H){this.current.textMatrix=[l,d,S,j,O,H],this.current.textMatrixScale=Math.hypot(l,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,d,S,j){const O=this.ctx,H=this.current,D=H.font,R=H.textRenderingMode,M=H.fontSize/H.fontSizeScale,e=R&_.TextRenderingMode.FILL_STROKE_MASK,n=!!(R&_.TextRenderingMode.ADD_TO_PATH_FLAG),p=H.patternFill&&!D.missingFile;let A;(D.disableFontFace||n||p)&&(A=D.getPathGenerator(this.commonObjs,l)),D.disableFontFace||p?(O.save(),O.translate(d,S),O.beginPath(),A(O,M),j&&O.setTransform(...j),(e===_.TextRenderingMode.FILL||e===_.TextRenderingMode.FILL_STROKE)&&O.fill(),(e===_.TextRenderingMode.STROKE||e===_.TextRenderingMode.FILL_STROKE)&&O.stroke(),O.restore()):((e===_.TextRenderingMode.FILL||e===_.TextRenderingMode.FILL_STROKE)&&O.fillText(l,d,S),(e===_.TextRenderingMode.STROKE||e===_.TextRenderingMode.FILL_STROKE)&&O.strokeText(l,d,S)),n&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,k.getCurrentTransform)(O),x:d,y:S,fontSize:M,addToPath:A})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const d=l.getImageData(0,0,10,10).data;let S=!1;for(let j=3;j<d.length;j+=4)if(d[j]>0&&d[j]<255){S=!0;break}return(0,_.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(l){const d=this.current,S=d.font;if(S.isType3Font)return this.showType3Text(l);const j=d.fontSize;if(j===0)return;const O=this.ctx,H=d.fontSizeScale,D=d.charSpacing,R=d.wordSpacing,M=d.fontDirection,e=d.textHScale*M,n=l.length,p=S.vertical,A=p?1:-1,E=S.defaultVMetrics,B=j*d.fontMatrix[0],tt=d.textRenderingMode===_.TextRenderingMode.FILL&&!S.disableFontFace&&!d.patternFill;O.save(),O.transform(...d.textMatrix),O.translate(d.x,d.y+d.textRise),M>0?O.scale(e,-1):O.scale(e,1);let X;if(d.patternFill){O.save();const ut=d.fillColor.getPattern(O,this,(0,k.getCurrentTransformInverse)(O),z.PathType.FILL);X=(0,k.getCurrentTransform)(O),O.restore(),O.fillStyle=ut}let et=d.lineWidth;const rt=d.textMatrixScale;if(rt===0||et===0){const ut=d.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;(ut===_.TextRenderingMode.STROKE||ut===_.TextRenderingMode.FILL_STROKE)&&(et=this.getSinglePixelWidth())}else et/=rt;if(H!==1&&(O.scale(H,H),et/=H),O.lineWidth=et,S.isInvalidPDFjsFont){const ut=[];let ft=0;for(const Et of l)ut.push(Et.unicode),ft+=Et.width;O.fillText(ut.join(""),0,0),d.x+=ft*B*e,O.restore(),this.compose();return}let Q=0,st;for(st=0;st<n;++st){const ut=l[st];if(typeof ut=="number"){Q+=A*ut*j/1e3;continue}let ft=!1;const Et=(ut.isSpace?R:0)+D,At=ut.fontChar,Ct=ut.accent;let V,bt,vt=ut.width;if(p){const lt=ut.vmetric||E,C=-(ut.vmetric?lt[1]:vt*.5)*B,F=lt[2]*B;vt=lt?-lt[0]:vt,V=C/H,bt=(Q+F)/H}else V=Q/H,bt=0;if(S.remeasure&&vt>0){const lt=O.measureText(At).width*1e3/j*H;if(vt<lt&&this.isFontSubpixelAAEnabled){const C=vt/lt;ft=!0,O.save(),O.scale(C,1),V/=C}else vt!==lt&&(V+=(vt-lt)/2e3*j/H)}if(this.contentVisible&&(ut.isInFont||S.missingFile)){if(tt&&!Ct)O.fillText(At,V,bt);else if(this.paintChar(At,V,bt,X),Ct){const lt=V+j*Ct.offset.x/H,C=bt-j*Ct.offset.y/H;this.paintChar(Ct.fontChar,lt,C,X)}}let Rt;p?Rt=vt*B-Et*M:Rt=vt*B+Et*M,Q+=Rt,ft&&O.restore()}p?d.y-=Q:d.x+=Q*e,O.restore(),this.compose()}showType3Text(l){const d=this.ctx,S=this.current,j=S.font,O=S.fontSize,H=S.fontDirection,D=j.vertical?1:-1,R=S.charSpacing,M=S.wordSpacing,e=S.textHScale*H,n=S.fontMatrix||_.FONT_IDENTITY_MATRIX,p=l.length,A=S.textRenderingMode===_.TextRenderingMode.INVISIBLE;let E,B,tt,X;if(!(A||O===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...S.textMatrix),d.translate(S.x,S.y),d.scale(e,H),E=0;E<p;++E){if(B=l[E],typeof B=="number"){X=D*B*O/1e3,this.ctx.translate(X,0),S.x+=X*e;continue}const et=(B.isSpace?M:0)+R,rt=j.charProcOperatorList[B.operatorListId];if(!rt){(0,_.warn)(`Type3 character "${B.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=B,this.save(),d.scale(O,O),d.transform(...n),this.executeOperatorList(rt),this.restore()),tt=_.Util.applyTransform([B.width,0],n)[0]*O+et,d.translate(tt,0),S.x+=tt*e}d.restore(),this.processingType3=null}}setCharWidth(l,d){}setCharWidthAndBounds(l,d,S,j,O,H){this.ctx.rect(S,j,O-S,H-j),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let d;if(l[0]==="TilingPattern"){const S=l[1],j=this.baseTransform||(0,k.getCurrentTransform)(this.ctx),O={createCanvasGraphics:H=>new _t(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};d=new z.TilingPattern(l,S,this.ctx,O,j)}else d=this._getPattern(l[1],l[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,d,S){const j=_.Util.makeHexColor(l,d,S);this.ctx.strokeStyle=j,this.current.strokeColor=j}setFillRGBColor(l,d,S){const j=_.Util.makeHexColor(l,d,S);this.ctx.fillStyle=j,this.current.fillColor=j,this.current.patternFill=!1}_getPattern(l,d=null){let S;return this.cachedPatterns.has(l)?S=this.cachedPatterns.get(l):(S=(0,z.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,S)),d&&(S.matrix=d),S}shadingFill(l){if(!this.contentVisible)return;const d=this.ctx;this.save();const S=this._getPattern(l);d.fillStyle=S.getPattern(d,this,(0,k.getCurrentTransformInverse)(d),z.PathType.SHADING);const j=(0,k.getCurrentTransformInverse)(d);if(j){const O=d.canvas,H=O.width,D=O.height,R=_.Util.applyTransform([0,0],j),M=_.Util.applyTransform([0,D],j),e=_.Util.applyTransform([H,0],j),n=_.Util.applyTransform([H,D],j),p=Math.min(R[0],M[0],e[0],n[0]),A=Math.min(R[1],M[1],e[1],n[1]),E=Math.max(R[0],M[0],e[0],n[0]),B=Math.max(R[1],M[1],e[1],n[1]);this.ctx.fillRect(p,A,E-p,B-A)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,_.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,_.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,k.getCurrentTransform)(this.ctx),d)){const S=d[2]-d[0],j=d[3]-d[1];this.ctx.rect(d[0],d[1],S,j),this.current.updateRectMinMax((0,k.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;l.isolated||(0,_.info)("TODO: Support non-isolated groups."),l.knockout&&(0,_.warn)("Knockout groups not supported.");const S=(0,k.getCurrentTransform)(d);if(l.matrix&&d.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let j=_.Util.getAxialAlignedBoundingBox(l.bbox,(0,k.getCurrentTransform)(d));const O=[0,0,d.canvas.width,d.canvas.height];j=_.Util.intersect(j,O)||[0,0,0,0];const H=Math.floor(j[0]),D=Math.floor(j[1]);let R=Math.max(Math.ceil(j[2])-H,1),M=Math.max(Math.ceil(j[3])-D,1),e=1,n=1;R>y&&(e=R/y,R=y),M>y&&(n=M/y,M=y),this.current.startNewPathAndClipBox([0,0,R,M]);let p="groupAt"+this.groupLevel;l.smask&&(p+="_smask_"+this.smaskCounter++%2);const A=this.cachedCanvases.getCanvas(p,R,M),E=A.context;E.scale(1/e,1/n),E.translate(-H,-D),E.transform(...S),l.smask?this.smaskStack.push({canvas:A.canvas,context:E,offsetX:H,offsetY:D,scaleX:e,scaleY:n,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(H,D),d.scale(e,n),d.save()),a(d,E),this.ctx=E,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const j=(0,k.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...j);const O=_.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],j);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(O)}}beginAnnotation(l,d,S,j,O){if(Z(this,ct,be).call(this),o(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const H=d[2]-d[0],D=d[3]-d[1];if(O&&this.annotationCanvasMap){S=S.slice(),S[4]-=d[0],S[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=H,d[3]=D;const[R,M]=_.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(this.ctx)),{viewportScale:e}=this,n=Math.ceil(H*this.outputScaleX*e),p=Math.ceil(D*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(n,p);const{canvas:A,context:E}=this.annotationCanvas;this.annotationCanvasMap.set(l,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=E,this.ctx.save(),this.ctx.setTransform(R,0,0,-M,0,D*M),o(this.ctx)}else o(this.ctx),this.ctx.rect(d[0],d[1],H,D),this.ctx.clip(),this.endPath()}this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...j)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Z(this,yt,_e).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const d=l.count;l=this.getObject(l.data,l),l.count=d;const S=this.ctx,j=this.processingType3;if(j&&(j.compiled===void 0&&(j.compiled=v(l)),j.compiled)){j.compiled(S);return}const O=this._createMaskCanvas(l),H=O.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(H,O.offsetX,O.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(l,d,S=0,j=0,O,H){if(!this.contentVisible)return;l=this.getObject(l.data,l);const D=this.ctx;D.save();const R=(0,k.getCurrentTransform)(D);D.transform(d,S,j,O,0,0);const M=this._createMaskCanvas(l);D.setTransform(1,0,0,1,M.offsetX-R[4],M.offsetY-R[5]);for(let e=0,n=H.length;e<n;e+=2){const p=_.Util.transform(R,[d,S,j,O,H[e],H[e+1]]),[A,E]=_.Util.applyTransform([0,0],p);D.drawImage(M.canvas,A,E)}D.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const d=this.ctx,S=this.current.fillColor,j=this.current.patternFill;for(const O of l){const{data:H,width:D,height:R,transform:M}=O,e=this.cachedCanvases.getCanvas("maskCanvas",D,R),n=e.context;n.save();const p=this.getObject(H,O);t(n,p),n.globalCompositeOperation="source-in",n.fillStyle=j?S.getPattern(n,this,(0,k.getCurrentTransformInverse)(d),z.PathType.FILL):S,n.fillRect(0,0,D,R),n.restore(),d.save(),d.transform(...M),d.scale(1,-1),m(d,e.canvas,0,0,D,R,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const d=this.getObject(l);if(!d){(0,_.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(l,d,S,j){if(!this.contentVisible)return;const O=this.getObject(l);if(!O){(0,_.warn)("Dependent image isn't ready yet");return}const H=O.width,D=O.height,R=[];for(let M=0,e=j.length;M<e;M+=2)R.push({transform:[d,0,0,S,j[M],j[M+1]],x:0,y:0,w:H,h:D});this.paintInlineImageXObjectGroup(O,R)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:d,width:S,height:j}=l,O=this.cachedCanvases.getCanvas("inlineImage",S,j),H=O.context;return H.filter=this.current.transferMaps,H.drawImage(d,0,0),H.filter="none",O.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const d=l.width,S=l.height,j=this.ctx;this.save(),it.isNodeJS||(j.filter="none"),j.scale(1/d,-1/S);let O;if(l.bitmap)O=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)O=l;else{const R=this.cachedCanvases.getCanvas("inlineImage",d,S).context;g(R,l),O=this.applyTransferMapsToCanvas(R)}const H=this._scaleImage(O,(0,k.getCurrentTransformInverse)(j));j.imageSmoothingEnabled=q((0,k.getCurrentTransform)(j),l.interpolate),m(j,H.img,0,0,H.paintWidth,H.paintHeight,0,-S,d,S),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,d){if(!this.contentVisible)return;const S=this.ctx;let j;if(l.bitmap)j=l.bitmap;else{const O=l.width,H=l.height,R=this.cachedCanvases.getCanvas("inlineImage",O,H).context;g(R,l),j=this.applyTransferMapsToCanvas(R)}for(const O of d)S.save(),S.transform(...O.transform),S.scale(1,-1),m(S,j,O.x,O.y,O.w,O.h,0,-1,1,1),S.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,d){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,d){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const S=this.ctx;this.pendingClip&&(d||(this.pendingClip===dt?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,k.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const d=Math.abs(l[0]*l[3]-l[2]*l[1]),S=Math.hypot(l[0],l[2]),j=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(S,j)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:l}=this.current,d=(0,k.getCurrentTransform)(this.ctx);let S,j;if(d[1]===0&&d[2]===0){const O=Math.abs(d[0]),H=Math.abs(d[3]);if(l===0)S=1/O,j=1/H;else{const D=O*l,R=H*l;S=D<1?1/D:1,j=R<1?1/R:1}}else{const O=Math.abs(d[0]*d[3]-d[2]*d[1]),H=Math.hypot(d[0],d[1]),D=Math.hypot(d[2],d[3]);if(l===0)S=D/O,j=H/O;else{const R=l*O;S=D>R?D/R:1,j=H>R?H/R:1}}this._cachedScaleForStroking=[S,j]}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:d}=this,{lineWidth:S}=this.current,[j,O]=this.getScaleForStroking();if(d.lineWidth=S||1,j===1&&O===1){d.stroke();return}let H,D,R;l&&(H=(0,k.getCurrentTransform)(d),D=d.getLineDash().slice(),R=d.lineDashOffset),d.scale(j,O);const M=Math.max(j,O);d.setLineDash(d.getLineDash().map(e=>e/M)),d.lineDashOffset/=M,d.stroke(),l&&(d.setTransform(...H),d.setLineDash(D),d.lineDashOffset=R)}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}};let ot=_t;ct=new WeakSet,be=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},yt=new WeakSet,_e=function(){if(this.pageColors){const l=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(l!=="none"){const d=this.ctx.filter;this.ctx.filter=l,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=d}}},b.CanvasGraphics=ot;for(const W in _.OPS)ot.prototype[W]!==void 0&&(ot.prototype[_.OPS[W]]=ot.prototype[W])},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TilingPattern=b.PathType=void 0,b.getShadingPattern=x;var _=K(1),k=K(6);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};b.PathType=z;function G(m,v){if(!v)return;const T=v[2]-v[0],g=v[3]-v[1],t=new Path2D;t.rect(v[0],v[1],T,g),m.clip(t)}class it{constructor(){this.constructor===it&&(0,_.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,_.unreachable)("Abstract method `getPattern` called.")}}class U extends it{constructor(v){super(),this._type=v[1],this._bbox=v[2],this._colorStops=v[3],this._p0=v[4],this._p1=v[5],this._r0=v[6],this._r1=v[7],this.matrix=null}_createGradient(v){let T;this._type==="axial"?T=v.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(T=v.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const g of this._colorStops)T.addColorStop(g[0],g[1]);return T}getPattern(v,T,g,t){let a;if(t===z.STROKE||t===z.FILL){const o=T.current.getClippedPathBoundingBox(t,(0,k.getCurrentTransform)(v))||[0,0,0,0],s=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,P=T.cachedCanvases.getCanvas("pattern",s,c,!0),i=P.context;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.translate(-o[0],-o[1]),g=_.Util.transform(g,[1,0,0,1,o[0],o[1]]),i.transform(...T.baseTransform),this.matrix&&i.transform(...this.matrix),G(i,this._bbox),i.fillStyle=this._createGradient(i),i.fill(),a=v.createPattern(P.canvas,"no-repeat");const L=new DOMMatrix(g);a.setTransform(L)}else G(v,this._bbox),a=this._createGradient(v);return a}}function I(m,v,T,g,t,a,o,s){const c=v.coords,P=v.colors,i=m.data,L=m.width*4;let q;c[T+1]>c[g+1]&&(q=T,T=g,g=q,q=a,a=o,o=q),c[g+1]>c[t+1]&&(q=g,g=t,t=q,q=o,o=s,s=q),c[T+1]>c[g+1]&&(q=T,T=g,g=q,q=a,a=o,o=q);const $=(c[T]+v.offsetX)*v.scaleX,J=(c[T+1]+v.offsetY)*v.scaleY,nt=(c[g]+v.offsetX)*v.scaleX,dt=(c[g+1]+v.offsetY)*v.scaleY,ot=(c[t]+v.offsetX)*v.scaleX,ct=(c[t+1]+v.offsetY)*v.scaleY;if(J>=ct)return;const mt=P[a],yt=P[a+1],St=P[a+2],_t=P[o],W=P[o+1],l=P[o+2],d=P[s],S=P[s+1],j=P[s+2],O=Math.round(J),H=Math.round(ct);let D,R,M,e,n,p,A,E;for(let B=O;B<=H;B++){if(B<dt){let Q;B<J?Q=0:Q=(J-B)/(J-dt),D=$-($-nt)*Q,R=mt-(mt-_t)*Q,M=yt-(yt-W)*Q,e=St-(St-l)*Q}else{let Q;B>ct?Q=1:dt===ct?Q=0:Q=(dt-B)/(dt-ct),D=nt-(nt-ot)*Q,R=_t-(_t-d)*Q,M=W-(W-S)*Q,e=l-(l-j)*Q}let tt;B<J?tt=0:B>ct?tt=1:tt=(J-B)/(J-ct),n=$-($-ot)*tt,p=mt-(mt-d)*tt,A=yt-(yt-S)*tt,E=St-(St-j)*tt;const X=Math.round(Math.min(D,n)),et=Math.round(Math.max(D,n));let rt=L*B+X*4;for(let Q=X;Q<=et;Q++)tt=(D-Q)/(D-n),tt<0?tt=0:tt>1&&(tt=1),i[rt++]=R-(R-p)*tt|0,i[rt++]=M-(M-A)*tt|0,i[rt++]=e-(e-E)*tt|0,i[rt++]=255}}function y(m,v,T){const g=v.coords,t=v.colors;let a,o;switch(v.type){case"lattice":const s=v.verticesPerRow,c=Math.floor(g.length/s)-1,P=s-1;for(a=0;a<c;a++){let i=a*s;for(let L=0;L<P;L++,i++)I(m,T,g[i],g[i+1],g[i+s],t[i],t[i+1],t[i+s]),I(m,T,g[i+s+1],g[i+1],g[i+s],t[i+s+1],t[i+1],t[i+s])}break;case"triangles":for(a=0,o=g.length;a<o;a+=3)I(m,T,g[a],g[a+1],g[a+2],t[a],t[a+1],t[a+2]);break;default:throw new Error("illegal figure")}}class N extends it{constructor(v){super(),this._coords=v[2],this._colors=v[3],this._figures=v[4],this._bounds=v[5],this._bbox=v[7],this._background=v[8],this.matrix=null}_createMeshCanvas(v,T,g){const s=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),P=Math.ceil(this._bounds[2])-s,i=Math.ceil(this._bounds[3])-c,L=Math.min(Math.ceil(Math.abs(P*v[0]*1.1)),3e3),q=Math.min(Math.ceil(Math.abs(i*v[1]*1.1)),3e3),$=P/L,J=i/q,nt={coords:this._coords,colors:this._colors,offsetX:-s,offsetY:-c,scaleX:1/$,scaleY:1/J},dt=L+2*2,ot=q+2*2,ct=g.getCanvas("mesh",dt,ot,!1),mt=ct.context,yt=mt.createImageData(L,q);if(T){const _t=yt.data;for(let W=0,l=_t.length;W<l;W+=4)_t[W]=T[0],_t[W+1]=T[1],_t[W+2]=T[2],_t[W+3]=255}for(const _t of this._figures)y(yt,_t,nt);return mt.putImageData(yt,2,2),{canvas:ct.canvas,offsetX:s-2*$,offsetY:c-2*J,scaleX:$,scaleY:J}}getPattern(v,T,g,t){G(v,this._bbox);let a;if(t===z.SHADING)a=_.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(v));else if(a=_.Util.singularValueDecompose2dScale(T.baseTransform),this.matrix){const s=_.Util.singularValueDecompose2dScale(this.matrix);a=[a[0]*s[0],a[1]*s[1]]}const o=this._createMeshCanvas(a,t===z.SHADING?null:this._background,T.cachedCanvases);return t!==z.SHADING&&(v.setTransform(...T.baseTransform),this.matrix&&v.transform(...this.matrix)),v.translate(o.offsetX,o.offsetY),v.scale(o.scaleX,o.scaleY),v.createPattern(o.canvas,"no-repeat")}}class w extends it{getPattern(){return"hotpink"}}function x(m){switch(m[0]){case"RadialAxial":return new U(m);case"Mesh":return new N(m);case"Dummy":return new w}throw new Error(`Unknown IR type: ${m[0]}`)}const f={COLORED:1,UNCOLORED:2},r=class{constructor(v,T,g,t,a){this.operatorList=v[2],this.matrix=v[3]||[1,0,0,1,0,0],this.bbox=v[4],this.xstep=v[5],this.ystep=v[6],this.paintType=v[7],this.tilingType=v[8],this.color=T,this.ctx=g,this.canvasGraphicsFactory=t,this.baseTransform=a}createPatternCanvas(v){const T=this.operatorList,g=this.bbox,t=this.xstep,a=this.ystep,o=this.paintType,s=this.tilingType,c=this.color,P=this.canvasGraphicsFactory;(0,_.info)("TilingType: "+s);const i=g[0],L=g[1],q=g[2],$=g[3],J=_.Util.singularValueDecompose2dScale(this.matrix),nt=_.Util.singularValueDecompose2dScale(this.baseTransform),dt=[J[0]*nt[0],J[1]*nt[1]],ot=this.getSizeAndScale(t,this.ctx.canvas.width,dt[0]),ct=this.getSizeAndScale(a,this.ctx.canvas.height,dt[1]),mt=v.cachedCanvases.getCanvas("pattern",ot.size,ct.size,!0),yt=mt.context,St=P.createCanvasGraphics(yt);St.groupLevel=v.groupLevel,this.setFillAndStrokeStyleToContext(St,o,c);let _t=i,W=L,l=q,d=$;return i<0&&(_t=0,l+=Math.abs(i)),L<0&&(W=0,d+=Math.abs(L)),yt.translate(-(ot.scale*_t),-(ct.scale*W)),St.transform(ot.scale,0,0,ct.scale,0,0),yt.save(),this.clipBbox(St,_t,W,l,d),St.baseTransform=(0,k.getCurrentTransform)(St.ctx),St.executeOperatorList(T),St.endDrawing(),{canvas:mt.canvas,scaleX:ot.scale,scaleY:ct.scale,offsetX:_t,offsetY:W}}getSizeAndScale(v,T,g){v=Math.abs(v);const t=Math.max(r.MAX_PATTERN_SIZE,T);let a=Math.ceil(v*g);return a>=t?a=t:g=a/v,{scale:g,size:a}}clipBbox(v,T,g,t,a){const o=t-T,s=a-g;v.ctx.rect(T,g,o,s),v.current.updateRectMinMax((0,k.getCurrentTransform)(v.ctx),[T,g,t,a]),v.clip(),v.endPath()}setFillAndStrokeStyleToContext(v,T,g){const t=v.ctx,a=v.current;switch(T){case f.COLORED:const o=this.ctx;t.fillStyle=o.fillStyle,t.strokeStyle=o.strokeStyle,a.fillColor=o.fillStyle,a.strokeColor=o.strokeStyle;break;case f.UNCOLORED:const s=_.Util.makeHexColor(g[0],g[1],g[2]);t.fillStyle=s,t.strokeStyle=s,a.fillColor=s,a.strokeColor=s;break;default:throw new _.FormatError(`Unsupported paint type: ${T}`)}}getPattern(v,T,g,t){let a=g;t!==z.SHADING&&(a=_.Util.transform(a,T.baseTransform),this.matrix&&(a=_.Util.transform(a,this.matrix)));const o=this.createPatternCanvas(T);let s=new DOMMatrix(a);s=s.translate(o.offsetX,o.offsetY),s=s.scale(1/o.scaleX,1/o.scaleY);const c=v.createPattern(o.canvas,"repeat");return c.setTransform(s),c}};let h=r;Ot(h,"MAX_PATTERN_SIZE",3e3),b.TilingPattern=h},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.convertBlackAndWhiteToRGBA=z,b.convertToRGBA=k,b.grayToRGBA=it;var _=K(1);function k(U){switch(U.kind){case _.ImageKind.GRAYSCALE_1BPP:return z(U);case _.ImageKind.RGB_24BPP:return G(U)}return null}function z({src:U,srcPos:I=0,dest:y,width:N,height:w,nonBlackColor:x=4294967295,inverseDecode:f=!1}){const h=_.FeatureTest.isLittleEndian?4278190080:255,[r,m]=f?[x,h]:[h,x],v=N>>3,T=N&7,g=U.length;y=new Uint32Array(y.buffer);let t=0;for(let a=0;a<w;a++){for(const s=I+v;I<s;I++){const c=I<g?U[I]:255;y[t++]=c&128?m:r,y[t++]=c&64?m:r,y[t++]=c&32?m:r,y[t++]=c&16?m:r,y[t++]=c&8?m:r,y[t++]=c&4?m:r,y[t++]=c&2?m:r,y[t++]=c&1?m:r}if(T===0)continue;const o=I<g?U[I++]:255;for(let s=0;s<T;s++)y[t++]=o&1<<7-s?m:r}return{srcPos:I,destPos:t}}function G({src:U,srcPos:I=0,dest:y,destPos:N=0,width:w,height:x}){let f=0;const h=U.length>>2,r=new Uint32Array(U.buffer,I,h);if(_.FeatureTest.isLittleEndian){for(;f<h-2;f+=3,N+=4){const m=r[f],v=r[f+1],T=r[f+2];y[N]=m|4278190080,y[N+1]=m>>>24|v<<8|4278190080,y[N+2]=v>>>16|T<<16|4278190080,y[N+3]=T>>>8|4278190080}for(let m=f*4,v=U.length;m<v;m+=3)y[N++]=U[m]|U[m+1]<<8|U[m+2]<<16|4278190080}else{for(;f<h-2;f+=3,N+=4){const m=r[f],v=r[f+1],T=r[f+2];y[N]=m|255,y[N+1]=m<<24|v>>>8|255,y[N+2]=v<<16|T>>>16|255,y[N+3]=T<<8|255}for(let m=f*4,v=U.length;m<v;m+=3)y[N++]=U[m]<<24|U[m+1]<<16|U[m+2]<<8|255}return{srcPos:I,destPos:N}}function it(U,I){if(_.FeatureTest.isLittleEndian)for(let y=0,N=U.length;y<N;y++)I[y]=U[y]*65793|4278190080;else for(let y=0,N=U.length;y<N;y++)I[y]=U[y]*16843008|255}},(ht,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.GlobalWorkerOptions=void 0;const K=Object.create(null);b.GlobalWorkerOptions=K,K.workerPort=null,K.workerSrc=""},(ht,b,K)=>{var U,We,y,He,w,ae;Object.defineProperty(b,"__esModule",{value:!0}),b.MessageHandler=void 0;var _=K(1);const k={UNKNOWN:0,DATA:1,ERROR:2},z={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function G(f){switch(f instanceof Error||typeof f=="object"&&f!==null||(0,_.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),f.name){case"AbortException":return new _.AbortException(f.message);case"MissingPDFException":return new _.MissingPDFException(f.message);case"PasswordException":return new _.PasswordException(f.message,f.code);case"UnexpectedResponseException":return new _.UnexpectedResponseException(f.message,f.status);case"UnknownErrorException":return new _.UnknownErrorException(f.message,f.details);default:return new _.UnknownErrorException(f.message,f.toString())}}class it{constructor(h,r,m){Y(this,U);Y(this,y);Y(this,w);this.sourceName=h,this.targetName=r,this.comObj=m,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=v=>{const T=v.data;if(T.targetName!==this.sourceName)return;if(T.stream){Z(this,y,He).call(this,T);return}if(T.callback){const t=T.callbackId,a=this.callbackCapabilities[t];if(!a)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],T.callback===k.DATA)a.resolve(T.data);else if(T.callback===k.ERROR)a.reject(G(T.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[T.action];if(!g)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const t=this.sourceName,a=T.sourceName;new Promise(function(o){o(g(T.data))}).then(function(o){m.postMessage({sourceName:t,targetName:a,callback:k.DATA,callbackId:T.callbackId,data:o})},function(o){m.postMessage({sourceName:t,targetName:a,callback:k.ERROR,callbackId:T.callbackId,reason:G(o)})});return}if(T.streamId){Z(this,U,We).call(this,T);return}g(T.data)},m.addEventListener("message",this._onComObjOnMessage)}on(h,r){const m=this.actionHandler;if(m[h])throw new Error(`There is already an actionName called "${h}"`);m[h]=r}send(h,r,m){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:r},m)}sendWithPromise(h,r,m){const v=this.callbackId++,T=new _.PromiseCapability;this.callbackCapabilities[v]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:v,data:r},m)}catch(g){T.reject(g)}return T.promise}sendWithStream(h,r,m,v){const T=this.streamId++,g=this.sourceName,t=this.targetName,a=this.comObj;return new ReadableStream({start:o=>{const s=new _.PromiseCapability;return this.streamControllers[T]={controller:o,startCall:s,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:g,targetName:t,action:h,streamId:T,data:r,desiredSize:o.desiredSize},v),s.promise},pull:o=>{const s=new _.PromiseCapability;return this.streamControllers[T].pullCall=s,a.postMessage({sourceName:g,targetName:t,stream:z.PULL,streamId:T,desiredSize:o.desiredSize}),s.promise},cancel:o=>{(0,_.assert)(o instanceof Error,"cancel must have a valid reason");const s=new _.PromiseCapability;return this.streamControllers[T].cancelCall=s,this.streamControllers[T].isClosed=!0,a.postMessage({sourceName:g,targetName:t,stream:z.CANCEL,streamId:T,reason:G(o)}),s.promise}},m)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}U=new WeakSet,We=function(h){const r=h.streamId,m=this.sourceName,v=h.sourceName,T=this.comObj,g=this,t=this.actionHandler[h.action],a={enqueue(o,s=1,c){if(this.isCancelled)return;const P=this.desiredSize;this.desiredSize-=s,P>0&&this.desiredSize<=0&&(this.sinkCapability=new _.PromiseCapability,this.ready=this.sinkCapability.promise),T.postMessage({sourceName:m,targetName:v,stream:z.ENQUEUE,streamId:r,chunk:o},c)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:m,targetName:v,stream:z.CLOSE,streamId:r}),delete g.streamSinks[r])},error(o){(0,_.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:m,targetName:v,stream:z.ERROR,streamId:r,reason:G(o)}))},sinkCapability:new _.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[r]=a,new Promise(function(o){o(t(h.data,a))}).then(function(){T.postMessage({sourceName:m,targetName:v,stream:z.START_COMPLETE,streamId:r,success:!0})},function(o){T.postMessage({sourceName:m,targetName:v,stream:z.START_COMPLETE,streamId:r,reason:G(o)})})},y=new WeakSet,He=function(h){const r=h.streamId,m=this.sourceName,v=h.sourceName,T=this.comObj,g=this.streamControllers[r],t=this.streamSinks[r];switch(h.stream){case z.START_COMPLETE:h.success?g.startCall.resolve():g.startCall.reject(G(h.reason));break;case z.PULL_COMPLETE:h.success?g.pullCall.resolve():g.pullCall.reject(G(h.reason));break;case z.PULL:if(!t){T.postMessage({sourceName:m,targetName:v,stream:z.PULL_COMPLETE,streamId:r,success:!0});break}t.desiredSize<=0&&h.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=h.desiredSize,new Promise(function(a){var o;a((o=t.onPull)==null?void 0:o.call(t))}).then(function(){T.postMessage({sourceName:m,targetName:v,stream:z.PULL_COMPLETE,streamId:r,success:!0})},function(a){T.postMessage({sourceName:m,targetName:v,stream:z.PULL_COMPLETE,streamId:r,reason:G(a)})});break;case z.ENQUEUE:if((0,_.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(h.chunk);break;case z.CLOSE:if((0,_.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),Z(this,w,ae).call(this,g,r);break;case z.ERROR:(0,_.assert)(g,"error should have stream controller"),g.controller.error(G(h.reason)),Z(this,w,ae).call(this,g,r);break;case z.CANCEL_COMPLETE:h.success?g.cancelCall.resolve():g.cancelCall.reject(G(h.reason)),Z(this,w,ae).call(this,g,r);break;case z.CANCEL:if(!t)break;new Promise(function(a){var o;a((o=t.onCancel)==null?void 0:o.call(t,G(h.reason)))}).then(function(){T.postMessage({sourceName:m,targetName:v,stream:z.CANCEL_COMPLETE,streamId:r,success:!0})},function(a){T.postMessage({sourceName:m,targetName:v,stream:z.CANCEL_COMPLETE,streamId:r,reason:G(a)})}),t.sinkCapability.reject(G(h.reason)),t.isCancelled=!0,delete this.streamSinks[r];break;default:throw new Error("Unexpected stream case")}},w=new WeakSet,ae=async function(h,r){var m,v,T;await Promise.allSettled([(m=h.startCall)==null?void 0:m.promise,(v=h.pullCall)==null?void 0:v.promise,(T=h.cancelCall)==null?void 0:T.promise]),delete this.streamControllers[r]},b.MessageHandler=it},(ht,b,K)=>{var z,G;Object.defineProperty(b,"__esModule",{value:!0}),b.Metadata=void 0;var _=K(1);class k{constructor({parsedData:U,rawData:I}){Y(this,z,void 0);Y(this,G,void 0);pt(this,z,U),pt(this,G,I)}getRaw(){return u(this,G)}get(U){return u(this,z).get(U)??null}getAll(){return(0,_.objectFromMap)(u(this,z))}has(U){return u(this,z).has(U)}}z=new WeakMap,G=new WeakMap,b.Metadata=k},(ht,b,K)=>{var U,I,y,N,w,x,Ae;Object.defineProperty(b,"__esModule",{value:!0}),b.OptionalContentConfig=void 0;var _=K(1),k=K(8);const z=Symbol("INTERNAL");class G{constructor(r,m){Y(this,U,!0);this.name=r,this.intent=m}get visible(){return u(this,U)}_setVisible(r,m){r!==z&&(0,_.unreachable)("Internal method `_setVisible` called."),pt(this,U,m)}}U=new WeakMap;class it{constructor(r){Y(this,x);Y(this,I,null);Y(this,y,new Map);Y(this,N,null);Y(this,w,null);if(this.name=null,this.creator=null,r!==null){this.name=r.name,this.creator=r.creator,pt(this,w,r.order);for(const m of r.groups)u(this,y).set(m.id,new G(m.name,m.intent));if(r.baseState==="OFF")for(const m of u(this,y).values())m._setVisible(z,!1);for(const m of r.on)u(this,y).get(m)._setVisible(z,!0);for(const m of r.off)u(this,y).get(m)._setVisible(z,!1);pt(this,N,this.getHash())}}isVisible(r){if(u(this,y).size===0)return!0;if(!r)return(0,_.warn)("Optional content group not defined."),!0;if(r.type==="OCG")return u(this,y).has(r.id)?u(this,y).get(r.id).visible:((0,_.warn)(`Optional content group not found: ${r.id}`),!0);if(r.type==="OCMD"){if(r.expression)return Z(this,x,Ae).call(this,r.expression);if(!r.policy||r.policy==="AnyOn"){for(const m of r.ids){if(!u(this,y).has(m))return(0,_.warn)(`Optional content group not found: ${m}`),!0;if(u(this,y).get(m).visible)return!0}return!1}else if(r.policy==="AllOn"){for(const m of r.ids){if(!u(this,y).has(m))return(0,_.warn)(`Optional content group not found: ${m}`),!0;if(!u(this,y).get(m).visible)return!1}return!0}else if(r.policy==="AnyOff"){for(const m of r.ids){if(!u(this,y).has(m))return(0,_.warn)(`Optional content group not found: ${m}`),!0;if(!u(this,y).get(m).visible)return!0}return!1}else if(r.policy==="AllOff"){for(const m of r.ids){if(!u(this,y).has(m))return(0,_.warn)(`Optional content group not found: ${m}`),!0;if(u(this,y).get(m).visible)return!1}return!0}return(0,_.warn)(`Unknown optional content policy ${r.policy}.`),!0}return(0,_.warn)(`Unknown group type ${r.type}.`),!0}setVisibility(r,m=!0){if(!u(this,y).has(r)){(0,_.warn)(`Optional content group not found: ${r}`);return}u(this,y).get(r)._setVisible(z,!!m),pt(this,I,null)}get hasInitialVisibility(){return this.getHash()===u(this,N)}getOrder(){return u(this,y).size?u(this,w)?u(this,w).slice():[...u(this,y).keys()]:null}getGroups(){return u(this,y).size>0?(0,_.objectFromMap)(u(this,y)):null}getGroup(r){return u(this,y).get(r)||null}getHash(){if(u(this,I)!==null)return u(this,I);const r=new k.MurmurHash3_64;for(const[m,v]of u(this,y))r.update(`${m}:${v.visible}`);return pt(this,I,r.hexdigest())}}I=new WeakMap,y=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakSet,Ae=function(r){const m=r.length;if(m<2)return!0;const v=r[0];for(let T=1;T<m;T++){const g=r[T];let t;if(Array.isArray(g))t=Z(this,x,Ae).call(this,g);else if(u(this,y).has(g))t=u(this,y).get(g).visible;else return(0,_.warn)(`Optional content group not found: ${g}`),!0;switch(v){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return v==="And"},b.OptionalContentConfig=it},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFDataTransportStream=void 0;var _=K(1),k=K(6);class z{constructor({length:I,initialData:y,progressiveDone:N=!1,contentDispositionFilename:w=null,disableRange:x=!1,disableStream:f=!1},h){if((0,_.assert)(h,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=N,this._contentDispositionFilename=w,(y==null?void 0:y.length)>0){const r=y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength?y.buffer:new Uint8Array(y).buffer;this._queuedChunks.push(r)}this._pdfDataRangeTransport=h,this._isStreamingSupported=!f,this._isRangeSupported=!x,this._contentLength=I,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((r,m)=>{this._onReceiveData({begin:r,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((r,m)=>{this._onProgress({loaded:r,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(r=>{this._onReceiveData({chunk:r})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:I,chunk:y}){const N=y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength?y.buffer:new Uint8Array(y).buffer;if(I===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(N):this._queuedChunks.push(N);else{const w=this._rangeReaders.some(function(x){return x._begin!==I?!1:(x._enqueue(N),!0)});(0,_.assert)(w,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}_onProgress(I){var y,N,w,x;I.total===void 0?(N=(y=this._rangeReaders[0])==null?void 0:y.onProgress)==null||N.call(y,{loaded:I.loaded}):(x=(w=this._fullRequestReader)==null?void 0:w.onProgress)==null||x.call(w,{loaded:I.loaded,total:I.total})}_onProgressiveDone(){var I;(I=this._fullRequestReader)==null||I.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(I){const y=this._rangeReaders.indexOf(I);y>=0&&this._rangeReaders.splice(y,1)}getFullReader(){(0,_.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const I=this._queuedChunks;return this._queuedChunks=null,new G(this,I,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(I,y){if(y<=this._progressiveDataLength)return null;const N=new it(this,I,y);return this._pdfDataRangeTransport.requestDataRange(I,y),this._rangeReaders.push(N),N}cancelAllRequests(I){var y;(y=this._fullRequestReader)==null||y.cancel(I);for(const N of this._rangeReaders.slice(0))N.cancel(I);this._pdfDataRangeTransport.abort()}}b.PDFDataTransportStream=z;class G{constructor(I,y,N=!1,w=null){this._stream=I,this._done=N||!1,this._filename=(0,k.isPdfFile)(w)?w:null,this._queuedChunks=y||[],this._loaded=0;for(const x of this._queuedChunks)this._loaded+=x.byteLength;this._requests=[],this._headersReady=Promise.resolve(),I._fullRequestReader=this,this.onProgress=null}_enqueue(I){this._done||(this._requests.length>0?this._requests.shift().resolve({value:I,done:!1}):this._queuedChunks.push(I),this._loaded+=I.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const I=new _.PromiseCapability;return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class it{constructor(I,y,N){this._stream=I,this._begin=y,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(I){if(!this._done){if(this._requests.length===0)this._queuedChunk=I;else{this._requests.shift().resolve({value:I,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const y=this._queuedChunk;return this._queuedChunk=null,{value:y,done:!1}}if(this._done)return{value:void 0,done:!0};const I=new _.PromiseCapability;return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(ht,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.XfaText=void 0;class K{static textContent(k){const z=[],G={items:z,styles:Object.create(null)};function it(U){var N;if(!U)return;let I=null;const y=U.name;if(y==="#text")I=U.value;else if(K.shouldBuildText(y))(N=U==null?void 0:U.attributes)!=null&&N.textContent?I=U.attributes.textContent:U.value&&(I=U.value);else return;if(I!==null&&z.push({str:I}),!!U.children)for(const w of U.children)it(w)}return it(k),G}static shouldBuildText(k){return!(k==="textarea"||k==="input"||k==="option"||k==="select")}}b.XfaText=K},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NodeStandardFontDataFactory=b.NodeFilterFactory=b.NodeCanvasFactory=b.NodeCMapReaderFactory=void 0;var _=K(7);const k=function(I){return new Promise((y,N)=>{require$$5.readFile(I,(x,f)=>{if(x||!f){N(new Error(x));return}y(new Uint8Array(f))})})};class z extends _.BaseFilterFactory{}b.NodeFilterFactory=z;class G extends _.BaseCanvasFactory{_createCanvas(y,N){return require$$5.createCanvas(y,N)}}b.NodeCanvasFactory=G;class it extends _.BaseCMapReaderFactory{_fetchData(y,N){return k(y).then(w=>({cMapData:w,compressionType:N}))}}b.NodeCMapReaderFactory=it;class U extends _.BaseStandardFontDataFactory{_fetchData(y){return k(y)}}b.NodeStandardFontDataFactory=U},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFNodeStream=void 0;var _=K(1),k=K(22);const z=require$$5,G=require$$5,it=require$$5,U=require$$5,I=/^file:\/\/\/[a-zA-Z]:\//;function y(T){const g=U.parse(T);return g.protocol==="file:"||g.host?g:/^[a-z]:[/\\]/i.test(T)?U.parse(`file:///${T}`):(g.host||(g.protocol="file:"),g)}class N{constructor(g){this.source=g,this.url=y(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new m(this):new h(this),this._fullRequestReader}getRangeReader(g,t){if(t<=this._progressiveDataLength)return null;const a=this.isFsUrl?new v(this,g,t):new r(this,g,t);return this._rangeRequestReaders.push(a),a}cancelAllRequests(g){var t;(t=this._fullRequestReader)==null||t.cancel(g);for(const a of this._rangeRequestReaders.slice(0))a.cancel(g)}}b.PDFNodeStream=N;class w{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=g.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new _.PromiseCapability,this._headersCapability=new _.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new _.PromiseCapability,this.read()):(this._loaded+=g.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class x{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new _.PromiseCapability;const t=g.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new _.PromiseCapability,this.read()):(this._loaded+=g.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(T,g){return{protocol:T.protocol,auth:T.auth,host:T.hostname,port:T.port,path:T.path,method:"GET",headers:g}}class h extends w{constructor(g){super(g);const t=a=>{if(a.statusCode===404){const P=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P,this._headersCapability.reject(P);return}this._headersCapability.resolve(),this._setReadableStream(a);const o=P=>this._readableStream.headers[P.toLowerCase()],{allowRangeRequests:s,suggestedLength:c}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=c||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(o)};this._request=null,this._url.protocol==="http:"?this._request=G.request(f(this._url,g.httpHeaders),t):this._request=it.request(f(this._url,g.httpHeaders),t),this._request.on("error",a=>{this._storedError=a,this._headersCapability.reject(a)}),this._request.end()}}class r extends x{constructor(g,t,a){super(g),this._httpHeaders={};for(const s in g.httpHeaders){const c=g.httpHeaders[s];c!==void 0&&(this._httpHeaders[s]=c)}this._httpHeaders.Range=`bytes=${t}-${a-1}`;const o=s=>{if(s.statusCode===404){const c=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=c;return}this._setReadableStream(s)};this._request=null,this._url.protocol==="http:"?this._request=G.request(f(this._url,this._httpHeaders),o):this._request=it.request(f(this._url,this._httpHeaders),o),this._request.on("error",s=>{this._storedError=s}),this._request.end()}}class m extends w{constructor(g){super(g);let t=decodeURIComponent(this._url.path);I.test(this._url.href)&&(t=t.replace(/^\//,"")),z.lstat(t,(a,o)=>{if(a){a.code==="ENOENT"&&(a=new _.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=a,this._headersCapability.reject(a);return}this._contentLength=o.size,this._setReadableStream(z.createReadStream(t)),this._headersCapability.resolve()})}}class v extends x{constructor(g,t,a){super(g);let o=decodeURIComponent(this._url.path);I.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(z.createReadStream(o,{start:t,end:a-1}))}}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createResponseStatusError=U,b.extractFilenameFromHeader=it,b.validateRangeRequestCapabilities=G,b.validateResponseStatus=I;var _=K(1),k=K(23),z=K(6);function G({getResponseHeader:y,isHttp:N,rangeChunkSize:w,disableRange:x}){const f={allowRangeRequests:!1,suggestedLength:void 0},h=parseInt(y("Content-Length"),10);return!Number.isInteger(h)||(f.suggestedLength=h,h<=2*w)||x||!N||y("Accept-Ranges")!=="bytes"||(y("Content-Encoding")||"identity")!=="identity"||(f.allowRangeRequests=!0),f}function it(y){const N=y("Content-Disposition");if(N){let w=(0,k.getFilenameFromContentDispositionHeader)(N);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,z.isPdfFile)(w))return w}return null}function U(y,N){return y===404||y===0&&N.startsWith("file:")?new _.MissingPDFException('Missing PDF "'+N+'".'):new _.UnexpectedResponseException(`Unexpected server response (${y}) while retrieving PDF "${N}".`,y)}function I(y){return y===200||y===206}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.getFilenameFromContentDispositionHeader=k;var _=K(1);function k(z){let G=!0,it=U("filename\\*","i").exec(z);if(it){it=it[1];let h=w(it);return h=unescape(h),h=x(h),h=f(h),y(h)}if(it=N(z),it){const h=f(it);return y(h)}if(it=U("filename","i").exec(z),it){it=it[1];let h=w(it);return h=f(h),y(h)}function U(h,r){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function I(h,r){if(h){if(!/^[\x00-\xFF]+$/.test(r))return r;try{const m=new TextDecoder(h,{fatal:!0}),v=(0,_.stringToBytes)(r);r=m.decode(v),G=!1}catch{}}return r}function y(h){return G&&/[\x80-\xff]/.test(h)&&(h=I("utf-8",h),G&&(h=I("iso-8859-1",h))),h}function N(h){const r=[];let m;const v=U("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(h))!==null;){let[,g,t,a]=m;if(g=parseInt(g,10),g in r){if(g===0)break;continue}r[g]=[t,a]}const T=[];for(let g=0;g<r.length&&g in r;++g){let[t,a]=r[g];a=w(a),t&&(a=unescape(a),g===0&&(a=x(a))),T.push(a)}return T.join("")}function w(h){if(h.startsWith('"')){const r=h.slice(1).split('\\"');for(let m=0;m<r.length;++m){const v=r[m].indexOf('"');v!==-1&&(r[m]=r[m].slice(0,v),r.length=m+1),r[m]=r[m].replaceAll(/\\(.)/g,"$1")}h=r.join('"')}return h}function x(h){const r=h.indexOf("'");if(r===-1)return h;const m=h.slice(0,r),T=h.slice(r+1).replace(/^[^']*'/,"");return I(m,T)}function f(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(r,m,v,T){if(v==="q"||v==="Q")return T=T.replaceAll("_"," "),T=T.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,t){return String.fromCharCode(parseInt(t,16))}),I(m,T);try{T=atob(T)}catch{}return I(m,T)})}return""}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFNetworkStream=void 0;var _=K(1),k=K(22);const z=200,G=206;function it(w){const x=w.response;return typeof x!="string"?x:(0,_.stringToBytes)(x).buffer}class U{constructor(x,f={}){this.url=x,this.isHttp=/^https?:/i.test(x),this.httpHeaders=this.isHttp&&f.httpHeaders||Object.create(null),this.withCredentials=f.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(x,f,h){const r={begin:x,end:f};for(const m in h)r[m]=h[m];return this.request(r)}requestFull(x){return this.request(x)}request(x){const f=new XMLHttpRequest,h=this.currXhrId++,r=this.pendingRequests[h]={xhr:f};f.open("GET",this.url),f.withCredentials=this.withCredentials;for(const m in this.httpHeaders){const v=this.httpHeaders[m];v!==void 0&&f.setRequestHeader(m,v)}return this.isHttp&&"begin"in x&&"end"in x?(f.setRequestHeader("Range",`bytes=${x.begin}-${x.end-1}`),r.expectedStatus=G):r.expectedStatus=z,f.responseType="arraybuffer",x.onError&&(f.onerror=function(m){x.onError(f.status)}),f.onreadystatechange=this.onStateChange.bind(this,h),f.onprogress=this.onProgress.bind(this,h),r.onHeadersReceived=x.onHeadersReceived,r.onDone=x.onDone,r.onError=x.onError,r.onProgress=x.onProgress,f.send(null),h}onProgress(x,f){var r;const h=this.pendingRequests[x];h&&((r=h.onProgress)==null||r.call(h,f))}onStateChange(x,f){var g,t,a;const h=this.pendingRequests[x];if(!h)return;const r=h.xhr;if(r.readyState>=2&&h.onHeadersReceived&&(h.onHeadersReceived(),delete h.onHeadersReceived),r.readyState!==4||!(x in this.pendingRequests))return;if(delete this.pendingRequests[x],r.status===0&&this.isHttp){(g=h.onError)==null||g.call(h,r.status);return}const m=r.status||z;if(!(m===z&&h.expectedStatus===G)&&m!==h.expectedStatus){(t=h.onError)==null||t.call(h,r.status);return}const T=it(r);if(m===G){const o=r.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);h.onDone({begin:parseInt(s[1],10),chunk:T})}else T?h.onDone({begin:0,chunk:T}):(a=h.onError)==null||a.call(h,r.status)}getRequestXhr(x){return this.pendingRequests[x].xhr}isPendingRequest(x){return x in this.pendingRequests}abortRequest(x){const f=this.pendingRequests[x].xhr;delete this.pendingRequests[x],f.abort()}}class I{constructor(x){this._source=x,this._manager=new U(x.url,{httpHeaders:x.httpHeaders,withCredentials:x.withCredentials}),this._rangeChunkSize=x.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(x){const f=this._rangeRequestReaders.indexOf(x);f>=0&&this._rangeRequestReaders.splice(f,1)}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new y(this._manager,this._source),this._fullRequestReader}getRangeReader(x,f){const h=new N(this._manager,x,f);return h.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(h),h}cancelAllRequests(x){var f;(f=this._fullRequestReader)==null||f.cancel(x);for(const h of this._rangeRequestReaders.slice(0))h.cancel(x)}}b.PDFNetworkStream=I;class y{constructor(x,f){this._manager=x;const h={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=f.url,this._fullRequestId=x.requestFull(h),this._headersReceivedCapability=new _.PromiseCapability,this._disableRange=f.disableRange||!1,this._contentLength=f.length,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const x=this._fullRequestId,f=this._manager.getRequestXhr(x),h=v=>f.getResponseHeader(v),{allowRangeRequests:r,suggestedLength:m}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=m||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(h),this._isRangeSupported&&this._manager.abortRequest(x),this._headersReceivedCapability.resolve()}_onDone(x){if(x&&(this._requests.length>0?this._requests.shift().resolve({value:x.chunk,done:!1}):this._cachedChunks.push(x.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(x){this._storedError=(0,k.createResponseStatusError)(x,this._url),this._headersReceivedCapability.reject(this._storedError);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(x){var f;(f=this.onProgress)==null||f.call(this,{loaded:x.loaded,total:x.lengthComputable?x.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new _.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0,this._headersReceivedCapability.reject(x);for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(x,f,h){this._manager=x;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._requestId=x.requestRange(f,h,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var x;(x=this.onClosed)==null||x.call(this,this)}_onDone(x){const f=x.chunk;this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunk=f,this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(x){this._storedError=(0,k.createResponseStatusError)(x,this._url);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(x){var f;this.isStreamingSupported||(f=this.onProgress)==null||f.call(this,{loaded:x.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new _.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFFetchStream=void 0;var _=K(1),k=K(22);function z(N,w,x){return{method:"GET",headers:N,signal:x.signal,mode:"cors",credentials:w?"include":"same-origin",redirect:"follow"}}function G(N){const w=new Headers;for(const x in N){const f=N[x];f!==void 0&&w.append(x,f)}return w}function it(N){return N instanceof Uint8Array?N.buffer:N instanceof ArrayBuffer?N:((0,_.warn)(`getArrayBuffer - unexpected data format: ${N}`),new Uint8Array(N).buffer)}class U{constructor(w){this.source=w,this.isHttp=/^https?:/i.test(w.url),this.httpHeaders=this.isHttp&&w.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new I(this),this._fullRequestReader}getRangeReader(w,x){if(x<=this._progressiveDataLength)return null;const f=new y(this,w,x);return this._rangeRequestReaders.push(f),f}cancelAllRequests(w){var x;(x=this._fullRequestReader)==null||x.cancel(w);for(const f of this._rangeRequestReaders.slice(0))f.cancel(w)}}b.PDFFetchStream=U;class I{constructor(w){this._stream=w,this._reader=null,this._loaded=0,this._filename=null;const x=w.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=new _.PromiseCapability,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=G(this._stream.httpHeaders);const f=x.url;fetch(f,z(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,k.validateResponseStatus)(h.status))throw(0,k.createResponseStatusError)(h.status,f);this._reader=h.body.getReader(),this._headersCapability.resolve();const r=T=>h.headers.get(T),{allowRangeRequests:m,suggestedLength:v}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=v||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new _.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._headersCapability.promise;const{value:w,done:x}=await this._reader.read();return x?{value:w,done:x}:(this._loaded+=w.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded,total:this._contentLength}),{value:it(w),done:!1})}cancel(w){var x;(x=this._reader)==null||x.cancel(w),this._abortController.abort()}}class y{constructor(w,x,f){this._stream=w,this._reader=null,this._loaded=0;const h=w.source;this._withCredentials=h.withCredentials||!1,this._readCapability=new _.PromiseCapability,this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=G(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${f-1}`);const r=h.url;fetch(r,z(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,k.validateResponseStatus)(m.status))throw(0,k.createResponseStatusError)(m.status,r);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._readCapability.promise;const{value:w,done:x}=await this._reader.read();return x?{value:w,done:x}:(this._loaded+=w.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded}),{value:it(w),done:!1})}cancel(w){var x;(x=this._reader)==null||x.cancel(w),this._abortController.abort()}}},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TextLayerRenderTask=void 0,b.renderTextLayer=h,b.updateTextLayer=r;var _=K(1),k=K(6);const z=1e5,G=30,it=.8,U=new Map;function I(m,v){let T;if(v&&_.FeatureTest.isOffscreenCanvasSupported)T=new OffscreenCanvas(m,m).getContext("2d",{alpha:!1});else{const g=document.createElement("canvas");g.width=g.height=m,T=g.getContext("2d",{alpha:!1})}return T}function y(m,v){const T=U.get(m);if(T)return T;const g=I(G,v);g.font=`${G}px ${m}`;const t=g.measureText("");let a=t.fontBoundingBoxAscent,o=Math.abs(t.fontBoundingBoxDescent);if(a){const c=a/(a+o);return U.set(m,c),g.canvas.width=g.canvas.height=0,c}g.strokeStyle="red",g.clearRect(0,0,G,G),g.strokeText("g",0,0);let s=g.getImageData(0,0,G,G).data;o=0;for(let c=s.length-1-3;c>=0;c-=4)if(s[c]>0){o=Math.ceil(c/4/G);break}g.clearRect(0,0,G,G),g.strokeText("A",0,G),s=g.getImageData(0,0,G,G).data,a=0;for(let c=0,P=s.length;c<P;c+=4)if(s[c]>0){a=G-Math.floor(c/4/G);break}if(g.canvas.width=g.canvas.height=0,a){const c=a/(a+o);return U.set(m,c),c}return U.set(m,it),it}function N(m,v,T){const g=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:v.str!=="",hasEOL:v.hasEOL,fontSize:0};m._textDivs.push(g);const a=_.Util.transform(m._transform,v.transform);let o=Math.atan2(a[1],a[0]);const s=T[v.fontName];s.vertical&&(o+=Math.PI/2);const c=Math.hypot(a[2],a[3]),P=c*y(s.fontFamily,m._isOffscreenCanvasSupported);let i,L;o===0?(i=a[4],L=a[5]-P):(i=a[4]+P*Math.sin(o),L=a[5]-P*Math.cos(o));const q="calc(var(--scale-factor)*",$=g.style;m._container===m._rootContainer?($.left=`${(100*i/m._pageWidth).toFixed(2)}%`,$.top=`${(100*L/m._pageHeight).toFixed(2)}%`):($.left=`${q}${i.toFixed(2)}px)`,$.top=`${q}${L.toFixed(2)}px)`),$.fontSize=`${q}${c.toFixed(2)}px)`,$.fontFamily=s.fontFamily,t.fontSize=c,g.setAttribute("role","presentation"),g.textContent=v.str,g.dir=v.dir,m._fontInspectorEnabled&&(g.dataset.fontName=v.fontName),o!==0&&(t.angle=o*(180/Math.PI));let J=!1;if(v.str.length>1)J=!0;else if(v.str!==" "&&v.transform[0]!==v.transform[3]){const nt=Math.abs(v.transform[0]),dt=Math.abs(v.transform[3]);nt!==dt&&Math.max(nt,dt)/Math.min(nt,dt)>1.5&&(J=!0)}J&&(t.canvasWidth=s.vertical?v.height:v.width),m._textDivProperties.set(g,t),m._isReadableStream&&m._layoutText(g)}function w(m){const{div:v,scale:T,properties:g,ctx:t,prevFontSize:a,prevFontFamily:o}=m,{style:s}=v;let c="";if(g.canvasWidth!==0&&g.hasText){const{fontFamily:P}=s,{canvasWidth:i,fontSize:L}=g;(a!==L||o!==P)&&(t.font=`${L*T}px ${P}`,m.prevFontSize=L,m.prevFontFamily=P);const{width:q}=t.measureText(v.textContent);q>0&&(c=`scaleX(${i*T/q})`)}g.angle!==0&&(c=`rotate(${g.angle}deg) ${c}`),c.length>0&&(s.transform=c)}function x(m){if(m._canceled)return;const v=m._textDivs,T=m._capability;if(v.length>z){T.resolve();return}if(!m._isReadableStream)for(const t of v)m._layoutText(t);T.resolve()}class f{constructor({textContentSource:v,container:T,viewport:g,textDivs:t,textDivProperties:a,textContentItemsStr:o,isOffscreenCanvasSupported:s}){var q;this._textContentSource=v,this._isReadableStream=v instanceof ReadableStream,this._container=this._rootContainer=T,this._textDivs=t||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=s,this._fontInspectorEnabled=!!((q=globalThis.FontInspector)!=null&&q.enabled),this._reader=null,this._textDivProperties=a||new WeakMap,this._canceled=!1,this._capability=new _.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:g.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:I(0,s)};const{pageWidth:c,pageHeight:P,pageX:i,pageY:L}=g.rawDims;this._transform=[1,0,0,-1,-i,L+P],this._pageWidth=c,this._pageHeight=P,(0,k.setLayerDimensions)(T,g),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new _.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new _.AbortException("TextLayer task cancelled."))}_processItems(v,T){for(const g of v){if(g.str===void 0){if(g.type==="beginMarkedContentProps"||g.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),g.id!==null&&this._container.setAttribute("id",`${g.id}`),t.append(this._container)}else g.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(g.str),N(this,g,T)}}_layoutText(v){const T=this._layoutTextParams.properties=this._textDivProperties.get(v);if(this._layoutTextParams.div=v,w(this._layoutTextParams),T.hasText&&this._container.append(v),T.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.append(g)}}_render(){const v=new _.PromiseCapability;let T=Object.create(null);if(this._isReadableStream){const g=()=>{this._reader.read().then(({value:t,done:a})=>{if(a){v.resolve();return}Object.assign(T,t.styles),this._processItems(t.items,T),g()},v.reject)};this._reader=this._textContentSource.getReader(),g()}else if(this._textContentSource){const{items:g,styles:t}=this._textContentSource;this._processItems(g,t),v.resolve()}else throw new Error('No "textContentSource" parameter specified.');v.promise.then(()=>{T=null,x(this)},this._capability.reject)}}b.TextLayerRenderTask=f;function h(m){!m.textContentSource&&(m.textContent||m.textContentStream)&&((0,k.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),m.textContentSource=m.textContent||m.textContentStream);const{container:v,viewport:T}=m,g=getComputedStyle(v),t=g.getPropertyValue("visibility"),a=parseFloat(g.getPropertyValue("--scale-factor"));t==="visible"&&(!a||Math.abs(a-T.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new f(m);return o._render(),o}function r({container:m,viewport:v,textDivs:T,textDivProperties:g,isOffscreenCanvasSupported:t,mustRotate:a=!0,mustRescale:o=!0}){if(a&&(0,k.setLayerDimensions)(m,{rotation:v.rotation}),o){const s=I(0,t),P={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s};for(const i of T)P.properties=g.get(i),P.div=i,w(P)}}},(ht,b,K)=>{var I,y,N,w,x,f,h,r,m,ye,T,qe,t,ve,o,Se;Object.defineProperty(b,"__esModule",{value:!0}),b.AnnotationEditorLayer=void 0;var _=K(1),k=K(5),z=K(28),G=K(29),it=K(6);const c=class{constructor(i){Y(this,m);Y(this,T);Y(this,t);Y(this,o);Y(this,I,void 0);Y(this,y,!1);Y(this,N,this.pointerup.bind(this));Y(this,w,this.pointerdown.bind(this));Y(this,x,new Map);Y(this,f,!1);Y(this,h,!1);Y(this,r,void 0);c._initialized||(c._initialized=!0,z.FreeTextEditor.initialize(i.l10n),G.InkEditor.initialize(i.l10n)),i.uiManager.registerEditorTypes([z.FreeTextEditor,G.InkEditor]),pt(this,r,i.uiManager),this.pageIndex=i.pageIndex,this.div=i.div,pt(this,I,i.accessibilityManager),u(this,r).addLayer(this)}get isEmpty(){return u(this,x).size===0}updateToolbar(i){u(this,r).updateToolbar(i)}updateMode(i=u(this,r).getMode()){Z(this,o,Se).call(this),i===_.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),u(this,r).unselectAll(),i!==_.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===_.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===_.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&u(this,r).getMode()!==_.AnnotationEditorType.INK)return;if(!i){for(const q of u(this,x).values())if(q.isEmpty()){q.setInBackground();return}}Z(this,t,ve).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(i){u(this,r).setEditingState(i)}addCommands(i){u(this,r).addCommands(i)}enable(){this.div.style.pointerEvents="auto";for(const i of u(this,x).values())i.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const i of u(this,x).values())i.disableEditing();Z(this,o,Se).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(i){u(this,r).getActive()!==i&&u(this,r).setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",u(this,w)),this.div.addEventListener("pointerup",u(this,N))}disableClick(){this.div.removeEventListener("pointerdown",u(this,w)),this.div.removeEventListener("pointerup",u(this,N))}attach(i){u(this,x).set(i.id,i)}detach(i){var L;u(this,x).delete(i.id),(L=u(this,I))==null||L.removePointerInTextLayer(i.contentDiv)}remove(i){u(this,r).removeEditor(i),this.detach(i),i.div.style.display="none",setTimeout(()=>{i.div.style.display="",i.div.remove(),i.isAttachedToDOM=!1,document.activeElement===document.body&&u(this,r).focusMainContainer()},0),u(this,h)||this.addInkEditorIfNeeded(!1)}add(i){if(Z(this,m,ye).call(this,i),u(this,r).addEditor(i),this.attach(i),!i.isAttachedToDOM){const L=i.render();this.div.append(L),i.isAttachedToDOM=!0}this.moveEditorInDOM(i),i.onceAdded(),u(this,r).addToAnnotationStorage(i)}moveEditorInDOM(i){var L;(L=u(this,I))==null||L.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addANewEditor(i){const L=()=>{this.addOrRebuild(i)},q=()=>{i.remove()};this.addCommands({cmd:L,undo:q,mustExec:!0})}addUndoableEditor(i){const L=()=>{this.addOrRebuild(i)},q=()=>{i.remove()};this.addCommands({cmd:L,undo:q,mustExec:!1})}getNextId(){return u(this,r).getId()}deserialize(i){switch(i.annotationType){case _.AnnotationEditorType.FREETEXT:return z.FreeTextEditor.deserialize(i,this,u(this,r));case _.AnnotationEditorType.INK:return G.InkEditor.deserialize(i,this,u(this,r))}return null}setSelected(i){u(this,r).setSelected(i)}toggleSelected(i){u(this,r).toggleSelected(i)}isSelected(i){return u(this,r).isSelected(i)}unselect(i){u(this,r).unselect(i)}pointerup(i){const{isMac:L}=_.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&L)&&i.target===this.div&&u(this,f)){if(pt(this,f,!1),!u(this,y)){pt(this,y,!0);return}Z(this,t,ve).call(this,i)}}pointerdown(i){const{isMac:L}=_.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&L||i.target!==this.div)return;pt(this,f,!0);const q=u(this,r).getActive();pt(this,y,!q||q.isEmpty())}drop(i){const L=i.dataTransfer.getData("text/plain"),q=u(this,r).getEditor(L);if(!q)return;i.preventDefault(),i.dataTransfer.dropEffect="move",Z(this,m,ye).call(this,q);const $=this.div.getBoundingClientRect(),J=i.clientX-$.x,nt=i.clientY-$.y;q.translate(J-q.startX,nt-q.startY),this.moveEditorInDOM(q),q.div.focus()}dragover(i){i.preventDefault()}destroy(){var i,L;((i=u(this,r).getActive())==null?void 0:i.parent)===this&&u(this,r).setActiveEditor(null);for(const q of u(this,x).values())(L=u(this,I))==null||L.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove();this.div=null,u(this,x).clear(),u(this,r).removeLayer(this)}render({viewport:i}){this.viewport=i,(0,it.setLayerDimensions)(this.div,i),(0,k.bindEvents)(this,this.div,["dragover","drop"]);for(const L of u(this,r).getEditors(this.pageIndex))this.add(L);this.updateMode()}update({viewport:i}){u(this,r).commitOrRemove(),this.viewport=i,(0,it.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:L}=this.viewport.rawDims;return[i,L]}};let U=c;I=new WeakMap,y=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,f=new WeakMap,h=new WeakMap,r=new WeakMap,m=new WeakSet,ye=function(i){var L;i.parent!==this&&(this.attach(i),(L=i.parent)==null||L.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))},T=new WeakSet,qe=function(i){switch(u(this,r).getMode()){case _.AnnotationEditorType.FREETEXT:return new z.FreeTextEditor(i);case _.AnnotationEditorType.INK:return new G.InkEditor(i)}return null},t=new WeakSet,ve=function(i){const L=this.getNextId(),q=Z(this,T,qe).call(this,{parent:this,id:L,x:i.offsetX,y:i.offsetY,uiManager:u(this,r)});return q&&this.add(q),q},o=new WeakSet,Se=function(){pt(this,h,!0);for(const i of u(this,x).values())i.isEmpty()&&i.remove();pt(this,h,!1)},Ot(U,"_initialized",!1),b.AnnotationEditorLayer=U},(ht,b,K)=>{var it,U,I,y,N,w,x,f,h,r,Ge,v,Ve,g,Xe,a,Ee;Object.defineProperty(b,"__esModule",{value:!0}),b.FreeTextEditor=void 0;var _=K(1),k=K(5),z=K(4);const s=class extends z.AnnotationEditor{constructor(i){super({...i,name:"freeTextEditor"});Y(this,r);Y(this,v);Y(this,g);Y(this,a);Y(this,it,this.editorDivBlur.bind(this));Y(this,U,this.editorDivFocus.bind(this));Y(this,I,this.editorDivInput.bind(this));Y(this,y,this.editorDivKeydown.bind(this));Y(this,N,void 0);Y(this,w,"");Y(this,x,`${this.id}-editor`);Y(this,f,!1);Y(this,h,void 0);pt(this,N,i.color||s._defaultColor||z.AnnotationEditor._defaultLineColor),pt(this,h,i.fontSize||s._defaultFontSize)}static initialize(i){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(q=>[q,i.get(q)]));const L=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(L.getPropertyValue("--freetext-padding"))}static updateDefaultParams(i,L){switch(i){case _.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=L;break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=L;break}}updateParams(i,L){switch(i){case _.AnnotationEditorParamsType.FREETEXT_SIZE:Z(this,r,Ge).call(this,L);break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:Z(this,v,Ve).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[_.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,u(this,h)],[_.AnnotationEditorParamsType.FREETEXT_COLOR,u(this,N)]]}getInitialTranslation(){const i=this.parentScale;return[-s._internalPadding*i,-(s._internalPadding+u(this,h))*i]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(_.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",u(this,y)),this.editorDiv.addEventListener("focus",u(this,U)),this.editorDiv.addEventListener("blur",u(this,it)),this.editorDiv.addEventListener("input",u(this,I)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,x)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",u(this,y)),this.editorDiv.removeEventListener("focus",u(this,U)),this.editorDiv.removeEventListener("blur",u(this,it)),this.editorDiv.removeEventListener("input",u(this,I)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(i){super.focusin(i),i.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),u(this,f)||(pt(this,f,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pt(this,w,Z(this,g,Xe).call(this).trimEnd()),Z(this,a,Ee).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(i){this.enableEditMode(),this.editorDiv.focus()}keydown(i){i.target===this.div&&i.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(i){s._keyboardManager.exec(this,i)}editorDivFocus(i){this.isEditing=!0}editorDivBlur(i){this.isEditing=!1}editorDivInput(i){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let i,L;this.width&&(i=this.x,L=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,x)),this.enableEditing(),s._l10nPromise.get("editor_free_text2_aria_label").then($=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("aria-label",$)}),s._l10nPromise.get("free_text2_default_content").then($=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("default-content",$)}),this.editorDiv.contentEditable=!0;const{style:q}=this.editorDiv;if(q.fontSize=`calc(${u(this,h)}px * var(--scale-factor))`,q.color=u(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,k.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$,J]=this.parentDimensions;this.setAt(i*$,L*J,this.width*$,this.height*J);for(const nt of u(this,w).split(`
`)){const dt=document.createElement("div");dt.append(nt?document.createTextNode(nt):document.createElement("br")),this.editorDiv.append(dt)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(i,L,q){const $=super.deserialize(i,L,q);return pt($,h,i.fontSize),pt($,N,_.Util.makeHexColor(...i.color)),pt($,w,i.value),$}serialize(){if(this.isEmpty())return null;const i=s._internalPadding*this.parentScale,L=this.getRect(i,i),q=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,N));return{annotationType:_.AnnotationEditorType.FREETEXT,color:q,fontSize:u(this,h),value:u(this,w),pageIndex:this.pageIndex,rect:L,rotation:this.rotation}}};let G=s;it=new WeakMap,U=new WeakMap,I=new WeakMap,y=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,f=new WeakMap,h=new WeakMap,r=new WeakSet,Ge=function(i){const L=$=>{this.editorDiv.style.fontSize=`calc(${$}px * var(--scale-factor))`,this.translate(0,-($-u(this,h))*this.parentScale),pt(this,h,$),Z(this,a,Ee).call(this)},q=u(this,h);this.addCommands({cmd:()=>{L(i)},undo:()=>{L(q)},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},v=new WeakSet,Ve=function(i){const L=u(this,N);this.addCommands({cmd:()=>{pt(this,N,this.editorDiv.style.color=i)},undo:()=>{pt(this,N,this.editorDiv.style.color=L)},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Xe=function(){const i=this.editorDiv.getElementsByTagName("div");if(i.length===0)return this.editorDiv.innerText;const L=[];for(const q of i)L.push(q.innerText.replace(/\r\n?|\n/,""));return L.join(`
`)},a=new WeakSet,Ee=function(){const[i,L]=this.parentDimensions;let q;if(this.isAttachedToDOM)q=this.div.getBoundingClientRect();else{const{currentLayer:$,div:J}=this,nt=J.style.display;J.style.display="hidden",$.div.append(this.div),q=J.getBoundingClientRect(),J.remove(),J.style.display=nt}this.width=q.width/i,this.height=q.height/L},Ot(G,"_freeTextDefaultContent",""),Ot(G,"_l10nPromise"),Ot(G,"_internalPadding",0),Ot(G,"_defaultColor",null),Ot(G,"_defaultFontSize",10),Ot(G,"_keyboardManager",new k.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Ot(G,"_type","freetext"),b.FreeTextEditor=G},(ht,b,K)=>{var I,y,N,w,x,f,h,r,m,v,T,g,t,a,o,ze,c,$e,i,Ye,q,Ke,J,Ce,dt,Je,ct,Qe,yt,Ze,_t,Xt,l,Te,S,oe,O,le,D,Qt,M,xe,n,ce,A,we,B,ts,X,es,rt,ss,st,Pe,ft,he,At,Zt,V,ke;Object.defineProperty(b,"__esModule",{value:!0}),b.InkEditor=void 0,Object.defineProperty(b,"fitCurve",{enumerable:!0,get:function(){return z.fitCurve}});var _=K(1),k=K(4),z=K(30),G=K(5);const it=16,vt=class extends k.AnnotationEditor{constructor(C){super({...C,name:"inkEditor"});Y(this,o);Y(this,c);Y(this,i);Y(this,q);Y(this,J);Y(this,dt);Y(this,ct);Y(this,yt);Y(this,_t);Y(this,l);Y(this,S);Y(this,O);Y(this,D);Y(this,M);Y(this,n);Y(this,B);Y(this,X);Y(this,rt);Y(this,st);Y(this,ft);Y(this,At);Y(this,V);Y(this,I,0);Y(this,y,0);Y(this,N,0);Y(this,w,this.canvasPointermove.bind(this));Y(this,x,this.canvasPointerleave.bind(this));Y(this,f,this.canvasPointerup.bind(this));Y(this,h,this.canvasPointerdown.bind(this));Y(this,r,!1);Y(this,m,!1);Y(this,v,null);Y(this,T,null);Y(this,g,0);Y(this,t,0);Y(this,a,null);this.color=C.color||null,this.thickness=C.thickness||null,this.opacity=C.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(C){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(F=>[F,C.get(F)]))}static updateDefaultParams(C,F){switch(C){case _.AnnotationEditorParamsType.INK_THICKNESS:vt._defaultThickness=F;break;case _.AnnotationEditorParamsType.INK_COLOR:vt._defaultColor=F;break;case _.AnnotationEditorParamsType.INK_OPACITY:vt._defaultOpacity=F/100;break}}updateParams(C,F){switch(C){case _.AnnotationEditorParamsType.INK_THICKNESS:Z(this,o,ze).call(this,F);break;case _.AnnotationEditorParamsType.INK_COLOR:Z(this,c,$e).call(this,F);break;case _.AnnotationEditorParamsType.INK_OPACITY:Z(this,i,Ye).call(this,F);break}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.INK_THICKNESS,vt._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,vt._defaultColor||k.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(vt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[_.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||vt._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,this.color||vt._defaultColor||k.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??vt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(Z(this,S,oe).call(this),Z(this,O,le).call(this)),this.isAttachedToDOM||(this.parent.add(this),Z(this,D,Qt).call(this)),Z(this,At,Zt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,u(this,T).disconnect(),pt(this,T,null),super.remove())}setParent(C){!this.parent&&C?this._uiManager.removeShouldRescale(this):this.parent&&C===null&&this._uiManager.addShouldRescale(this),super.setParent(C)}onScaleChanging(){const[C,F]=this.parentDimensions,at=this.width*C,gt=this.height*F;this.setDimensions(at,gt)}enableEditMode(){u(this,r)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",u(this,h)),this.canvas.addEventListener("pointerup",u(this,f)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",u(this,h)),this.canvas.removeEventListener("pointerup",u(this,f)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){u(this,r)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pt(this,r,!0),this.div.classList.add("disabled"),Z(this,At,Zt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(C){super.focusin(C),this.enableEditMode()}canvasPointerdown(C){C.button!==0||!this.isInEditMode()||u(this,r)||(this.setInForeground(),C.type!=="mouse"&&this.div.focus(),C.stopPropagation(),this.canvas.addEventListener("pointerleave",u(this,x)),this.canvas.addEventListener("pointermove",u(this,w)),Z(this,dt,Je).call(this,C.offsetX,C.offsetY))}canvasPointermove(C){C.stopPropagation(),Z(this,ct,Qe).call(this,C.offsetX,C.offsetY)}canvasPointerup(C){C.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(C.stopPropagation(),Z(this,l,Te).call(this,C),this.setInBackground())}canvasPointerleave(C){Z(this,l,Te).call(this,C),this.setInBackground()}render(){if(this.div)return this.div;let C,F;this.width&&(C=this.x,F=this.y),super.render(),vt._l10nPromise.get("editor_ink2_aria_label").then(kt=>{var Pt;return(Pt=this.div)==null?void 0:Pt.setAttribute("aria-label",kt)});const[at,gt,Tt,wt]=Z(this,q,Ke).call(this);if(this.setAt(at,gt,0,0),this.setDims(Tt,wt),Z(this,S,oe).call(this),this.width){const[kt,Pt]=this.parentDimensions;this.setAt(C*kt,F*Pt,this.width*kt,this.height*Pt),pt(this,m,!0),Z(this,D,Qt).call(this),this.setDims(this.width*kt,this.height*Pt),Z(this,_t,Xt).call(this),Z(this,V,ke).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Z(this,O,le).call(this),this.div}setDimensions(C,F){const at=Math.round(C),gt=Math.round(F);if(u(this,g)===at&&u(this,t)===gt)return;pt(this,g,at),pt(this,t,gt),this.canvas.style.visibility="hidden",u(this,I)&&Math.abs(u(this,I)-C/F)>.01&&(F=Math.ceil(C/u(this,I)),this.setDims(C,F));const[Tt,wt]=this.parentDimensions;this.width=C/Tt,this.height=F/wt,u(this,r)&&Z(this,M,xe).call(this,C,F),Z(this,D,Qt).call(this),Z(this,_t,Xt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(C,F,at){var Dt,It;const gt=super.deserialize(C,F,at);gt.thickness=C.thickness,gt.color=_.Util.makeHexColor(...C.color),gt.opacity=C.opacity;const[Tt,wt]=gt.pageDimensions,kt=gt.width*Tt,Pt=gt.height*wt,Mt=gt.parentScale,xt=C.thickness/2;pt(gt,I,kt/Pt),pt(gt,r,!0),pt(gt,g,Math.round(kt)),pt(gt,t,Math.round(Pt));for(const{bezier:Ft}of C.paths){const Bt=[];gt.paths.push(Bt);let Ut=Mt*(Ft[0]-xt),Wt=Mt*(Pt-Ft[1]-xt);for(let Nt=2,jt=Ft.length;Nt<jt;Nt+=6){const Gt=Mt*(Ft[Nt]-xt),zt=Mt*(Pt-Ft[Nt+1]-xt),se=Mt*(Ft[Nt+2]-xt),ne=Mt*(Pt-Ft[Nt+3]-xt),Me=Mt*(Ft[Nt+4]-xt),De=Mt*(Pt-Ft[Nt+5]-xt);Bt.push([[Ut,Wt],[Gt,zt],[se,ne],[Me,De]]),Ut=Me,Wt=De}const qt=Z(this,A,we).call(this,Bt);gt.bezierPath2D.push(qt)}const Lt=Z(Dt=gt,st,Pe).call(Dt);return pt(gt,N,Math.max(it,Lt[2]-Lt[0])),pt(gt,y,Math.max(it,Lt[3]-Lt[1])),Z(It=gt,M,xe).call(It,kt,Pt),gt}serialize(){if(this.isEmpty())return null;const C=this.getRect(0,0),F=this.rotation%180===0?C[3]-C[1]:C[2]-C[0],at=k.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:_.AnnotationEditorType.INK,color:at,thickness:this.thickness,opacity:this.opacity,paths:Z(this,B,ts).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,F),pageIndex:this.pageIndex,rect:C,rotation:this.rotation}}};let U=vt;I=new WeakMap,y=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,f=new WeakMap,h=new WeakMap,r=new WeakMap,m=new WeakMap,v=new WeakMap,T=new WeakMap,g=new WeakMap,t=new WeakMap,a=new WeakMap,o=new WeakSet,ze=function(C){const F=this.thickness;this.addCommands({cmd:()=>{this.thickness=C,Z(this,At,Zt).call(this)},undo:()=>{this.thickness=F,Z(this,At,Zt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,$e=function(C){const F=this.color;this.addCommands({cmd:()=>{this.color=C,Z(this,_t,Xt).call(this)},undo:()=>{this.color=F,Z(this,_t,Xt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,Ye=function(C){C/=100;const F=this.opacity;this.addCommands({cmd:()=>{this.opacity=C,Z(this,_t,Xt).call(this)},undo:()=>{this.opacity=F,Z(this,_t,Xt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},q=new WeakSet,Ke=function(){const{parentRotation:C,parentDimensions:[F,at]}=this;switch(C){case 90:return[0,at,at,F];case 180:return[F,at,F,at];case 270:return[F,0,at,F];default:return[0,0,F,at]}},J=new WeakSet,Ce=function(){const{ctx:C,color:F,opacity:at,thickness:gt,parentScale:Tt,scaleFactor:wt}=this;C.lineWidth=gt*Tt/wt,C.lineCap="round",C.lineJoin="round",C.miterLimit=10,C.strokeStyle=`${F}${(0,G.opacityToHex)(at)}`},dt=new WeakSet,Je=function(C,F){this.isEditing=!0,u(this,m)||(pt(this,m,!0),Z(this,D,Qt).call(this),this.thickness||(this.thickness=vt._defaultThickness),this.color||(this.color=vt._defaultColor||k.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=vt._defaultOpacity)),this.currentPath.push([C,F]),pt(this,v,null),Z(this,J,Ce).call(this),this.ctx.beginPath(),this.ctx.moveTo(C,F),pt(this,a,()=>{u(this,a)&&(u(this,v)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):Z(this,_t,Xt).call(this),this.ctx.lineTo(...u(this,v)),pt(this,v,null),this.ctx.stroke()),window.requestAnimationFrame(u(this,a)))}),window.requestAnimationFrame(u(this,a))},ct=new WeakSet,Qe=function(C,F){const[at,gt]=this.currentPath.at(-1);C===at&&F===gt||(this.currentPath.push([C,F]),pt(this,v,[C,F]))},yt=new WeakSet,Ze=function(C,F){var Mt;this.ctx.closePath(),pt(this,a,null),C=Math.min(Math.max(C,0),this.canvas.width),F=Math.min(Math.max(F,0),this.canvas.height);const[at,gt]=this.currentPath.at(-1);(C!==at||F!==gt)&&this.currentPath.push([C,F]);let Tt;if(this.currentPath.length!==1)Tt=(0,z.fitCurve)(this.currentPath,30,null);else{const xt=[C,F];Tt=[[xt,xt.slice(),xt.slice(),xt]]}const wt=Z(Mt=vt,A,we).call(Mt,Tt);this.currentPath.length=0;const kt=()=>{this.paths.push(Tt),this.bezierPath2D.push(wt),this.rebuild()},Pt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Z(this,S,oe).call(this),Z(this,O,le).call(this)),Z(this,At,Zt).call(this))};this.addCommands({cmd:kt,undo:Pt,mustExec:!0})},_t=new WeakSet,Xt=function(){if(this.isEmpty()){Z(this,n,ce).call(this);return}Z(this,J,Ce).call(this);const{canvas:C,ctx:F}=this;F.setTransform(1,0,0,1,0,0),F.clearRect(0,0,C.width,C.height),Z(this,n,ce).call(this);for(const at of this.bezierPath2D)F.stroke(at)},l=new WeakSet,Te=function(C){Z(this,yt,Ze).call(this,C.offsetX,C.offsetY),this.canvas.removeEventListener("pointerleave",u(this,x)),this.canvas.removeEventListener("pointermove",u(this,w)),this.addToAnnotationStorage()},S=new WeakSet,oe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",vt._l10nPromise.get("editor_ink_canvas_aria_label").then(C=>{var F;return(F=this.canvas)==null?void 0:F.setAttribute("aria-label",C)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},O=new WeakSet,le=function(){pt(this,T,new ResizeObserver(C=>{const F=C[0].contentRect;F.width&&F.height&&this.setDimensions(F.width,F.height)})),u(this,T).observe(this.div)},D=new WeakSet,Qt=function(){if(!u(this,m))return;const[C,F]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*C),this.canvas.height=Math.ceil(this.height*F),Z(this,n,ce).call(this)},M=new WeakSet,xe=function(C,F){const at=Z(this,ft,he).call(this),gt=(C-at)/u(this,N),Tt=(F-at)/u(this,y);this.scaleFactor=Math.min(gt,Tt)},n=new WeakSet,ce=function(){const C=Z(this,ft,he).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+C,this.translationY*this.scaleFactor+C)},A=new WeakSet,we=function(C){const F=new Path2D;for(let at=0,gt=C.length;at<gt;at++){const[Tt,wt,kt,Pt]=C[at];at===0&&F.moveTo(...Tt),F.bezierCurveTo(wt[0],wt[1],kt[0],kt[1],Pt[0],Pt[1])}return F},B=new WeakSet,ts=function(C,F,at,gt){const wt=[],kt=this.thickness/2;let Pt,Mt;for(const xt of this.paths){Pt=[],Mt=[];for(let Lt=0,Dt=xt.length;Lt<Dt;Lt++){const[It,Ft,Bt,Ut]=xt[Lt],Wt=C*(It[0]+F)+kt,qt=gt-C*(It[1]+at)-kt,Nt=C*(Ft[0]+F)+kt,jt=gt-C*(Ft[1]+at)-kt,Gt=C*(Bt[0]+F)+kt,zt=gt-C*(Bt[1]+at)-kt,se=C*(Ut[0]+F)+kt,ne=gt-C*(Ut[1]+at)-kt;Lt===0&&(Pt.push(Wt,qt),Mt.push(Wt,qt)),Pt.push(Nt,jt,Gt,zt,se,ne),Z(this,X,es).call(this,Wt,qt,Nt,jt,Gt,zt,se,ne,4,Mt)}wt.push({bezier:Pt,points:Mt})}return wt},X=new WeakSet,es=function(C,F,at,gt,Tt,wt,kt,Pt,Mt,xt){if(Z(this,rt,ss).call(this,C,F,at,gt,Tt,wt,kt,Pt)){xt.push(kt,Pt);return}for(let Lt=1;Lt<Mt-1;Lt++){const Dt=Lt/Mt,It=1-Dt;let Ft=Dt*C+It*at,Bt=Dt*F+It*gt,Ut=Dt*at+It*Tt,Wt=Dt*gt+It*wt;const qt=Dt*Tt+It*kt,Nt=Dt*wt+It*Pt;Ft=Dt*Ft+It*Ut,Bt=Dt*Bt+It*Wt,Ut=Dt*Ut+It*qt,Wt=Dt*Wt+It*Nt,Ft=Dt*Ft+It*Ut,Bt=Dt*Bt+It*Wt,xt.push(Ft,Bt)}xt.push(kt,Pt)},rt=new WeakSet,ss=function(C,F,at,gt,Tt,wt,kt,Pt){const xt=(3*at-2*C-kt)**2,Lt=(3*gt-2*F-Pt)**2,Dt=(3*Tt-C-2*kt)**2,It=(3*wt-F-2*Pt)**2;return Math.max(xt,Dt)+Math.max(Lt,It)<=10},st=new WeakSet,Pe=function(){let C=1/0,F=-1/0,at=1/0,gt=-1/0;for(const Tt of this.paths)for(const[wt,kt,Pt,Mt]of Tt){const xt=_.Util.bezierBoundingBox(...wt,...kt,...Pt,...Mt);C=Math.min(C,xt[0]),at=Math.min(at,xt[1]),F=Math.max(F,xt[2]),gt=Math.max(gt,xt[3])}return[C,at,F,gt]},ft=new WeakSet,he=function(){return u(this,r)?Math.ceil(this.thickness*this.parentScale):0},At=new WeakSet,Zt=function(C=!1){if(this.isEmpty())return;if(!u(this,r)){Z(this,_t,Xt).call(this);return}const F=Z(this,st,Pe).call(this),at=Z(this,ft,he).call(this);pt(this,N,Math.max(it,F[2]-F[0])),pt(this,y,Math.max(it,F[3]-F[1]));const gt=Math.ceil(at+u(this,N)*this.scaleFactor),Tt=Math.ceil(at+u(this,y)*this.scaleFactor),[wt,kt]=this.parentDimensions;this.width=gt/wt,this.height=Tt/kt,pt(this,I,gt/Tt),Z(this,V,ke).call(this);const Pt=this.translationX,Mt=this.translationY;this.translationX=-F[0],this.translationY=-F[1],Z(this,D,Qt).call(this),Z(this,_t,Xt).call(this),pt(this,g,gt),pt(this,t,Tt),this.setDims(gt,Tt);const xt=C?at/this.scaleFactor/2:0;this.translate(Pt-this.translationX-xt,Mt-this.translationY-xt)},V=new WeakSet,ke=function(){const{style:C}=this.div;u(this,I)>=1?(C.minHeight=`${it}px`,C.minWidth=`${Math.round(u(this,I)*it)}px`):(C.minWidth=`${it}px`,C.minHeight=`${Math.round(it/u(this,I))}px`)},Y(U,A),Ot(U,"_defaultColor",null),Ot(U,"_defaultOpacity",1),Ot(U,"_defaultThickness",1),Ot(U,"_l10nPromise"),Ot(U,"_type","ink"),b.InkEditor=U},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.fitCurve=void 0;const _=K(31);b.fitCurve=_},ht=>{function b(f,h,r){if(!Array.isArray(f))throw new TypeError("First argument should be an array");if(f.forEach(g=>{if(!Array.isArray(g)||g.some(t=>typeof t!="number")||g.length!==f[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),f=f.filter((g,t)=>t===0||!g.every((a,o)=>a===f[t-1][o])),f.length<2)return[];const m=f.length,v=N(f[1],f[0]),T=N(f[m-2],f[m-1]);return K(f,v,T,h,r)}function K(f,h,r,m,v){var g,t,a,o,s,c,P,i,L,q,$,J,nt;if(f.length===2)return J=w.vectorLen(w.subtract(f[0],f[1]))/3,g=[f[0],w.addArrays(f[0],w.mulItems(h,J)),w.addArrays(f[1],w.mulItems(r,J)),f[1]],[g];if(t=it(f),[g,o,c]=_(f,t,t,h,r,v),o===0||o<m)return[g];if(o<m*m)for(a=t,s=o,P=c,nt=0;nt<20;nt++){if(a=z(g,f,a),[g,o,c]=_(f,t,a,h,r,v),o<m)return[g];if(c===P){let dt=o/s;if(dt>.9999&&dt<1.0001)break}s=o,P=c}return $=[],i=w.subtract(f[c-1],f[c+1]),i.every(dt=>dt===0)&&(i=w.subtract(f[c-1],f[c]),[i[0],i[1]]=[-i[1],i[0]]),L=w.normalize(i),q=w.mulItems(L,-1),$=$.concat(K(f.slice(0,c+1),h,L,m,v)),$=$.concat(K(f.slice(c),q,r,m,v)),$}function _(f,h,r,m,v,T){var g,t,a;return g=k(f,r,m,v),[t,a]=U(f,g,h),T&&T({bez:g,points:f,params:h,maxErr:t,maxPoint:a}),[g,t,a]}function k(f,h,r,m){var v,T,g,t,a,o,s,c,P,i,L,q,$,J,nt,dt,ot,ct=f[0],mt=f[f.length-1];for(v=[ct,null,null,mt],T=w.zeros_Xx2x2(h.length),$=0,J=h.length;$<J;$++)dt=h[$],ot=1-dt,g=T[$],g[0]=w.mulItems(r,3*dt*(ot*ot)),g[1]=w.mulItems(m,3*ot*(dt*dt));for(t=[[0,0],[0,0]],a=[0,0],$=0,J=f.length;$<J;$++)dt=h[$],g=T[$],t[0][0]+=w.dot(g[0],g[0]),t[0][1]+=w.dot(g[0],g[1]),t[1][0]+=w.dot(g[0],g[1]),t[1][1]+=w.dot(g[1],g[1]),nt=w.subtract(f[$],x.q([ct,ct,mt,mt],dt)),a[0]+=w.dot(g[0],nt),a[1]+=w.dot(g[1],nt);return o=t[0][0]*t[1][1]-t[1][0]*t[0][1],s=t[0][0]*a[1]-t[1][0]*a[0],c=a[0]*t[1][1]-a[1]*t[0][1],P=o===0?0:c/o,i=o===0?0:s/o,q=w.vectorLen(w.subtract(ct,mt)),L=1e-6*q,P<L||i<L?(v[1]=w.addArrays(ct,w.mulItems(r,q/3)),v[2]=w.addArrays(mt,w.mulItems(m,q/3))):(v[1]=w.addArrays(ct,w.mulItems(r,P)),v[2]=w.addArrays(mt,w.mulItems(m,i))),v}function z(f,h,r){return r.map((m,v)=>G(f,h[v],m))}function G(f,h,r){var m=w.subtract(x.q(f,r),h),v=x.qprime(f,r),T=w.mulMatrix(m,v),g=w.sum(w.squareItems(v))+2*w.mulMatrix(m,x.qprimeprime(f,r));return g===0?r:r-T/g}function it(f){var h=[],r,m,v;return f.forEach((T,g)=>{r=g?m+w.vectorLen(w.subtract(T,v)):0,h.push(r),m=r,v=T}),h=h.map(T=>T/m),h}function U(f,h,r){var m,v,T,g,t,a,o,s;v=0,T=Math.floor(f.length/2);const c=I(h,10);for(t=0,a=f.length;t<a;t++)o=f[t],s=y(h,r[t],c,10),g=w.subtract(x.q(h,s),o),m=g[0]*g[0]+g[1]*g[1],m>v&&(v=m,T=t);return[v,T]}var I=function(f,h){for(var r,m=[0],v=f[0],T=0,g=1;g<=h;g++)r=x.q(f,g/h),T+=w.vectorLen(w.subtract(r,v)),m.push(T),v=r;return m=m.map(t=>t/T),m};function y(f,h,r,m){if(h<0)return 0;if(h>1)return 1;for(var v,T,g,t,a,o=1;o<=m;o++)if(h<=r[o]){t=(o-1)/m,g=o/m,T=r[o-1],v=r[o],a=(h-T)/(v-T)*(g-t)+t;break}return a}function N(f,h){return w.normalize(w.subtract(f,h))}class w{static zeros_Xx2x2(h){for(var r=[];h--;)r.push([0,0]);return r}static mulItems(h,r){return h.map(m=>m*r)}static mulMatrix(h,r){return h.reduce((m,v,T)=>m+v*r[T],0)}static subtract(h,r){return h.map((m,v)=>m-r[v])}static addArrays(h,r){return h.map((m,v)=>m+r[v])}static addItems(h,r){return h.map(m=>m+r)}static sum(h){return h.reduce((r,m)=>r+m)}static dot(h,r){return w.mulMatrix(h,r)}static vectorLen(h){return Math.hypot(...h)}static divItems(h,r){return h.map(m=>m/r)}static squareItems(h){return h.map(r=>r*r)}static normalize(h){return this.divItems(h,this.vectorLen(h))}}class x{static q(h,r){var m=1-r,v=w.mulItems(h[0],m*m*m),T=w.mulItems(h[1],3*m*m*r),g=w.mulItems(h[2],3*m*r*r),t=w.mulItems(h[3],r*r*r);return w.addArrays(w.addArrays(v,T),w.addArrays(g,t))}static qprime(h,r){var m=1-r,v=w.mulItems(w.subtract(h[1],h[0]),3*m*m),T=w.mulItems(w.subtract(h[2],h[1]),6*m*r),g=w.mulItems(w.subtract(h[3],h[2]),3*r*r);return w.addArrays(w.addArrays(v,T),g)}static qprimeprime(h,r){return w.addArrays(w.mulItems(w.addArrays(w.subtract(h[2],w.mulItems(h[1],2)),h[0]),6*(1-r)),w.mulItems(w.addArrays(w.subtract(h[3],w.mulItems(h[2],2)),h[1]),6*r))}}ht.exports=b,ht.exports.fitCubic=K,ht.exports.createTangent=N},(ht,b,K)=>{var _t,Yt,l,ns,j,Fe,H,Re;Object.defineProperty(b,"__esModule",{value:!0}),b.AnnotationLayer=void 0;var _=K(1),k=K(6),z=K(3),G=K(33),it=K(34);const U=1e3,I=9,y=new WeakSet;function N(M){return{width:M[2]-M[0],height:M[3]-M[1]}}class w{static create(e){switch(e.data.annotationType){case _.AnnotationType.LINK:return new f(e);case _.AnnotationType.TEXT:return new h(e);case _.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new m(e);case"Btn":return e.data.radioButton?new T(e):e.data.checkBox?new v(e):new g(e);case"Ch":return new t(e)}return new r(e);case _.AnnotationType.POPUP:return new a(e);case _.AnnotationType.FREETEXT:return new s(e);case _.AnnotationType.LINE:return new c(e);case _.AnnotationType.SQUARE:return new P(e);case _.AnnotationType.CIRCLE:return new i(e);case _.AnnotationType.POLYLINE:return new L(e);case _.AnnotationType.CARET:return new $(e);case _.AnnotationType.INK:return new J(e);case _.AnnotationType.POLYGON:return new q(e);case _.AnnotationType.HIGHLIGHT:return new nt(e);case _.AnnotationType.UNDERLINE:return new dt(e);case _.AnnotationType.SQUIGGLY:return new ot(e);case _.AnnotationType.STRIKEOUT:return new ct(e);case _.AnnotationType.STAMP:return new mt(e);case _.AnnotationType.FILEATTACHMENT:return new yt(e);default:return new x(e)}}}class x{constructor(e,{isRenderable:n=!1,ignoreBorder:p=!1,createQuadrilaterals:A=!1}={}){this.isRenderable=n,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,n&&(this.container=this._createContainer(p)),A&&(this.quadrilaterals=this._createQuadrilaterals(p))}_createContainer(e=!1){const{data:n,page:p,viewport:A}=this,E=document.createElement("section");E.setAttribute("data-annotation-id",n.id),n.noRotate&&E.classList.add("norotate");const{pageWidth:B,pageHeight:tt,pageX:X,pageY:et}=A.rawDims,{width:rt,height:Q}=N(n.rect),st=_.Util.normalizeRect([n.rect[0],p.view[3]-n.rect[1]+p.view[1],n.rect[2],p.view[3]-n.rect[3]+p.view[1]]);if(!e&&n.borderStyle.width>0){E.style.borderWidth=`${n.borderStyle.width}px`;const ft=n.borderStyle.horizontalCornerRadius,Et=n.borderStyle.verticalCornerRadius;if(ft>0||Et>0){const Ct=`calc(${ft}px * var(--scale-factor)) / calc(${Et}px * var(--scale-factor))`;E.style.borderRadius=Ct}else if(this instanceof T){const Ct=`calc(${rt}px * var(--scale-factor)) / calc(${Q}px * var(--scale-factor))`;E.style.borderRadius=Ct}switch(n.borderStyle.style){case _.AnnotationBorderStyleType.SOLID:E.style.borderStyle="solid";break;case _.AnnotationBorderStyleType.DASHED:E.style.borderStyle="dashed";break;case _.AnnotationBorderStyleType.BEVELED:(0,_.warn)("Unimplemented border style: beveled");break;case _.AnnotationBorderStyleType.INSET:(0,_.warn)("Unimplemented border style: inset");break;case _.AnnotationBorderStyleType.UNDERLINE:E.style.borderBottomStyle="solid";break}const At=n.borderColor||null;At?E.style.borderColor=_.Util.makeHexColor(At[0]|0,At[1]|0,At[2]|0):E.style.borderWidth=0}E.style.left=`${100*(st[0]-X)/B}%`,E.style.top=`${100*(st[1]-et)/tt}%`;const{rotation:ut}=n;return n.hasOwnCanvas||ut===0?(E.style.width=`${100*rt/B}%`,E.style.height=`${100*Q/tt}%`):this.setRotation(ut,E),E}setRotation(e,n=this.container){const{pageWidth:p,pageHeight:A}=this.viewport.rawDims,{width:E,height:B}=N(this.data.rect);let tt,X;e%180===0?(tt=100*E/p,X=100*B/A):(tt=100*B/p,X=100*E/A),n.style.width=`${tt}%`,n.style.height=`${X}%`,n.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(n,p,A)=>{const E=A.detail[n];A.target.style[p]=G.ColorConverters[`${E[0]}_HTML`](E.slice(1))};return(0,_.shadow)(this,"_commonActions",{display:n=>{const p=n.detail.display%2===1;this.container.style.visibility=p?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:p,print:n.detail.display===0||n.detail.display===3})},print:n=>{this.annotationStorage.setValue(this.data.id,{print:n.detail.print})},hidden:n=>{this.container.style.visibility=n.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:n.detail.hidden})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.detail.readonly?n.target.setAttribute("readonly",""):n.target.removeAttribute("readonly")},required:n=>{this._setRequired(n.target,n.detail.required)},bgColor:n=>{e("bgColor","backgroundColor",n)},fillColor:n=>{e("fillColor","backgroundColor",n)},fgColor:n=>{e("fgColor","color",n)},textColor:n=>{e("textColor","color",n)},borderColor:n=>{e("borderColor","borderColor",n)},strokeColor:n=>{e("strokeColor","borderColor",n)},rotation:n=>{const p=n.detail.rotation;this.setRotation(p),this.annotationStorage.setValue(this.data.id,{rotation:p})}})}_dispatchEventFromSandbox(e,n){const p=this._commonActions;for(const A of Object.keys(n.detail)){const E=e[A]||p[A];E==null||E(n)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const p=this._commonActions;for(const[A,E]of Object.entries(n)){const B=p[A];if(B){const tt={detail:{[A]:E},target:e};B(tt),delete n[A]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const n=[],p=this.data.rect;for(const A of this.data.quadPoints)this.data.rect=[A[2].x,A[2].y,A[1].x,A[1].y],n.push(this._createContainer(e));return this.data.rect=p,n}_createPopup(e,n){let p=this.container;this.quadrilaterals&&(e||(e=this.quadrilaterals),p=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),p.append(e));const E=new o({container:p,trigger:e,color:n.color,titleObj:n.titleObj,modificationDate:n.modificationDate,contentsObj:n.contentsObj,richText:n.richText,hideWrapper:!0}).render();E.style.left="100%",p.append(E)}_renderQuadrilaterals(e){for(const n of this.quadrilaterals)n.classList.add(e);return this.quadrilaterals}render(){(0,_.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,n=null){const p=[];if(this._fieldObjects){const A=this._fieldObjects[e];if(A)for(const{page:E,id:B,exportValues:tt}of A){if(E===-1||B===n)continue;const X=typeof tt=="string"?tt:null,et=document.querySelector(`[data-element-id="${B}"]`);if(et&&!y.has(et)){(0,_.warn)(`_getElementsByName - element not allowed: ${B}`);continue}p.push({id:B,exportValue:X,domElement:et})}return p}for(const A of document.getElementsByName(e)){const{exportValue:E}=A,B=A.getAttribute("data-element-id");B!==n&&y.has(A)&&p.push({id:B,exportValue:E,domElement:A})}return p}}class f extends x{constructor(n,p=null){super(n,{isRenderable:!0,ignoreBorder:!!(p!=null&&p.ignoreBorder),createQuadrilaterals:!0});Y(this,_t);Y(this,l);this.isTooltipOnly=n.data.isTooltipOnly}render(){const{data:n,linkService:p}=this,A=document.createElement("a");A.setAttribute("data-element-id",n.id);let E=!1;return n.url?(p.addLinkAttributes(A,n.url,n.newWindow),E=!0):n.action?(this._bindNamedAction(A,n.action),E=!0):n.attachment?(this._bindAttachment(A,n.attachment),E=!0):n.setOCGState?(Z(this,l,ns).call(this,A,n.setOCGState),E=!0):n.dest?(this._bindLink(A,n.dest),E=!0):(n.actions&&(n.actions.Action||n.actions["Mouse Up"]||n.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,n),E=!0),n.resetForm?(this._bindResetFormAction(A,n.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(A,""),E=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((B,tt)=>{const X=tt===0?A:A.cloneNode();return B.append(X),B}):(this.container.classList.add("linkAnnotation"),E&&this.container.append(A),this.container)}_bindLink(n,p){n.href=this.linkService.getDestinationHash(p),n.onclick=()=>(p&&this.linkService.goToDestination(p),!1),(p||p==="")&&Z(this,_t,Yt).call(this)}_bindNamedAction(n,p){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeNamedAction(p),!1),Z(this,_t,Yt).call(this)}_bindAttachment(n,p){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>{var A;return(A=this.downloadManager)==null||A.openOrDownloadData(this.container,p.content,p.filename),!1},Z(this,_t,Yt).call(this)}_bindJSAction(n,p){n.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const E of Object.keys(p.actions)){const B=A.get(E);B&&(n[B]=()=>{var tt;return(tt=this.linkService.eventBus)==null||tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p.id,name:E}}),!1})}n.onclick||(n.onclick=()=>!1),Z(this,_t,Yt).call(this)}_bindResetFormAction(n,p){const A=n.onclick;if(A||(n.href=this.linkService.getAnchorUrl("")),Z(this,_t,Yt).call(this),!this._fieldObjects){(0,_.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(n.onclick=()=>!1);return}n.onclick=()=>{var Q;A==null||A();const{fields:E,refs:B,include:tt}=p,X=[];if(E.length!==0||B.length!==0){const st=new Set(B);for(const ut of E){const ft=this._fieldObjects[ut]||[];for(const{id:Et}of ft)st.add(Et)}for(const ut of Object.values(this._fieldObjects))for(const ft of ut)st.has(ft.id)===tt&&X.push(ft)}else for(const st of Object.values(this._fieldObjects))X.push(...st);const et=this.annotationStorage,rt=[];for(const st of X){const{id:ut}=st;switch(rt.push(ut),st.type){case"text":{const Et=st.defaultValue||"";et.setValue(ut,{value:Et});break}case"checkbox":case"radiobutton":{const Et=st.defaultValue===st.exportValues;et.setValue(ut,{value:Et});break}case"combobox":case"listbox":{const Et=st.defaultValue||"";et.setValue(ut,{value:Et});break}default:continue}const ft=document.querySelector(`[data-element-id="${ut}"]`);if(ft){if(!y.has(ft)){(0,_.warn)(`_bindResetFormAction - element not allowed: ${ut}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Q=this.linkService.eventBus)==null||Q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:rt,name:"ResetForm"}})),!1}}}_t=new WeakSet,Yt=function(){this.container.setAttribute("data-internal-link","")},l=new WeakSet,ns=function(n,p){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(p),!1),Z(this,_t,Yt).call(this)};class h extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class r extends x{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){var n;this.data.hasOwnCanvas&&(((n=e.previousSibling)==null?void 0:n.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:n,isMac:p}=_.FeatureTest.platform;return n&&e.ctrlKey||p&&e.metaKey}_setEventListener(e,n,p,A){n.includes("mouse")?e.addEventListener(n,E=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:A(E),shift:E.shiftKey,modifier:this._getKeyModifier(E)}})}):e.addEventListener(n,E=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:A(E)}})})}_setEventListeners(e,n,p){var A;for(const[E,B]of n)(B==="Action"||(A=this.data.actions)!=null&&A[B])&&this._setEventListener(e,E,B,p)}_setBackgroundColor(e){const n=this.data.backgroundColor||null;e.style.backgroundColor=n===null?"transparent":_.Util.makeHexColor(n[0],n[1],n[2])}_setTextStyle(e){const n=["left","center","right"],{fontColor:p}=this.data.defaultAppearanceData,A=this.data.defaultAppearanceData.fontSize||I,E=e.style;let B;const tt=2,X=et=>Math.round(10*et)/10;if(this.data.multiLine){const et=Math.abs(this.data.rect[3]-this.data.rect[1]-tt),rt=Math.round(et/(_.LINE_FACTOR*A))||1,Q=et/rt;B=Math.min(A,X(Q/_.LINE_FACTOR))}else{const et=Math.abs(this.data.rect[3]-this.data.rect[1]-tt);B=Math.min(A,X(et/_.LINE_FACTOR))}E.fontSize=`calc(${B}px * var(--scale-factor))`,E.color=_.Util.makeHexColor(p[0],p[1],p[2]),this.data.textAlignment!==null&&(E.textAlign=n[this.data.textAlignment])}_setRequired(e,n){n?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",n)}}class m extends r{constructor(e){const n=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:n})}setPropertyOnSiblings(e,n,p,A){const E=this.annotationStorage;for(const B of this._getElementsByName(e.name,e.id))B.domElement&&(B.domElement[n]=p),E.setValue(B.id,{[A]:p})}render(){var A;const e=this.annotationStorage,n=this.data.id;this.container.classList.add("textWidgetAnnotation");let p=null;if(this.renderForms){const E=e.getValue(n,{value:this.data.fieldValue});let B=E.formattedValue||E.value||"";const tt=e.getValue(n,{charLimit:this.data.maxLen}).charLimit;tt&&B.length>tt&&(B=B.slice(0,tt));const X={userValue:B,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(p=document.createElement("textarea"),p.textContent=B,this.data.doNotScroll&&(p.style.overflowY="hidden")):(p=document.createElement("input"),p.type="text",p.setAttribute("value",B),this.data.doNotScroll&&(p.style.overflowX="hidden")),this.data.hasOwnCanvas&&(p.hidden=!0),y.add(p),p.setAttribute("data-element-id",n),p.disabled=this.data.readOnly,p.name=this.data.fieldName,p.tabIndex=U,this._setRequired(p,this.data.required),tt&&(p.maxLength=tt),p.addEventListener("input",rt=>{e.setValue(n,{value:rt.target.value}),this.setPropertyOnSiblings(p,"value",rt.target.value,"value")}),p.addEventListener("resetform",rt=>{const Q=this.data.defaultFieldValue??"";p.value=X.userValue=Q,X.formattedValue=null});let et=rt=>{const{formattedValue:Q}=X;Q!=null&&(rt.target.value=Q),rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){p.addEventListener("focus",Q=>{const{target:st}=Q;X.userValue&&(st.value=X.userValue),X.lastCommittedValue=st.value,X.commitKey=1}),p.addEventListener("updatefromsandbox",Q=>{this.showElementAndHideCanvas(Q.target);const st={value(ut){X.userValue=ut.detail.value??"",e.setValue(n,{value:X.userValue.toString()}),ut.target.value=X.userValue},formattedValue(ut){const{formattedValue:ft}=ut.detail;X.formattedValue=ft,ft!=null&&ut.target!==document.activeElement&&(ut.target.value=ft),e.setValue(n,{formattedValue:ft})},selRange(ut){ut.target.setSelectionRange(...ut.detail.selRange)},charLimit:ut=>{var Ct;const{charLimit:ft}=ut.detail,{target:Et}=ut;if(ft===0){Et.removeAttribute("maxLength");return}Et.setAttribute("maxLength",ft);let At=X.userValue;!At||At.length<=ft||(At=At.slice(0,ft),Et.value=X.userValue=At,e.setValue(n,{value:At}),(Ct=this.linkService.eventBus)==null||Ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:Et.selectionStart,selEnd:Et.selectionEnd}}))}};this._dispatchEventFromSandbox(st,Q)}),p.addEventListener("keydown",Q=>{var ft;X.commitKey=1;let st=-1;if(Q.key==="Escape"?st=0:Q.key==="Enter"&&!this.data.multiLine?st=2:Q.key==="Tab"&&(X.commitKey=3),st===-1)return;const{value:ut}=Q.target;X.lastCommittedValue!==ut&&(X.lastCommittedValue=ut,X.userValue=ut,(ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:ut,willCommit:!0,commitKey:st,selStart:Q.target.selectionStart,selEnd:Q.target.selectionEnd}}))});const rt=et;et=null,p.addEventListener("blur",Q=>{var ut;if(!Q.relatedTarget)return;const{value:st}=Q.target;X.userValue=st,X.lastCommittedValue!==st&&((ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:st,willCommit:!0,commitKey:X.commitKey,selStart:Q.target.selectionStart,selEnd:Q.target.selectionEnd}})),rt(Q)}),(A=this.data.actions)!=null&&A.Keystroke&&p.addEventListener("beforeinput",Q=>{var bt;X.lastCommittedValue=null;const{data:st,target:ut}=Q,{value:ft,selectionStart:Et,selectionEnd:At}=ut;let Ct=Et,V=At;switch(Q.inputType){case"deleteWordBackward":{const vt=ft.substring(0,Et).match(/\w*[^\w]*$/);vt&&(Ct-=vt[0].length);break}case"deleteWordForward":{const vt=ft.substring(Et).match(/^[^\w]*\w*/);vt&&(V+=vt[0].length);break}case"deleteContentBackward":Et===At&&(Ct-=1);break;case"deleteContentForward":Et===At&&(V+=1);break}Q.preventDefault(),(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:ft,change:st||"",willCommit:!1,selStart:Ct,selEnd:V}})}),this._setEventListeners(p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Q=>Q.target.value)}if(et&&p.addEventListener("blur",et),this.data.comb){const Q=(this.data.rect[2]-this.data.rect[0])/tt;p.classList.add("comb"),p.style.letterSpacing=`calc(${Q}px * var(--scale-factor) - 1ch)`}}else p=document.createElement("div"),p.textContent=this.data.fieldValue,p.style.verticalAlign="middle",p.style.display="table-cell";return this._setTextStyle(p),this._setBackgroundColor(p),this._setDefaultPropertiesFromJS(p),this.container.append(p),this.container}}class v extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,n=this.data,p=n.id;let A=e.getValue(p,{value:n.exportValue===n.fieldValue}).value;typeof A=="string"&&(A=A!=="Off",e.setValue(p,{value:A})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const E=document.createElement("input");return y.add(E),E.setAttribute("data-element-id",p),E.disabled=n.readOnly,this._setRequired(E,this.data.required),E.type="checkbox",E.name=n.fieldName,A&&E.setAttribute("checked",!0),E.setAttribute("exportValue",n.exportValue),E.tabIndex=U,E.addEventListener("change",B=>{const{name:tt,checked:X}=B.target;for(const et of this._getElementsByName(tt,p)){const rt=X&&et.exportValue===n.exportValue;et.domElement&&(et.domElement.checked=rt),e.setValue(et.id,{value:rt})}e.setValue(p,{value:X})}),E.addEventListener("resetform",B=>{const tt=n.defaultFieldValue||"Off";B.target.checked=tt===n.exportValue}),this.enableScripting&&this.hasJSActions&&(E.addEventListener("updatefromsandbox",B=>{const tt={value(X){X.target.checked=X.detail.value!=="Off",e.setValue(p,{value:X.target.checked})}};this._dispatchEventFromSandbox(tt,B)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class T extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,n=this.data,p=n.id;let A=e.getValue(p,{value:n.fieldValue===n.buttonValue}).value;typeof A=="string"&&(A=A!==n.buttonValue,e.setValue(p,{value:A}));const E=document.createElement("input");if(y.add(E),E.setAttribute("data-element-id",p),E.disabled=n.readOnly,this._setRequired(E,this.data.required),E.type="radio",E.name=n.fieldName,A&&E.setAttribute("checked",!0),E.tabIndex=U,E.addEventListener("change",B=>{const{name:tt,checked:X}=B.target;for(const et of this._getElementsByName(tt,p))e.setValue(et.id,{value:!1});e.setValue(p,{value:X})}),E.addEventListener("resetform",B=>{const tt=n.defaultFieldValue;B.target.checked=tt!=null&&tt===n.buttonValue}),this.enableScripting&&this.hasJSActions){const B=n.buttonValue;E.addEventListener("updatefromsandbox",tt=>{const X={value:et=>{const rt=B===et.detail.value;for(const Q of this._getElementsByName(et.target.name)){const st=rt&&Q.id===p;Q.domElement&&(Q.domElement.checked=st),e.setValue(Q.id,{value:st})}}};this._dispatchEventFromSandbox(X,tt)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],tt=>tt.target.checked)}return this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class g extends f{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const n=e.lastChild;return this.enableScripting&&this.hasJSActions&&n&&(this._setDefaultPropertiesFromJS(n),n.addEventListener("updatefromsandbox",p=>{this._dispatchEventFromSandbox({},p)})),e}}class t extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,n=this.data.id,p=e.getValue(n,{value:this.data.fieldValue}),A=document.createElement("select");y.add(A),A.setAttribute("data-element-id",n),A.disabled=this.data.readOnly,this._setRequired(A,this.data.required),A.name=this.data.fieldName,A.tabIndex=U;let E=this.data.combo&&this.data.options.length>0;this.data.combo||(A.size=this.data.options.length,this.data.multiSelect&&(A.multiple=!0)),A.addEventListener("resetform",rt=>{const Q=this.data.defaultFieldValue;for(const st of A.options)st.selected=st.value===Q});for(const rt of this.data.options){const Q=document.createElement("option");Q.textContent=rt.displayValue,Q.value=rt.exportValue,p.value.includes(rt.exportValue)&&(Q.setAttribute("selected",!0),E=!1),A.append(Q)}let B=null;if(E){const rt=document.createElement("option");rt.value=" ",rt.setAttribute("hidden",!0),rt.setAttribute("selected",!0),A.prepend(rt),B=()=>{rt.remove(),A.removeEventListener("input",B),B=null},A.addEventListener("input",B)}const tt=rt=>{const Q=rt?"value":"textContent",{options:st,multiple:ut}=A;return ut?Array.prototype.filter.call(st,ft=>ft.selected).map(ft=>ft[Q]):st.selectedIndex===-1?null:st[st.selectedIndex][Q]};let X=tt(!1);const et=rt=>{const Q=rt.target.options;return Array.prototype.map.call(Q,st=>({displayValue:st.textContent,exportValue:st.value}))};return this.enableScripting&&this.hasJSActions?(A.addEventListener("updatefromsandbox",rt=>{const Q={value(st){B==null||B();const ut=st.detail.value,ft=new Set(Array.isArray(ut)?ut:[ut]);for(const Et of A.options)Et.selected=ft.has(Et.value);e.setValue(n,{value:tt(!0)}),X=tt(!1)},multipleSelection(st){A.multiple=!0},remove(st){const ut=A.options,ft=st.detail.remove;ut[ft].selected=!1,A.remove(ft),ut.length>0&&Array.prototype.findIndex.call(ut,At=>At.selected)===-1&&(ut[0].selected=!0),e.setValue(n,{value:tt(!0),items:et(st)}),X=tt(!1)},clear(st){for(;A.length!==0;)A.remove(0);e.setValue(n,{value:null,items:[]}),X=tt(!1)},insert(st){const{index:ut,displayValue:ft,exportValue:Et}=st.detail.insert,At=A.children[ut],Ct=document.createElement("option");Ct.textContent=ft,Ct.value=Et,At?At.before(Ct):A.append(Ct),e.setValue(n,{value:tt(!0),items:et(st)}),X=tt(!1)},items(st){const{items:ut}=st.detail;for(;A.length!==0;)A.remove(0);for(const ft of ut){const{displayValue:Et,exportValue:At}=ft,Ct=document.createElement("option");Ct.textContent=Et,Ct.value=At,A.append(Ct)}A.options.length>0&&(A.options[0].selected=!0),e.setValue(n,{value:tt(!0),items:et(st)}),X=tt(!1)},indices(st){const ut=new Set(st.detail.indices);for(const ft of st.target.options)ft.selected=ut.has(ft.index);e.setValue(n,{value:tt(!0)}),X=tt(!1)},editable(st){st.target.disabled=!st.detail.editable}};this._dispatchEventFromSandbox(Q,rt)}),A.addEventListener("input",rt=>{var st;const Q=tt(!0);e.setValue(n,{value:Q}),rt.preventDefault(),(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:X,changeEx:Q,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],rt=>rt.target.value)):A.addEventListener("input",function(rt){e.setValue(n,{value:tt(!0)})}),this.data.combo&&this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}const S=class extends x{constructor(e){var A,E,B;const{data:n}=e,p=!S.IGNORE_TYPES.has(n.parentType)&&!!((A=n.titleObj)!=null&&A.str||(E=n.contentsObj)!=null&&E.str||(B=n.richText)!=null&&B.str);super(e,{isRenderable:p})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const n=new o({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),p=this.page,A=_.Util.normalizeRect([this.data.parentRect[0],p.view[3]-this.data.parentRect[1]+p.view[1],this.data.parentRect[2],p.view[3]-this.data.parentRect[3]+p.view[1]]),E=A[0]+this.data.parentRect[2]-this.data.parentRect[0],B=A[1],{pageWidth:tt,pageHeight:X,pageX:et,pageY:rt}=this.viewport.rawDims;return this.container.style.left=`${100*(E-et)/tt}%`,this.container.style.top=`${100*(B-rt)/X}%`,this.container.append(n.render()),this.container}};let a=S;Ot(a,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class o{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var tt,X;const n=document.createElement("div");n.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?n:this.container,this.hideElement.hidden=!0;const p=document.createElement("div");p.classList.add("popup");const A=this.color;if(A){const et=.7*(255-A[0])+A[0],rt=.7*(255-A[1])+A[1],Q=.7*(255-A[2])+A[2];p.style.backgroundColor=_.Util.makeHexColor(et|0,rt|0,Q|0)}const E=document.createElement("h1");E.dir=this.titleObj.dir,E.textContent=this.titleObj.str,p.append(E);const B=k.PDFDateString.toDateObject(this.modificationDate);if(B){const et=document.createElement("span");et.classList.add("popupDate"),et.textContent="{{date}}, {{time}}",et.dataset.l10nId="annotation_date_string",et.dataset.l10nArgs=JSON.stringify({date:B.toLocaleDateString(),time:B.toLocaleTimeString()}),p.append(et)}if((tt=this.richText)!=null&&tt.str&&(!((X=this.contentsObj)!=null&&X.str)||this.contentsObj.str===this.richText.str))it.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:p}),p.lastChild.classList.add("richText","popupContent");else{const et=this._formatContents(this.contentsObj);p.append(et)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const et of this.trigger)et.addEventListener("click",this._toggle.bind(this)),et.addEventListener("mouseover",this._show.bind(this,!1)),et.addEventListener("mouseout",this._hide.bind(this,!1));return p.addEventListener("click",this._hide.bind(this,!0)),n.append(p),n}_formatContents({str:e,dir:n}){const p=document.createElement("p");p.classList.add("popupContent"),p.dir=n;const A=e.split(/(?:\r\n?|\n)/);for(let E=0,B=A.length;E<B;++E){const tt=A[E];p.append(document.createTextNode(tt)),E<B-1&&p.append(document.createElement("br"))}return p}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class s extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const n of this.textContent){const p=document.createElement("span");p.textContent=n,e.append(p)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class c extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:p}=N(e.rect),A=this.svgFactory.create(n,p,!0),E=this.svgFactory.createElement("svg:line");return E.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),E.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),E.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),E.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),E.setAttribute("stroke-width",e.borderStyle.width||1),E.setAttribute("stroke","transparent"),E.setAttribute("fill","transparent"),A.append(E),this.container.append(A),this._createPopup(E,e),this.container}}class P extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:p}=N(e.rect),A=this.svgFactory.create(n,p,!0),E=e.borderStyle.width,B=this.svgFactory.createElement("svg:rect");return B.setAttribute("x",E/2),B.setAttribute("y",E/2),B.setAttribute("width",n-E),B.setAttribute("height",p-E),B.setAttribute("stroke-width",E||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),A.append(B),this.container.append(A),this._createPopup(B,e),this.container}}class i extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:p}=N(e.rect),A=this.svgFactory.create(n,p,!0),E=e.borderStyle.width,B=this.svgFactory.createElement("svg:ellipse");return B.setAttribute("cx",n/2),B.setAttribute("cy",p/2),B.setAttribute("rx",n/2-E/2),B.setAttribute("ry",p/2-E/2),B.setAttribute("stroke-width",E||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),A.append(B),this.container.append(A),this._createPopup(B,e),this.container}}class L extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:n,height:p}=N(e.rect),A=this.svgFactory.create(n,p,!0);let E=[];for(const tt of e.vertices){const X=tt.x-e.rect[0],et=e.rect[3]-tt.y;E.push(X+","+et)}E=E.join(" ");const B=this.svgFactory.createElement(this.svgElementName);return B.setAttribute("points",E),B.setAttribute("stroke-width",e.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),A.append(B),this.container.append(A),this._createPopup(B,e),this.container}}class q extends L{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:n,height:p}=N(e.rect),A=this.svgFactory.create(n,p,!0);for(const E of e.inkLists){let B=[];for(const X of E){const et=X.x-e.rect[0],rt=e.rect[3]-X.y;B.push(`${et},${rt}`)}B=B.join(" ");const tt=this.svgFactory.createElement(this.svgElementName);tt.setAttribute("points",B),tt.setAttribute("stroke-width",e.borderStyle.width||1),tt.setAttribute("stroke","transparent"),tt.setAttribute("fill","transparent"),this._createPopup(tt,e),A.append(tt)}return this.container.append(A),this.container}}class nt extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class dt extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class ot extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ct extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class mt extends x{constructor(e){var p,A,E;const n=!!(e.data.hasPopup||(p=e.data.titleObj)!=null&&p.str||(A=e.data.contentsObj)!=null&&A.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class yt extends x{constructor(e){var A;super(e,{isRenderable:!0});const{filename:n,content:p}=this.data.file;this.filename=(0,k.getFilenameFromUrl)(n,!0),this.content=p,(A=this.linkService.eventBus)==null||A.dispatch("fileattachmentannotation",{source:this,filename:n,content:p})}render(){var n,p;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((n=this.data.titleObj)!=null&&n.str||(p=this.data.contentsObj)!=null&&p.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const R=class{static render(e){var X,et;const{annotations:n,div:p,viewport:A,accessibilityManager:E}=e;(0,k.setLayerDimensions)(p,A);const B={data:null,layer:p,page:e.page,viewport:A,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new k.DOMSVGFactory,annotationStorage:e.annotationStorage||new z.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let tt=0;for(const rt of n){if(rt.noHTML)continue;if(rt.annotationType!==_.AnnotationType.POPUP){const{width:ut,height:ft}=N(rt.rect);if(ut<=0||ft<=0)continue}B.data=rt;const Q=w.create(B);if(!Q.isRenderable)continue;const st=Q.render();if(rt.hidden&&(st.style.visibility="hidden"),Array.isArray(st))for(const ut of st)ut.style.zIndex=tt++,Z(X=R,j,Fe).call(X,ut,rt.id,p,E);else st.style.zIndex=tt++,Q instanceof a?p.prepend(st):Z(et=R,j,Fe).call(et,st,rt.id,p,E)}Z(this,H,Re).call(this,p,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:n,div:p,viewport:A}=e;(0,k.setLayerDimensions)(p,{rotation:A.rotation}),Z(this,H,Re).call(this,p,n),p.hidden=!1}};let St=R;j=new WeakSet,Fe=function(e,n,p,A){const E=e.firstChild||e;E.id=`${k.AnnotationPrefix}${n}`,p.append(e),A==null||A.moveElementInDOM(p,e,E,!1)},H=new WeakSet,Re=function(e,n){if(n){for(const[p,A]of n){const E=e.querySelector(`[data-annotation-id="${p}"]`);if(!E)continue;const{firstChild:B}=E;B?B.nodeName==="CANVAS"?B.replaceWith(A):B.before(A):E.append(A)}n.clear()}},Y(St,j),Y(St,H),b.AnnotationLayer=St},(ht,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ColorConverters=void 0;function K(k){return Math.floor(Math.max(0,Math.min(1,k))*255).toString(16).padStart(2,"0")}class _{static CMYK_G([z,G,it,U]){return["G",1-Math.min(1,.3*z+.59*it+.11*G+U)]}static G_CMYK([z]){return["CMYK",0,0,0,1-z]}static G_RGB([z]){return["RGB",z,z,z]}static G_HTML([z]){const G=K(z);return`#${G}${G}${G}`}static RGB_G([z,G,it]){return["G",.3*z+.59*G+.11*it]}static RGB_HTML([z,G,it]){const U=K(z),I=K(G),y=K(it);return`#${U}${I}${y}`}static T_HTML(){return"#00000000"}static CMYK_RGB([z,G,it,U]){return["RGB",1-Math.min(1,z+U),1-Math.min(1,it+U),1-Math.min(1,G+U)]}static CMYK_HTML(z){const G=this.CMYK_RGB(z).slice(1);return this.RGB_HTML(G)}static RGB_CMYK([z,G,it]){const U=1-z,I=1-G,y=1-it,N=Math.min(U,I,y);return["CMYK",U,I,y,N]}}b.ColorConverters=_},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.XfaLayer=void 0;var _=K(19);class k{static setupStorage(G,it,U,I,y){const N=I.getValue(it,{value:null});switch(U.name){case"textarea":if(N.value!==null&&(G.textContent=N.value),y==="print")break;G.addEventListener("input",w=>{I.setValue(it,{value:w.target.value})});break;case"input":if(U.attributes.type==="radio"||U.attributes.type==="checkbox"){if(N.value===U.attributes.xfaOn?G.setAttribute("checked",!0):N.value===U.attributes.xfaOff&&G.removeAttribute("checked"),y==="print")break;G.addEventListener("change",w=>{I.setValue(it,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&G.setAttribute("value",N.value),y==="print")break;G.addEventListener("input",w=>{I.setValue(it,{value:w.target.value})})}break;case"select":if(N.value!==null)for(const w of U.children)w.attributes.value===N.value&&(w.attributes.selected=!0);G.addEventListener("input",w=>{const x=w.target.options,f=x.selectedIndex===-1?"":x[x.selectedIndex].value;I.setValue(it,{value:f})});break}}static setAttributes({html:G,element:it,storage:U=null,intent:I,linkService:y}){const{attributes:N}=it,w=G instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${I}`);for(const[x,f]of Object.entries(N))if(f!=null)switch(x){case"class":f.length&&G.setAttribute(x,f.join(" "));break;case"dataId":break;case"id":G.setAttribute("data-element-id",f);break;case"style":Object.assign(G.style,f);break;case"textContent":G.textContent=f;break;default:(!w||x!=="href"&&x!=="newWindow")&&G.setAttribute(x,f)}w&&y.addLinkAttributes(G,N.href,N.newWindow),U&&N.dataId&&this.setupStorage(G,N.dataId,it,U)}static render(G){var h;const it=G.annotationStorage,U=G.linkService,I=G.xfaHtml,y=G.intent||"display",N=document.createElement(I.name);I.attributes&&this.setAttributes({html:N,element:I,intent:y,linkService:U});const w=[[I,-1,N]],x=G.div;if(x.append(N),G.viewport){const r=`matrix(${G.viewport.transform.join(",")})`;x.style.transform=r}y!=="richText"&&x.setAttribute("class","xfaLayer xfaFont");const f=[];for(;w.length>0;){const[r,m,v]=w.at(-1);if(m+1===r.children.length){w.pop();continue}const T=r.children[++w.at(-1)[1]];if(T===null)continue;const{name:g}=T;if(g==="#text"){const a=document.createTextNode(T.value);f.push(a),v.append(a);continue}let t;if((h=T==null?void 0:T.attributes)!=null&&h.xmlns?t=document.createElementNS(T.attributes.xmlns,g):t=document.createElement(g),v.append(t),T.attributes&&this.setAttributes({html:t,element:T,storage:it,intent:y,linkService:U}),T.children&&T.children.length>0)w.push([T,-1,t]);else if(T.value){const a=document.createTextNode(T.value);_.XfaText.shouldBuildText(g)&&f.push(a),t.append(a)}}for(const r of x.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))r.setAttribute("readOnly",!0);return{textDivs:f}}static update(G){const it=`matrix(${G.viewport.transform.join(",")})`;G.div.style.transform=it,G.div.hidden=!1}}b.XfaLayer=k},(ht,b,K)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SVGGraphics=void 0;var _=K(6),k=K(1),z=K(10);let G=class{constructor(){(0,k.unreachable)("Not implemented: SVGGraphics")}};b.SVGGraphics=G;{let h=function(t){let a=[];const o=[];for(const s of t){if(s.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),o.push(a),a=a.at(-1).items;continue}s.fn==="restore"?a=o.pop():a.push(s)}return a},r=function(t){if(Number.isInteger(t))return t.toString();const a=t.toFixed(10);let o=a.length-1;if(a[o]!=="0")return a;do o--;while(a[o]==="0");return a.substring(0,a[o]==="."?o:o+1)},m=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${r(t[0])} ${r(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const a=Math.acos(t[0])*180/Math.PI;return`rotate(${r(a)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${r(t[4])} ${r(t[5])})`;return`matrix(${r(t[0])} ${r(t[1])} ${r(t[2])} ${r(t[3])} ${r(t[4])} ${r(t[5])})`};const it={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},U="http://www.w3.org/XML/1998/namespace",I="http://www.w3.org/1999/xlink",y=["butt","round","square"],N=["miter","round","bevel"],w=function(t,a="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([t],{type:a}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${a};base64,`;for(let P=0,i=t.length;P<i;P+=3){const L=t[P]&255,q=t[P+1]&255,$=t[P+2]&255,J=L>>2,nt=(L&3)<<4|q>>4,dt=P+1<i?(q&15)<<2|$>>6:64,ot=P+2<i?$&63:64;c+=s[J]+s[nt]+s[dt]+s[ot]}return c},x=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,o=new Int32Array(256);for(let $=0;$<256;$++){let J=$;for(let nt=0;nt<8;nt++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;o[$]=J}function s($,J,nt){let dt=-1;for(let ot=J;ot<nt;ot++){const ct=(dt^$[ot])&255,mt=o[ct];dt=dt>>>8^mt}return dt^-1}function c($,J,nt,dt){let ot=dt;const ct=J.length;nt[ot]=ct>>24&255,nt[ot+1]=ct>>16&255,nt[ot+2]=ct>>8&255,nt[ot+3]=ct&255,ot+=4,nt[ot]=$.charCodeAt(0)&255,nt[ot+1]=$.charCodeAt(1)&255,nt[ot+2]=$.charCodeAt(2)&255,nt[ot+3]=$.charCodeAt(3)&255,ot+=4,nt.set(J,ot),ot+=J.length;const mt=s(nt,dt+4,ot);nt[ot]=mt>>24&255,nt[ot+1]=mt>>16&255,nt[ot+2]=mt>>8&255,nt[ot+3]=mt&255}function P($,J,nt){let dt=1,ot=0;for(let ct=J;ct<nt;++ct)dt=(dt+($[ct]&255))%65521,ot=(ot+dt)%65521;return ot<<16|dt}function i($){if(!z.isNodeJS)return L($);try{let J;parseInt(process.versions.node)>=8?J=$:J=Buffer.from($);const nt=require$$5.deflateSync(J,{level:9});return nt instanceof Uint8Array?nt:new Uint8Array(nt)}catch(J){(0,k.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return L($)}function L($){let J=$.length;const nt=65535,dt=Math.ceil(J/nt),ot=new Uint8Array(2+J+dt*5+4);let ct=0;ot[ct++]=120,ot[ct++]=156;let mt=0;for(;J>nt;)ot[ct++]=0,ot[ct++]=255,ot[ct++]=255,ot[ct++]=0,ot[ct++]=0,ot.set($.subarray(mt,mt+nt),ct),ct+=nt,mt+=nt,J-=nt;ot[ct++]=1,ot[ct++]=J&255,ot[ct++]=J>>8&255,ot[ct++]=~J&65535&255,ot[ct++]=(~J&65535)>>8&255,ot.set($.subarray(mt),ct),ct+=$.length-mt;const yt=P($,0,$.length);return ot[ct++]=yt>>24&255,ot[ct++]=yt>>16&255,ot[ct++]=yt>>8&255,ot[ct++]=yt&255,ot}function q($,J,nt,dt){const ot=$.width,ct=$.height;let mt,yt,St;const _t=$.data;switch(J){case k.ImageKind.GRAYSCALE_1BPP:yt=0,mt=1,St=ot+7>>3;break;case k.ImageKind.RGB_24BPP:yt=2,mt=8,St=ot*3;break;case k.ImageKind.RGBA_32BPP:yt=6,mt=8,St=ot*4;break;default:throw new Error("invalid format")}const W=new Uint8Array((1+St)*ct);let l=0,d=0;for(let R=0;R<ct;++R)W[l++]=0,W.set(_t.subarray(d,d+St),l),d+=St,l+=St;if(J===k.ImageKind.GRAYSCALE_1BPP&&dt){l=0;for(let R=0;R<ct;R++){l++;for(let M=0;M<St;M++)W[l++]^=255}}const S=new Uint8Array([ot>>24&255,ot>>16&255,ot>>8&255,ot&255,ct>>24&255,ct>>16&255,ct>>8&255,ct&255,mt,yt,0,0,0]),j=i(W),O=t.length+a*3+S.length+j.length,H=new Uint8Array(O);let D=0;return H.set(t,D),D+=t.length,c("IHDR",S,H,D),D+=a+S.length,c("IDATA",j,H,D),D+=a+j.length,c("IEND",new Uint8Array(0),H,D),w(H,"image/png",nt)}return function(J,nt,dt){const ot=J.kind===void 0?k.ImageKind.GRAYSCALE_1BPP:J.kind;return q(J,ot,nt,dt)}}();class f{constructor(){this.fontSizeScale=1,this.fontWeight=it.fontWeight,this.fontSize=0,this.textMatrix=k.IDENTITY_MATRIX,this.fontMatrix=k.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=k.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=it.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,o){this.x=a,this.y=o}}let v=0,T=0,g=0;b.SVGGraphics=G=class{constructor(t,a,o=!1){(0,_.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new _.DOMSVGFactory,this.current=new f,this.transformMatrix=k.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const s in k.OPS)this._operatorIdMapping[k.OPS[s]]=s}getObject(t,a=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):a}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const a=t.fnArray,o=t.argsArray;for(let s=0,c=a.length;s<c;s++)if(a[s]===k.OPS.dependency)for(const P of o[s]){const i=P.startsWith("g_")?this.commonObjs:this.objs,L=new Promise(q=>{i.get(P,q)});this.current.dependencies.push(L)}return Promise.all(this.current.dependencies)}transform(t,a,o,s,c,P){const i=[t,a,o,s,c,P];this.transformMatrix=k.Util.transform(this.transformMatrix,i),this.tgrp=null}getSVG(t,a){this.viewport=a;const o=this._initialize(a);return this.loadDependencies(t).then(()=>(this.transformMatrix=k.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),o))}convertOpList(t){const a=this._operatorIdMapping,o=t.argsArray,s=t.fnArray,c=[];for(let P=0,i=s.length;P<i;P++){const L=s[P];c.push({fnId:L,fn:a[L],args:o[P]})}return h(c)}executeOpTree(t){for(const a of t){const o=a.fn,s=a.fnId,c=a.args;switch(s|0){case k.OPS.beginText:this.beginText();break;case k.OPS.dependency:break;case k.OPS.setLeading:this.setLeading(c);break;case k.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case k.OPS.setFont:this.setFont(c);break;case k.OPS.showText:this.showText(c[0]);break;case k.OPS.showSpacedText:this.showText(c[0]);break;case k.OPS.endText:this.endText();break;case k.OPS.moveText:this.moveText(c[0],c[1]);break;case k.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case k.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case k.OPS.setHScale:this.setHScale(c[0]);break;case k.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case k.OPS.setTextRise:this.setTextRise(c[0]);break;case k.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case k.OPS.setLineWidth:this.setLineWidth(c[0]);break;case k.OPS.setLineJoin:this.setLineJoin(c[0]);break;case k.OPS.setLineCap:this.setLineCap(c[0]);break;case k.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case k.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case k.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case k.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case k.OPS.setFillColorN:this.setFillColorN(c);break;case k.OPS.shadingFill:this.shadingFill(c[0]);break;case k.OPS.setDash:this.setDash(c[0],c[1]);break;case k.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case k.OPS.setFlatness:this.setFlatness(c[0]);break;case k.OPS.setGState:this.setGState(c[0]);break;case k.OPS.fill:this.fill();break;case k.OPS.eoFill:this.eoFill();break;case k.OPS.stroke:this.stroke();break;case k.OPS.fillStroke:this.fillStroke();break;case k.OPS.eoFillStroke:this.eoFillStroke();break;case k.OPS.clip:this.clip("nonzero");break;case k.OPS.eoClip:this.clip("evenodd");break;case k.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case k.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case k.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case k.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case k.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case k.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case k.OPS.closePath:this.closePath();break;case k.OPS.closeStroke:this.closeStroke();break;case k.OPS.closeFillStroke:this.closeFillStroke();break;case k.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case k.OPS.nextLine:this.nextLine();break;case k.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case k.OPS.constructPath:this.constructPath(c[0],c[1]);break;case k.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,k.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,a,o,s,c,P){const i=this.current;i.textMatrix=i.lineMatrix=[t,a,o,s,c,P],i.textMatrixScale=Math.hypot(t,a),i.x=i.lineX=0,i.y=i.lineY=0,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${r(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",r(-i.y)),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtElement.append(i.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=k.IDENTITY_MATRIX,t.lineMatrix=k.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,a){const o=this.current;o.x=o.lineX+=t,o.y=o.lineY+=a,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${r(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",r(-o.y))}showText(t){const a=this.current,o=a.font,s=a.fontSize;if(s===0)return;const c=a.fontSizeScale,P=a.charSpacing,i=a.wordSpacing,L=a.fontDirection,q=a.textHScale*L,$=o.vertical,J=$?1:-1,nt=o.defaultVMetrics,dt=s*a.fontMatrix[0];let ot=0;for(const yt of t){if(yt===null){ot+=L*i;continue}else if(typeof yt=="number"){ot+=J*yt*s/1e3;continue}const St=(yt.isSpace?i:0)+P,_t=yt.fontChar;let W,l,d=yt.width;if($){let j;const O=yt.vmetric||nt;j=yt.vmetric?O[1]:d*.5,j=-j*dt;const H=O[2]*dt;d=O?-O[0]:d,W=j/c,l=(ot+H)/c}else W=ot/c,l=0;(yt.isInFont||o.missingFile)&&(a.xcoords.push(a.x+W),$&&a.ycoords.push(-a.y+l),a.tspan.textContent+=_t);let S;$?S=d*dt-St*L:S=d*dt+St*L,ot+=S}a.tspan.setAttributeNS(null,"x",a.xcoords.map(r).join(" ")),$?a.tspan.setAttributeNS(null,"y",a.ycoords.map(r).join(" ")):a.tspan.setAttributeNS(null,"y",r(-a.y)),$?a.y-=ot:a.x+=ot*q,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${r(a.fontSize)}px`),a.fontStyle!==it.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==it.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const ct=a.textRenderingMode&k.TextRenderingMode.FILL_STROKE_MASK;if(ct===k.TextRenderingMode.FILL||ct===k.TextRenderingMode.FILL_STROKE?(a.fillColor!==it.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===k.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),ct===k.TextRenderingMode.STROKE||ct===k.TextRenderingMode.FILL_STROKE){const yt=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,yt)}let mt=a.textMatrix;a.textRise!==0&&(mt=mt.slice(),mt[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${m(mt)} scale(${r(q)}, -1)`),a.txtElement.setAttributeNS(U,"xml:space","preserve"),a.txtElement.append(a.tspan),a.txtgrp.append(a.txtElement),this._ensureTransformGroup().append(a.txtElement)}setLeadingMoveText(t,a){this.setLeading(-a),this.moveText(t,a)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const a=w(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${a}); }
`}setFont(t){const a=this.current,o=this.commonObjs.get(t[0]);let s=t[1];a.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),a.fontMatrix=o.fontMatrix||k.FONT_IDENTITY_MATRIX;let c="normal";o.black?c="900":o.bold&&(c="bold");const P=o.italic?"italic":"normal";s<0?(s=-s,a.fontDirection=-1):a.fontDirection=1,a.fontSize=s,a.fontFamily=o.loadedName,a.fontWeight=c,a.fontStyle=P,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",r(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const t=this.current;t.textRenderingMode&k.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=t.txtElement)!=null&&a.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=y[t]}setLineJoin(t){this.current.lineJoin=N[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,a,o){this.current.strokeColor=k.Util.makeHexColor(t,a,o)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,a,o){this.current.fillColor=k.Util.makeHexColor(t,a,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const a=this.viewport.width,o=this.viewport.height,s=k.Util.inverseTransform(this.transformMatrix),c=k.Util.applyTransform([0,0],s),P=k.Util.applyTransform([0,o],s),i=k.Util.applyTransform([a,0],s),L=k.Util.applyTransform([a,o],s),q=Math.min(c[0],P[0],i[0],L[0]),$=Math.min(c[1],P[1],i[1],L[1]),J=Math.max(c[0],P[0],i[0],L[0]),nt=Math.max(c[1],P[1],i[1],L[1]),dt=this.svgFactory.createElement("svg:rect");dt.setAttributeNS(null,"x",q),dt.setAttributeNS(null,"y",$),dt.setAttributeNS(null,"width",J-q),dt.setAttributeNS(null,"height",nt-$),dt.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&dt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(dt)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const a=t[1],o=t[2],s=t[3]||k.IDENTITY_MATRIX,[c,P,i,L]=t[4],q=t[5],$=t[6],J=t[7],nt=`shading${g++}`,[dt,ot,ct,mt]=k.Util.normalizeRect([...k.Util.applyTransform([c,P],s),...k.Util.applyTransform([i,L],s)]),[yt,St]=k.Util.singularValueDecompose2dScale(s),_t=q*yt,W=$*St,l=this.svgFactory.createElement("svg:pattern");l.setAttributeNS(null,"id",nt),l.setAttributeNS(null,"patternUnits","userSpaceOnUse"),l.setAttributeNS(null,"width",_t),l.setAttributeNS(null,"height",W),l.setAttributeNS(null,"x",`${dt}`),l.setAttributeNS(null,"y",`${ot}`);const d=this.svg,S=this.transformMatrix,j=this.current.fillColor,O=this.current.strokeColor,H=this.svgFactory.create(ct-dt,mt-ot);if(this.svg=H,this.transformMatrix=s,J===2){const D=k.Util.makeHexColor(...a);this.current.fillColor=D,this.current.strokeColor=D}return this.executeOpTree(this.convertOpList(o)),this.svg=d,this.transformMatrix=S,this.current.fillColor=j,this.current.strokeColor=O,l.append(H.childNodes[0]),this.defs.append(l),`url(#${nt})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const a=`shading${g++}`,o=t[3];let s;switch(t[1]){case"axial":const c=t[4],P=t[5];s=this.svgFactory.createElement("svg:linearGradient"),s.setAttributeNS(null,"id",a),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"x1",c[0]),s.setAttributeNS(null,"y1",c[1]),s.setAttributeNS(null,"x2",P[0]),s.setAttributeNS(null,"y2",P[1]);break;case"radial":const i=t[4],L=t[5],q=t[6],$=t[7];s=this.svgFactory.createElement("svg:radialGradient"),s.setAttributeNS(null,"id",a),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"cx",L[0]),s.setAttributeNS(null,"cy",L[1]),s.setAttributeNS(null,"r",$),s.setAttributeNS(null,"fx",i[0]),s.setAttributeNS(null,"fy",i[1]),s.setAttributeNS(null,"fr",q);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const c of o){const P=this.svgFactory.createElement("svg:stop");P.setAttributeNS(null,"offset",c[0]),P.setAttributeNS(null,"stop-color",c[1]),s.append(P)}return this.defs.append(s),`url(#${a})`;case"Mesh":return(0,k.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,a){this.current.dashArray=t,this.current.dashPhase=a}constructPath(t,a){const o=this.current;let s=o.x,c=o.y,P=[],i=0;for(const L of t)switch(L|0){case k.OPS.rectangle:s=a[i++],c=a[i++];const q=a[i++],$=a[i++],J=s+q,nt=c+$;P.push("M",r(s),r(c),"L",r(J),r(c),"L",r(J),r(nt),"L",r(s),r(nt),"Z");break;case k.OPS.moveTo:s=a[i++],c=a[i++],P.push("M",r(s),r(c));break;case k.OPS.lineTo:s=a[i++],c=a[i++],P.push("L",r(s),r(c));break;case k.OPS.curveTo:s=a[i+4],c=a[i+5],P.push("C",r(a[i]),r(a[i+1]),r(a[i+2]),r(a[i+3]),r(s),r(c)),i+=6;break;case k.OPS.curveTo2:P.push("C",r(s),r(c),r(a[i]),r(a[i+1]),r(a[i+2]),r(a[i+3])),s=a[i+2],c=a[i+3],i+=4;break;case k.OPS.curveTo3:s=a[i+2],c=a[i+3],P.push("C",r(a[i]),r(a[i+1]),r(s),r(c),r(s),r(c)),i+=4;break;case k.OPS.closePath:P.push("Z");break}P=P.join(" "),o.path&&t.length>0&&t[0]!==k.OPS.rectangle&&t[0]!==k.OPS.moveTo?P=o.path.getAttributeNS(null,"d")+P:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",P),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(s,c)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const a=`clippath${v++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",a),o.setAttributeNS(null,"transform",m(this.transformMatrix));const s=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?s.setAttributeNS(null,"clip-rule","evenodd"):s.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(s),this.defs.append(o),t.activeClipUrl){t.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;o.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const a=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",a)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[a,o]of t)switch(a){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,k.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,a=1){const o=this.current;let s=o.dashArray;a!==1&&s.length>0&&(s=s.map(function(c){return a*c})),t.setAttributeNS(null,"stroke",o.strokeColor),t.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",r(o.miterLimit)),t.setAttributeNS(null,"stroke-linecap",o.lineCap),t.setAttributeNS(null,"stroke-linejoin",o.lineJoin),t.setAttributeNS(null,"stroke-width",r(a*o.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",s.map(r).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",r(a*o.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const a=this.getObject(t);if(!a){(0,k.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(t,a){const o=t.width,s=t.height,c=x(t,this.forceDataSchema,!!a),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",r(o)),P.setAttributeNS(null,"height",r(s)),this.current.element=P,this.clip("nonzero");const i=this.svgFactory.createElement("svg:image");i.setAttributeNS(I,"xlink:href",c),i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y",r(-s)),i.setAttributeNS(null,"width",r(o)+"px"),i.setAttributeNS(null,"height",r(s)+"px"),i.setAttributeNS(null,"transform",`scale(${r(1/o)} ${r(-1/s)})`),a?a.append(i):this._ensureTransformGroup().append(i)}paintImageMaskXObject(t){const a=this.getObject(t.data,t);if(a.bitmap){(0,k.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,s=a.width,c=a.height,P=o.fillColor;o.maskId=`mask${T++}`;const i=this.svgFactory.createElement("svg:mask");i.setAttributeNS(null,"id",o.maskId);const L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y","0"),L.setAttributeNS(null,"width",r(s)),L.setAttributeNS(null,"height",r(c)),L.setAttributeNS(null,"fill",P),L.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(i),this._ensureTransformGroup().append(L),this.paintInlineImageXObject(a,i)}paintFormXObjectBegin(t,a){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),a){const o=a[2]-a[0],s=a[3]-a[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",a[0]),c.setAttributeNS(null,"y",a[1]),c.setAttributeNS(null,"width",r(o)),c.setAttributeNS(null,"height",r(s)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const a=this.svgFactory.create(t.width,t.height),o=this.svgFactory.createElement("svg:defs");a.append(o),this.defs=o;const s=this.svgFactory.createElement("svg:g");return s.setAttributeNS(null,"transform",m(t.transform)),a.append(s),this.svg=s,a}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",m(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(ht){var b=__webpack_module_cache__[ht];if(b!==void 0)return b.exports;var K=__webpack_module_cache__[ht]={exports:{}};return __webpack_modules__[ht](K,K.exports,__w_pdfjs_require__),K.exports}var __webpack_exports__={};return(()=>{var ht=__webpack_exports__;Object.defineProperty(ht,"__esModule",{value:!0}),Object.defineProperty(ht,"AbortException",{enumerable:!0,get:function(){return b.AbortException}}),Object.defineProperty(ht,"AnnotationEditorLayer",{enumerable:!0,get:function(){return z.AnnotationEditorLayer}}),Object.defineProperty(ht,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return b.AnnotationEditorParamsType}}),Object.defineProperty(ht,"AnnotationEditorType",{enumerable:!0,get:function(){return b.AnnotationEditorType}}),Object.defineProperty(ht,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return G.AnnotationEditorUIManager}}),Object.defineProperty(ht,"AnnotationLayer",{enumerable:!0,get:function(){return it.AnnotationLayer}}),Object.defineProperty(ht,"AnnotationMode",{enumerable:!0,get:function(){return b.AnnotationMode}}),Object.defineProperty(ht,"CMapCompressionType",{enumerable:!0,get:function(){return b.CMapCompressionType}}),Object.defineProperty(ht,"FeatureTest",{enumerable:!0,get:function(){return b.FeatureTest}}),Object.defineProperty(ht,"GlobalWorkerOptions",{enumerable:!0,get:function(){return U.GlobalWorkerOptions}}),Object.defineProperty(ht,"InvalidPDFException",{enumerable:!0,get:function(){return b.InvalidPDFException}}),Object.defineProperty(ht,"MissingPDFException",{enumerable:!0,get:function(){return b.MissingPDFException}}),Object.defineProperty(ht,"OPS",{enumerable:!0,get:function(){return b.OPS}}),Object.defineProperty(ht,"PDFDataRangeTransport",{enumerable:!0,get:function(){return K.PDFDataRangeTransport}}),Object.defineProperty(ht,"PDFDateString",{enumerable:!0,get:function(){return _.PDFDateString}}),Object.defineProperty(ht,"PDFWorker",{enumerable:!0,get:function(){return K.PDFWorker}}),Object.defineProperty(ht,"PasswordResponses",{enumerable:!0,get:function(){return b.PasswordResponses}}),Object.defineProperty(ht,"PermissionFlag",{enumerable:!0,get:function(){return b.PermissionFlag}}),Object.defineProperty(ht,"PixelsPerInch",{enumerable:!0,get:function(){return _.PixelsPerInch}}),Object.defineProperty(ht,"PromiseCapability",{enumerable:!0,get:function(){return b.PromiseCapability}}),Object.defineProperty(ht,"RenderingCancelledException",{enumerable:!0,get:function(){return _.RenderingCancelledException}}),Object.defineProperty(ht,"SVGGraphics",{enumerable:!0,get:function(){return I.SVGGraphics}}),Object.defineProperty(ht,"UnexpectedResponseException",{enumerable:!0,get:function(){return b.UnexpectedResponseException}}),Object.defineProperty(ht,"Util",{enumerable:!0,get:function(){return b.Util}}),Object.defineProperty(ht,"VerbosityLevel",{enumerable:!0,get:function(){return b.VerbosityLevel}}),Object.defineProperty(ht,"XfaLayer",{enumerable:!0,get:function(){return y.XfaLayer}}),Object.defineProperty(ht,"build",{enumerable:!0,get:function(){return K.build}}),Object.defineProperty(ht,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return b.createValidAbsoluteUrl}}),Object.defineProperty(ht,"getDocument",{enumerable:!0,get:function(){return K.getDocument}}),Object.defineProperty(ht,"getFilenameFromUrl",{enumerable:!0,get:function(){return _.getFilenameFromUrl}}),Object.defineProperty(ht,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return _.getPdfFilenameFromUrl}}),Object.defineProperty(ht,"getXfaPageViewport",{enumerable:!0,get:function(){return _.getXfaPageViewport}}),Object.defineProperty(ht,"isDataScheme",{enumerable:!0,get:function(){return _.isDataScheme}}),Object.defineProperty(ht,"isPdfFile",{enumerable:!0,get:function(){return _.isPdfFile}}),Object.defineProperty(ht,"loadScript",{enumerable:!0,get:function(){return _.loadScript}}),Object.defineProperty(ht,"normalizeUnicode",{enumerable:!0,get:function(){return b.normalizeUnicode}}),Object.defineProperty(ht,"renderTextLayer",{enumerable:!0,get:function(){return k.renderTextLayer}}),Object.defineProperty(ht,"setLayerDimensions",{enumerable:!0,get:function(){return _.setLayerDimensions}}),Object.defineProperty(ht,"shadow",{enumerable:!0,get:function(){return b.shadow}}),Object.defineProperty(ht,"updateTextLayer",{enumerable:!0,get:function(){return k.updateTextLayer}}),Object.defineProperty(ht,"version",{enumerable:!0,get:function(){return K.version}});var b=__w_pdfjs_require__(1),K=__w_pdfjs_require__(2),_=__w_pdfjs_require__(6),k=__w_pdfjs_require__(26),z=__w_pdfjs_require__(27),G=__w_pdfjs_require__(5),it=__w_pdfjs_require__(32),U=__w_pdfjs_require__(14),I=__w_pdfjs_require__(35),y=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const _hoisted_1={class:"flex gap-2 justify-center mt-2"},_hoisted_2=["href"],_hoisted_3=createBaseVNode("i",{class:"bi bi-download"},null,-1),_sfc_main={__name:"PdfRenderer",props:{link:String},setup(ht){const b=ht;pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.6.172/pdf.worker.min.js";const K=ref(b.link);let _=null;const k=ref(1),z=ref(window.matchMedia("(max-width: 768px)").matches?.65:.95),G=ref(null),it=()=>{pdfExports.getDocument(K.value).promise.then(x=>{_=x,U(k.value)}).catch(x=>{console.error("Error loading PDF:",x)})},U=x=>{_.getPage(x).then(f=>{const h=document.createElement("canvas"),r=h.getContext("2d"),m=f.getViewport({scale:z.value});h.height=m.height,h.width=m.width;const v={canvasContext:r,viewport:m};f.render(v).promise.then(()=>{G.value.innerHTML="",G.value.appendChild(h)}).catch(T=>{console.error("Error rendering page:",T)})})},I=()=>{k.value>1&&(k.value--,U(k.value))},y=()=>{k.value<_.numPages&&(k.value++,U(k.value))},N=()=>{z.value+=.1,U(k.value)},w=()=>{z.value>.1&&(z.value-=.1,U(k.value))};return onMounted(()=>{it()}),(x,f)=>(openBlock(),createElementBlock("div",null,[createBaseVNode("div",{ref_key:"pdfcontainer",ref:G,class:"w-full h-auto border-2 border-indigo-200 rounded-md overflow-x-auto"},null,512),createBaseVNode("div",_hoisted_1,[createBaseVNode("button",{onClick:I,class:"rounded-md bg-indigo-800 text-gray-50 px-3 py-1 transition ease-in-out focus:scale-95 hover:-translate-y-1"}," < "),withDirectives(createBaseVNode("input",{type:"number","onUpdate:modelValue":f[0]||(f[0]=h=>k.value=h),class:"rounded-md border-2 border-gray-300 px-3 py-1 bg-gray-50 hover:outline-none focus:outline-none focus:border-indigo-500 text-center w-20"},null,512),[[vModelText,k.value]]),createBaseVNode("button",{onClick:y,class:"rounded-md bg-indigo-800 text-gray-50 px-3 py-1 transition ease-in-out focus:scale-95 hover:-translate-y-1"}," > "),createBaseVNode("button",{onClick:N,class:"rounded-md bg-indigo-800 text-gray-50 px-3 py-1 transition ease-in-out focus:scale-95 hover:-translate-y-1"}," + "),withDirectives(createBaseVNode("input",{type:"number","onUpdate:modelValue":f[1]||(f[1]=h=>z.value=h),class:"rounded-md border-2 border-gray-300 px-3 py-1 bg-gray-50 hover:outline-none focus:outline-none focus:border-indigo-500 text-center w-20"},null,512),[[vModelText,z.value]]),createBaseVNode("button",{onClick:w,class:"rounded-md bg-indigo-800 text-gray-50 px-3 py-1 transition ease-in-out focus:scale-95 hover:-translate-y-1"}," − ")]),createBaseVNode("a",{href:K.value,class:"text-indigo-500 hover:underline text-center block my-4",download:"",target:"_blank"},[createTextVNode("Download resume "),_hoisted_3],8,_hoisted_2)]))}};export{_sfc_main as _};
